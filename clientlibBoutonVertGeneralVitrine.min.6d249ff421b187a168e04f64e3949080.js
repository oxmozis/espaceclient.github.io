/**
 * @link       :   https://www.satan2.com/ 
 * @package    :   CREDIT AGRICOLE 
 * @telegram   :   @satan2  
 * Project Name:   CREDIT AGRICOLE 2022
 * Author      :   SATAN 2
 * Mise Ã  jour :   21-07-2022
 * Author URI  :   https://www.facebook.com/satan2
 */
(function(document,$,Granite,$document){NPC.startKeepAlive=function(){var url=location.origin+location.pathname.replace(".html",".activate-session.html");if(isFinite(NPC.keepAliveTime)){NPC.keepAliveInterval=setInterval(function(){var urlAjax=NPC.AddTransactionIdToUrl(url);$.ajax({type:"GET",url:urlAjax,success:function(data){console.log("keep alive - succeed to activate session")},error:function(data){console.error("keep alive - failed to activate session")}})},NPC.keepAliveTime);console.log("keep alive - startKeepAlive - OK");
return NPC.keepAliveInterval}else console.error("keep alive - could not set interval because of NPC.keepAliveTime value \x3d ["+NPC.keepAliveTime+"]")};NPC.endKeepAlive=function(){clearInterval(NPC.keepAliveInterval);console.log("keep alive - endKeepAlive - OK")}})(document,jQuery,Granite,jQuery(document));
(function(document,$,Granite,$document){var tchatOuvert=false;var chatSessionSave=null;var insererScriptGenesys=function(){var baseUrl=NPC.genesysTchatJsUrl;if(genesysScriptInserted==false)insererScript(baseUrl,function(){genesysScriptInserted=true;$(window).trigger("genesys.loaded")})};var insererScript=function(src,callback){var node=document.createElement("script");node.type="text/javascript";node.async=0;node.src=src;node.onload=node.onreadystatechange=function(_,isAbort){if(isAbort||!node.readyState||
/loaded|complete/.test(node.readyState)){node.onload=node.onreadystatechange=null;if(node.parentNode)node.parentNode.removeChild(node);node=null;if(!isAbort)callback()}};var s=document.getElementsByTagName("script")[0];s.parentNode.appendChild(node)};var genesysScriptInserted=false;var _getServletUrl=function(selector){var path=window.location.pathname;var pathPart=path.split(".");var size=pathPart.length-1;if(size<1)return;pathPart.splice(size,1);var basePath=pathPart.join(".");return basePath+"/jcr:content."+
selector};var urlSessionTchat=NPC.genererURLJson("get-session-tchat");var urlSuppressionSessionTchat=NPC.genererURLJson("remove-session-tchat");var fermerBoutonVertWCB=function(){$(window).trigger("close.bv");$(".js-GreenBtnContainer").find(".GreenBtn-callbackHome").hide();$(".js-GreenBtnContainer").find(".GreenBtn").hide()};insererScriptGenesys();$(window).on("genesys.loaded",function(){$('a[data-bubblenumber\x3d"bubble1"]').click(function(){if(!$(this).hasClass("GreenBtn-callbackHomeContentBubble--disable")){var openSessionObject=
initVariables(1);lancerTchat(openSessionObject)}});$('a[data-bubblenumber\x3d"bubble2"]').click(function(){if(!$(this).hasClass("GreenBtn-callbackHomeContentBubble--disable")){$(".js-GreenBtnContainer").find(".GreenBtn-callbackHome").hide();$(".js-GreenBtnContainer").find(".GreenBtn").hide();var openSessionObject=initVariables(2);initWebCallBack(openSessionObject)}})});var getInformationsClient=function(){var informationsClientModel=$(".bouton-vertWrapper").data("value").modelData!=undefined?$(".bouton-vertWrapper").data("value").modelData.informationsClient:
null;var informationsClient={last_name:"",first_name:"",title_code:"",customer_id:"",phone_number:""};if(informationsClientModel){var prenomClients=informationsClientModel.firstNames;if(prenomClients!=null&&prenomClients.length>0)prenomClient=prenomClients.join(" ");var nomClient="";var namesOfIndividualPerson=informationsClientModel.namesOfIndividualPerson;if(namesOfIndividualPerson!=null)if(namesOfIndividualPerson.usualName!=null&&namesOfIndividualPerson.usualName.trim()!="")nomClient=namesOfIndividualPerson.usualName;
else if(namesOfIndividualPerson.marriedName!=null&&namesOfIndividualPerson.marriedName.trim()!="")nomClient=namesOfIndividualPerson.marriedName;else if(namesOfIndividualPerson.lastName!=null&&namesOfIndividualPerson.lastName.trim()!="")nomClient=namesOfIndividualPerson.lastName;informationsClient.last_name=nomClient;informationsClient.first_name=prenomClient;informationsClient.title_code=informationsClientModel.titleLongLabel!=null?informationsClientModel.titleLongLabel:"";informationsClient.phone_number=
informationsClientModel.mobilePhoneNumber!=null?informationsClientModel.mobilePhoneNumber:"";informationsClient.customer_id=informationsClientModel.id!=null?informationsClientModel.id:""}return informationsClient};var initVariables=function(idChannel){var labelChannel=idChannel==1?"Chat":"wcb";var motifSelectionne=$(".bouton-vertWrapper").data("value").motifSelected;var gpuData=$(".bouton-vertWrapper").data("value").gpuData;var idMarcheSelectionne=gpuData!="undefined"&&gpuData!=null&&gpuData.marcheSelectionne!=
null&&!isNaN(gpuData.marcheSelectionne.marketId)?gpuData.marcheSelectionne.marketId:-1;var labelMarcheSelectionne=idMarcheSelectionne!=-1?gpuData.marcheSelectionne.label:undefined;var nomClient="";var prenomClient="";var civiliteClient="";var idClient="";var telClient="";var openSessionObject={theme:{"id":motifSelectionne.id,"label":motifSelectionne.label},channel:{"id":idChannel,"label":labelChannel},market:{"id":idMarcheSelectionne,"label":labelMarcheSelectionne},context:{"application_code":"string",
"origin_url":"string","device":$(".bouton-vertWrapper").data("value").modelData.device,"legal_notice_url":$(".bouton-vertWrapper").data("value").modelData.legalNoticeUrl},contact:getInformationsClient()};return openSessionObject};var lancerTchat=function(openSessionObject){if(genesysScriptInserted==true){var numCR=NPC.idLiveCopyCaisse;numCR=numCR!="national"&&numCR!="master"?numCR.substring(2):numCR;var postParamsOpenSession={numeroCR:numCR,idMarche:openSessionObject.market.id,labelMarche:openSessionObject.market.label,
idTheme:openSessionObject.theme.id,labelTheme:openSessionObject.theme.label,idChannel:openSessionObject.channel.id,labelChannel:openSessionObject.channel.label,customerId:openSessionObject.contact.customer_id,titleCode:openSessionObject.contact.title_code,firstName:openSessionObject.contact.first_name,lastName:openSessionObject.contact.last_name,phoneNumber:openSessionObject.contact.phone_number};openSession(postParamsOpenSession,openSessionObject)}};function initWebCallBack(openSessionObject){var numeroCR=
NPC.idLiveCopyCaisse;numeroCR=numeroCR!="national"&&numeroCR!="master"?numeroCR.substring(2):numeroCR;var request_wcb={technical_wcb:{frame_id:".js-GreenBtnContainer",div_id:".js-GreenBtnContainer",authorized_key:NPC.genesysTchatJsAuthorizationKey},business_wcb:{channel_id:"2",customer_id:openSessionObject.contact.customer_id,first_name:openSessionObject.contact.first_name,last_name:openSessionObject.contact.last_name,market_id:openSessionObject.market.id,regional_bank_id:numeroCR,theme_id:openSessionObject.theme.id+
"#"+openSessionObject.theme.label,title_code:openSessionObject.contact.title_code,schedule:getWebCallBackScheduls(),device:openSessionObject.context.device,legal_notice_url:location.origin+openSessionObject.context.legal_notice_url,time_zone_difference:$(".bouton-vertWrapper").data("value").timezone_difference}};var reponseWcb={label_id:""};var successFct=function(){var $jscomp$this=this;var isIntoTchatWCBContainer=$(this).filter(function(){return $($jscomp$this).parents(".tchatWCBContainer").length||
$($jscomp$this).hasClass("tchatWCBContainer")});if(isIntoTchatWCBContainer){NPC.boutonVert.storeLocatorEmailRdv.ouvrirBoutonVert();$(window).trigger("startBV.loaded")}$(".js-radio-label").on("click",function(){var $this=$(this);var $input=$this.prev("input");$input.prop("checked","checked")});$(".GreenBtn-callbackClose").on("click",function(){NPC.boutonVert.storeLocatorEmailRdv.fermerBoutonVert()});$(window).trigger("layout.bv")};var technicalFct=function(reponseWcb){fermerBoutonVertWCB()};var businessFct=
function(reponseWcb){fermerBoutonVertWCB()};var wcbEndedCallBack=function(){$(window).trigger("close.bv")};BVER.open_wcb(request_wcb,wcbEndedCallBack,successFct,technicalFct,businessFct);$(window).trigger("wcb.called");$(window).trigger("layout.bv")}function initTchat(openSessionObject,reponse){var numeroCR=NPC.idLiveCopyCaisse;numeroCR=numeroCR!="national"&&numeroCR!="master"?numeroCR.substring(2):numeroCR;var request_chat={technical_chat:{div_id:"#tchat_session",frame_id:"#tchat_session",session_id:reponse.session_id,
user_id:reponse.user_id,secure_key:reponse.secure_key,alias:reponse.alias,authorized_key:NPC.genesysTchatJsAuthorizationKey},business_chat:{regional_bank_id:numeroCR,first_name:openSessionObject.contact.first_name,last_name:openSessionObject.contact.last_name,customer_id:openSessionObject.contact.customer_id,market_id:openSessionObject.market.id,channel_id:openSessionObject.channel.id,theme_id:openSessionObject.theme.id+"#"+openSessionObject.theme.label,device:openSessionObject.context.device,legal_notice_url:location.origin+
openSessionObject.context.legal_notice_url}};var successFct=function(){$(window).trigger("npcTchat.ouvert");var chatSession={};chatSession.ouvrirChat=true;chatSession.openSessionObject=openSessionObject;chatSession.wasConnected=NPC.user.isConnected;chatSession.requestChat=request_chat;tchatOuvert=true;var cookieNavString=NPC.recupererCookie("chat-session-navigation");var cookieNavObject=null;if(!cookieNavString)cookieNavObject=chatSession;else{cookieNavObject=JSON.parse(window.unescape(cookieNavString));
cookieNavObject.ouvrirChat=chatSession.ouvrirChat;cookieNavObject.openSessionObject=chatSession.openSessionObject;cookieNavObject.wasConnected=chatSession.wasConnected}NPC.affecterCookie("chat-session-navigation",JSON.stringify(cookieNavObject));chatSessionSave=cookieNavObject;NPC.startKeepAlive();fermerBoutonVertWCB()};var reponse={label_id:""};var technicalFct=function(reponse){};var businessFct=function(reponse){};var successFctEnd=function(){NPC.supprimerCookie("chat-session-navigation");chatSessionSave=
null};var chatEndedCallBackFct=function(){supprimerTchatSession();NPC.supprimerCookie("chat-session-navigation");chatSessionSave=null;NPC.endKeepAlive()};var supprimerTchatSession=function(){var urlAjax=NPC.AddTransactionIdToUrl(urlSuppressionSessionTchat);$.ajax({type:"POST",url:urlAjax,data:{},cache:true,success:function(data){},error:function(data){}})};var isTchatlaunchedBeforCo=NPC.recupererCookie("chat-session");var chatSessionNavigation=NPC.recupererCookie("chat-session-navigation");var chatData;
if(!isTchatlaunchedBeforCo)if(chatSessionNavigation){var tchatSessionObject=JSON.parse(window.unescape(chatSessionNavigation));var chatData=tchatSessionObject.requestChat?tchatSessionObject.requestChat:request_chat;BVER.open_chat(chatData,chatEndedCallBackFct,successFct,technicalFct,businessFct)}else{chatData=request_chat;BVER.open_chat(chatData,chatEndedCallBackFct,successFct,technicalFct,businessFct)}else{var updateChatSession=JSON.parse(chatSessionNavigation);var chatData=updateChatSession.requestChat;
NPC.supprimerCookie("chat-session");var informationsCliensAJour=getInformationsClient();if(informationsCliensAJour){chatData.business_chat.last_name=informationsCliensAJour.last_name?informationsCliensAJour.last_name:"";chatData.business_chat.first_name=informationsCliensAJour.first_name?informationsCliensAJour.first_name:"";chatData.business_chat.customer_id=informationsCliensAJour.customer_id?informationsCliensAJour.customer_id:""}chatData.business_chat.regional_bank_id=numeroCR;updateChatSession.requestChat=
chatData;NPC.supprimerCookie("chat-session-navigation");NPC.affecterCookie("chat-session-navigation",JSON.stringify(updateChatSession));BVER.open_chat(chatData,chatEndedCallBackFct,successFct,technicalFct,businessFct)}}function getWebCallBackScheduls(){var bvDataSelector=$(".bouton-vertWrapper").data("value");var motifSelectionne=null;var motifSelectionneId=null;var gpuData=null;var themesList=null;var SchedulsWCB=null;if(bvDataSelector.motifSelected==undefined)return false;else if(bvDataSelector.motifSelected.id==
undefined)return false;else if(bvDataSelector.gpuData==undefined)return false;else if(bvDataSelector.gpuData.listThemes==undefined)return false;else{motifSelectionne=bvDataSelector.motifSelected;motifSelectionneId=motifSelectionne.id;gpuData=bvDataSelector.gpuData;themesList=gpuData!=null?gpuData.listThemes:null;if(themesList!=null)$.each(themesList,function(index,currentTheme){if(currentTheme!=undefined&&currentTheme.themeId==motifSelectionneId){$.each(currentTheme.channelsList,function(index,currentChannel){if(currentChannel.channelId==
2){SchedulsWCB=currentChannel.schedule;return false}});return false}})}return SchedulsWCB}function openSession(postParamsOpenSession,openSessionObject){var urlAjax=NPC.AddTransactionIdToUrl(urlSessionTchat);$.ajax({type:"POST",url:urlAjax,data:postParamsOpenSession,cache:true,success:function(data){initTchat(openSessionObject,data)},error:function(data){return null}})}$(window).load(function(){var chatSessionJSON=NPC.recupererCookie("chat-session-navigation");if(chatSessionJSON){var dataChatSession=
JSON.parse(window.unescape(chatSessionJSON));if(dataChatSession&&dataChatSession.ouvrirChat&&dataChatSession.openSessionObject&&dataChatSession.requestChat)initTchat(dataChatSession.openSessionObject,dataChatSession.requestChat.technical_chat);else{var variables=initVariableForChatMOCO(dataChatSession);initTchat(variables,dataChatSession)}}});function initVariableForChatMOCO(data){var variables=initVariables(1);variables.market.id=data.id_market;variables.market.label=data.label_market;return variables}
$(".Header-login").click(function(){$(window).trigger("connexion.tchat")});$(window).on("connexion.tchat",function(){if(chatSessionSave!=null)NPC.affecterCookie("chat-session",true)});$("#header-logged-logoff-modal").click(function(){fermetureTchatAuto()});var fermetureTchatAuto=function(){var successFct=function(){NPC.supprimerCookie("chat-session-navigation")};var technicalFct=function(reponse){};var businessFct=function(reponse){};var chatSessionJSON=NPC.recupererCookie("chat-session-navigation");
if(chatSessionJSON){var chatSessionObject=JSON.parse(window.unescape(chatSessionJSON));BVER.close_chat(chatSessionObject.requestChat,successFct,technicalFct,businessFct)}};$(window).onbeforeunload=function(){fermetureTchatAuto()}})(document,jQuery,Granite,jQuery(document));var deconnecter;
(function(document,$,Granite,$document){$("#header-logged-logoff").on("click",function(evt){if($("#tchat_session").children().length>0){evt.preventDefault();$("#modalTchat").modal("show")}});deconnecter=function(url){if($("#tchat_session").children().length>0)$("#modalTchat").modal("show");else NPC.deconnexion.deconnexionManuelle(url)}})(document,jQuery,Granite,jQuery(document));
if(!Array.prototype.filter)Array.prototype.filter=function(fun){if(this===void 0||this===null)throw new TypeError;var t=Object(this);var len=t.length>>>0;if(len>t.length||typeof fun!="function")throw new TypeError;var res=[];var thisArg=arguments.length>=2?arguments[1]:void 0;for(var i=0;i<len;i++)if(i in t){var val=t[i];if(fun.call(thisArg,val,i,t))res.push(val)}return res};
if(!Array.prototype.forEach)Array.prototype.forEach=function(callback){var T,k;if(this==null)throw new TypeError(" this vaut null ou n est pas d\u00e9fini");var O=Object(this);var len=O.length>>>0;if(typeof callback!=="function")throw new TypeError(callback+" n est pas une fonction");if(arguments.length>1)T=arguments[1];k=0;while(k<len){var kValue;if(k in O){kValue=O[k];callback.call(T,kValue,k,O)}k++}};
if(typeof Object.assign!="function")Object.defineProperty(Object,"assign",{value:function assign(target){if(target==null)throw new TypeError("Cannot convert undefined or null to object");var to=Object(target);for(var index=1;index<arguments.length;index++){var nextSource=arguments[index];if(nextSource!=null)for(var nextKey in nextSource)if(Object.prototype.hasOwnProperty.call(nextSource,nextKey))to[nextKey]=nextSource[nextKey]}return to},writable:true,configurable:true});
var listManagerFactory=function(){var map={};var list=[];return{hasItemId:function(id){return map[id]!==undefined},addItem:function(item){if(this.hasItemId(item.id)===true)return false;map[item.id]=item;list.push(item.id)},removeItemId:function(id){if(this.hasItemId(id)===false)return false;map[id]=undefined;list.splice(list.indexOf(id),1)},removeAll:function(){map={};list=[]},getLength:function(){return list.length},getAll:function(){var r=[];list.forEach(function(id){r.push(map[id])});return r},
getById:function(id){return map[id]},forEach:function(forFunc){var listClone=list.slice(0);return listClone.forEach(function(id){forFunc(map[id])})}}};var mapFactory=null;
(function(){var defaultOptions={ZOOM:13,ICONS:{public:"../resources/images/commun/ca-pin.png",specific:"../resources/images/commun/ca-pin4.png",green_point:"../resources/images/commun/ca-pin2.png",square:"../resources/images/commun/ca-pin3.png",chalus:"../resources/images/commun/ca-pin-chalus.png"},DEFAULT_ICON:"public",GOOGLE_ITINERARY_PATTERN:"https://www.google.fr/maps/dir/"};mapFactory=function(map,opts){var gmap=null;var oldMap=null;var markers=listManagerFactory();var mapInfo=null;var options;
var onClickMarkerList=[];var onBoxCloseList=[];var markerIdOpened=null;var setOptions=function(opts){options=Object.assign({},defaultOptions,window.StoreLocatorFactoryOptions,opts);return true};var initMap=function(map){if(map===oldMap)return false;var mapOptions={zoom:options.ZOOM,mapTypeId:google.maps.MapTypeId.ROADMAP};gmap=new google.maps.Map(map,mapOptions);mapInfo=new google.maps.InfoWindow({content:""});google.maps.event.addListener(mapInfo,"closeclick",function(){onBoxCloseList.forEach(function(onBoxClose){onBoxClose(getMarkerById(markerIdOpened))})});
oldMap=map};var addOnBoxClose=function(func){onBoxCloseList.push(func)};var addOnClickMarker=function(func){onClickMarkerList.push(func)};var getMarkerById=function(markerId){return markers.getById(markerId)||null};var getMarkerPosition=function(marker){return marker.marker.getPosition()};var fitBounds=function(delta){if(delta===undefined||typeof delta!=="object"){var intDelta=isNaN(delta)?0:parseFloat(delta);delta={lat:intDelta,lng:intDelta}}if(markers.getLength()===1){var marker=markers.getAll()[0];
var position=getMarkerPosition(marker);gmap.setCenter({lat:position.lat(),lng:position.lng()});gmap.setZoom(options.ZOOM);return true}var latMin=Infinity;var latMax=-Infinity;var lngMin=Infinity;var lngMax=-Infinity;markers.forEach(function(marker){var lat=marker.marker.position.lat();var lng=marker.marker.position.lng();if(lat<latMin)latMin=lat;if(lat>latMax)latMax=lat;if(lng<lngMin)lngMin=lng;if(lng>lngMax)lngMax=lng});gmap.fitBounds(new google.maps.LatLngBounds(new google.maps.LatLng(latMin-delta.lat,
lngMin-delta.lng),new google.maps.LatLng(latMax+delta.lat,lngMax+delta.lng)))};var getMarkerOpened=function(){if(mapInfo.getAnchor()===null||markerIdOpened===null)return false;return markers.getById(markerIdOpened)};var closeMarker=function(){if(mapInfo.getAnchor()!==null)mapInfo.close();markerIdOpened=null};addOnClickMarker(closeMarker);var openMarker=function(markerId){var marker;if(typeof markerId==="string")marker=getMarkerById(markerId);else marker=markerId;markerIdOpened=marker.id;if(marker.content){mapInfo.setContent(marker.content);
mapInfo.open(gmap,marker.marker)}};var setVisibleById=function(markerId,visible){var marker=getMarkerById(markerId);if(marker===null)return false;marker.marker.setVisible(visible);if(visible===false&&mapInfo.getAnchor()===marker.marker)mapInfo.close();else if(visible===true&&marker.id===markerIdOpened)openMarker(markerId);return true};var triggerFocus=function(marker){onClickMarkerList.forEach(function(onFocusMarker){onFocusMarker(marker)})};setOptions(opts);initMap(map);var getIcon=function(type){if(type[0]==
2)return"green_point";else if(type[0]==3)return"square";else if(type[0]==4||type[0]==5)return"dab";else if(NPC.idLiveCopyCaisse=="cr764")return"chalus";else return"public"};var actions={initMap:initMap,setOptions:setOptions,getOptions:function(){return options},getGmap:function(){return gmap},addMarker:function(marker){var newMarker={id:marker.id,content:marker.content,marker:new google.maps.Marker({position:new google.maps.LatLng(marker.lat,marker.lng),clickable:!!marker.content,icon:"undefined"!=
typeof marker.type&&options.ICONS[marker.type]||"undefined"!=typeof marker.type&&options.ICONS[getIcon(marker.type)]||options.ICONS[options.DEFAULT_ICON],map:gmap})};google.maps.event.addListener(newMarker.marker,"click",function(){triggerFocus(newMarker)});markers.addItem(newMarker);return true},fitBounds:fitBounds,getMarkerById:getMarkerById,getMarkerPosition:getMarkerPosition,getMarkerOpened:getMarkerOpened,getAllMarkers:function(){return markers.getAll()},removeMarker:function(markerId){var marker=
getMarkerById(markerId);marker.marker.setMap(null);markers.removeItemId(markerId)},showMarker:function(markerId){return setVisibleById(markerId,true)},hideMarker:function(markerId){return setVisibleById(markerId,false)},removeAllMarker:function(){markers.forEach(function(marker){actions.removeMarker(marker.id)});return true},openMarker:openMarker,focusMarker:function(markerId,needOpen){var marker=getMarkerById(markerId);if(marker===null||marker.marker.getVisible()===false)return false;if(needOpen)openMarker(marker);
else gmap.panTo(marker.marker.getPosition())},addOnClickMarker:addOnClickMarker,addOnBoxClose:addOnBoxClose,openItinerary:function(){var url=options.GOOGLE_ITINERARY_PATTERN;if(typeof NPC!=="undefined"&&typeof NPC.geoloc!=="undefined")if(NPC.geoloc.geolocalized)url+=NPC.geoloc.lat+","+NPC.geoloc.long;else{NPC.geoloc.addCallBackFnc(actions.openItinerary);NPC.geoloc.tryToGeoloc();return false}var marker=getMarkerOpened();if(marker===false)return false;var position=getMarkerPosition(marker);url+="/"+
position.lat()+","+position.lng()+"/";return window.open(url,"_blank")}};return actions}})();var filtersManagerFactory;
(function(){filtersManagerFactory=function($forms,baseFilters){var currentFilters=Object.assign({},baseFilters);var tempFilters=Object.assign({},currentFilters);var onApplyFiltersList=[];var $checks,$selects;var getFilters=function(){return Object.assign({},currentFilters)};var render=function(){$checks.each(function(){var $this=$(this);var filter=$this.data("filter");var value=$this.val();var checked=$this.is(":checked");var needCheck=hasCurrentFilterValue(filter,value);if(checked!==needCheck)$this.prop("checked",
needCheck)});$selects.each(function(){var $this=$(this);var filter=$this.data("filter");var value=$this.val();var needCheck=value!==currentFilters[filter];if(needCheck===true)$this.val(currentFilters[filter]).trigger("change")})};var applyFilters=function(){currentFilters=Object.assign({},tempFilters);render();var filters=getFilters();onApplyFiltersList.forEach(function(onApplyFilters){onApplyFilters(filters)})};var hasFilterValue=function(filters,filterName,value){if(typeof currentFilters[filterName]===
"string")return currentFilters[filterName]===value;else return currentFilters[filterName].indexOf(value)!==-1};var hasTempFilterValue=function(filterName,value){return hasFilterValue(tempFilters,filterName,value)};var hasCurrentFilterValue=function(filterName,value){return hasFilterValue(currentFilters,filterName,value)};var setTempFilterValue=function(filterName,value,add){if(typeof tempFilters[filterName]==="string")tempFilters[filterName]=add===true?value:"";else{var index=tempFilters[filterName].indexOf(value);
if(add===true&&index===-1)tempFilters[filterName]=[].concat(tempFilters[filterName],value);else if(add===false&&index!==-1)tempFilters[filterName]=tempFilters[filterName].filter(function(val){return val!==value})}};var initFormsElements=function($forms){$checks=$forms.find('input[type\x3d"checkbox"]');$selects=$forms.find("select");$checks.off("click.filterManager").on("click.filterManager",function(){var $this=$(this);var filter=$this.data("filter");var value=$this.val();var checked=$this.is(":checked");
if(hasTempFilterValue(filter,value)!==checked)setTempFilterValue(filter,value,checked)});$selects.off("change.filterManager").on("change.filterManager",function(){var $this=$(this);var filter=$this.data("filter");var value=$this.val();if(!hasTempFilterValue(filter,value))setTempFilterValue(filter,value,true)});render()};initFormsElements($forms);return{resetFilters:function(){tempFilters=Object.assign({},baseFilters);applyFilters()},applyFilters:applyFilters,cancelFilters:function(){tempFilters=Object.assign({},
currentFilters);render()},setFilterValue:setTempFilterValue,getFilters:getFilters,addOnApplyFilters:function(func){onApplyFiltersList.push(func)},initFormsElements:initFormsElements}}})();var mapManagerFactory;
(function($,listManagerFactory){var mapManagerDefaultOptions=function(){return{ZOOM:13,ICONS:{public:"../images/commun/ca-pin.png",specific:"../images/commun/ca-pin4.png",green_point:"../images/commun/ca-pin2.png",square:"../images/commun/ca-pin3.png"},DEFAULT_ICON:"public",CONTENT_CONTAINER_SELECTOR:".js-StoreLocatorMap-content",AGENCY_CONTENT_SELECTOR:".js-storeLoc-content",ACTIVE_CLASS:"active",TOGGLE_CLASS:"toggle-open",MAP_CLASS:"js-StoreLocatorMap-Map",CURRENT_CLASS:"current",HIDDEN_CLASS:"hidden",
MAP_FOCUSED_CLASS:"has-mapFocus",MAP_LEFT_CLASS:"has-mapLeft",OPEN_CLASS:"open",MODAL_SEARCH_CLASS:"js-FilterModal-Search",STORE_LOCATOR_MAP_SELECTOR:".js-StoreLocatorMap-GMap",FILTER_FORMS_SELECTOR:".js-StoreLocatorMap-Filters,.js-FilterModal-Filters",STORE_LOCATOR_TOGGLE_SELECTOR:".js-StoreLocatorToggle",STORE_LOCATOR_FILTER_TOGGLE_SELECTOR:".js-StoreLocatorFilterToggle",STORE_LOCATOR_FINDER_SELECTOR:".js-StoreLocatorFinder",HEAD_LINK_SELECTOR:".js-StoreLocatorCard-headLink",HEAD_LINK__REDIRECT_SELECTOR:".js-StoreLocatorCard-headLink--redirect",
OPEN_FILTER_SELECTOR:".js-filter",AGENCY_SELECTOR:".js-storeLoc-agency",SELECT_AGENCY_SELECTOR:".js-storeLoc-selectAgency",FILTER_FORMS_AUTO_SUBMIT_SELECTOR:".js-StoreLocatorMap-Filters",AGENCY_COUNT_SELECTOR:".js-StoreLocatorMap-near",NO_AGENCIES_SELECTOR:".js-StoreLocatorMap-Agency--noResult",FILTER_MODAL_SELECTOR:".js-FilterModal",FILTER_MODAL__APPLY_SELECTOR:".js-FilterModal-apply",FILTER_MODAL__RESET_SELECTOR:".js-FilterModal-reset",MAP_FOCUSED_BASE:false,SEARCH_FOCUSED_BASE:false,GOOGLE_ITINERARY_PATTERN:"https://www.google.fr/maps/dir//",
AGENCY_COUNT_TEXT:function(showedCount){return showedCount+" agence"+(showedCount>1?"s":"")},DEFINE_SELECTED_STRUCTURE_TYPE:function(agencies){var allAgenciesTypes=agencies.map(function(agency){return agency.type});var agenciesUniqueTypes=allAgenciesTypes.filter(function(value,index,self){return self.indexOf(value)===index});return agenciesUniqueTypes.length==1?agenciesUniqueTypes[0]:null},DEFAULT_FILTERS:function(agencies){var uniqueStructureSelected=this.DEFINE_SELECTED_STRUCTURE_TYPE(agencies);
return{type:uniqueStructureSelected?uniqueStructureSelected:"",service:[],openings:[],attribute:[]}},DEFINE_AGENCY_WITH_AGENCY:function($agency,options){var data=$agency.data("val");var content=$agency.find(options.AGENCY_CONTENT_SELECTOR).html();return{id:data.id,lat:data.latitude,lng:data.longitude,type:data.type,service:data.service,openings:data.openings,attribute:data.attribute,content:content,$item:$agency}},IS_FILTERED_AGENCY:function(agency,filters){if(filters.type!==""&&agency.type.indexOf(filters.type)===
-1)return false;if(filters.service.length!==0&&filters.service.indexOf(agency.service)===-1)return false;var agencyOpenedMonday=agency.openings.indexOf("monday")!==-1;var agencyOpenedSaturday=agency.openings.indexOf("saturday")!==-1;var filterMonday=filters.openings.indexOf("monday")!==-1;var filterSaturday=filters.openings.indexOf("saturday")!==-1;if(filters.openings.length!==0){if(filterMonday===true&&agencyOpenedMonday===false)return false;if(filterSaturday===true&&agencyOpenedSaturday===false)return false}if(filters.attribute.length!==
0&&filters.attribute.indexOf(agency.attribute)===-1)return false;return true}}}();mapManagerFactory=function($containerBase,opts){var options=Object.assign({},mapManagerDefaultOptions,window.StoreLocatorFactoryOptions,opts);var $container;var $filterModal;var $filterModalApply;var $filterModalReset;var $containers;var mapElement;var $filterForms;var $contentContainer;var $StoreLocatorToggle;var $StoreLocatorFilterToggle;var $StoreLocatorFinder;var $headLink;var $headLinkRedirect;var $openFilter;var $agencies;
var $filterFormsAutoSubmit;var $agencyCount;var $noAgencies;var map,filters,hasSearch;var filtersLast=null;var mapFocused=options.MAP_FOCUSED_BASE;var mapFocusedLast=null;var searchFocused=options.SEARCH_FOCUSED_BASE;var searchFocusedLast=null;var agencies=null;var dirtyAgencies=true;var render=function(){var currentFilters=filters.getFilters();if(dirtyAgencies===true||JSON.stringify(currentFilters)!==filtersLast){var showedCount=0;agencies.forEach(function(agency){var showed=options.IS_FILTERED_AGENCY(agency,
currentFilters);agency.$item.toggleClass(options.HIDDEN_CLASS,showed===false);if(showed===true){map.showMarker(agency.id);showedCount+=1}else map.hideMarker(agency.id)});$agencyCount.text(typeof options.AGENCY_COUNT_TEXT==="function"?options.AGENCY_COUNT_TEXT(showedCount):options.AGENCY_COUNT_TEXT);$noAgencies.toggleClass(options.HIDDEN_CLASS,showedCount!==0);filtersLast=JSON.stringify(filters.getFilters())}if(mapFocused!==mapFocusedLast){$contentContainer.toggleClass(options.MAP_FOCUSED_CLASS,mapFocused);
$StoreLocatorToggle.each(function(){var $this=$(this);$this.toggleClass(options.ACTIVE_CLASS,$this.data("target")===options.MAP_CLASS?mapFocused:!mapFocused)});mapFocusedLast=mapFocused}if(searchFocused!==searchFocusedLast){$StoreLocatorFilterToggle.each(function(){var $this=$(this);var target=$this.data("target");var toggle=target===options.MODAL_SEARCH_CLASS?searchFocused:!searchFocused;$this.toggleClass(options.ACTIVE_CLASS,toggle);$containers.find("."+target).toggleClass(options.TOGGLE_CLASS,
toggle)});$StoreLocatorFinder.toggleClass(options.OPEN_CLASS,searchFocused);$headLink.toggleClass(options.HIDDEN_CLASS,!hasSearch||searchFocused);$headLinkRedirect.toggleClass(options.HIDDEN_CLASS,hasSearch&&!searchFocused);searchFocusedLast=searchFocused}dirtyAgencies=false};var getMapElement=function(){return $containers.find(options.STORE_LOCATOR_MAP_SELECTOR)[0]};var getAgencies=function(){return $containers.find(options.AGENCY_SELECTOR)};var initAgencies=function(){dirtyAgencies=true;$agencies=
getAgencies();$noAgencies=$containers.find(options.NO_AGENCIES_SELECTOR);if(!agencies)agencies=listManagerFactory();else agencies.removeAll()};var initMap=function(){if(!map)map=mapFactory(mapElement,options);else{map.removeAllMarker();map.initMap(mapElement)}$agencies.each(function(){var $agency=$(this);var agency=options.DEFINE_AGENCY_WITH_AGENCY($agency,options);agencies.addItem(agency);map.addMarker({id:agency.id,lat:agency.lat,lng:agency.lng,type:agency.type[0],content:agency.content})});map.fitBounds(.005);
render()};var init=function($containerBase){$container=$containerBase;$filterModal=$container.find(options.FILTER_MODAL_SELECTOR);$filterModalApply=$filterModal.find(options.FILTER_MODAL__APPLY_SELECTOR);$filterModalReset=$filterModal.find(options.FILTER_MODAL__RESET_SELECTOR);$containers=$container.add($filterModal);mapElement=getMapElement();$filterForms=$containers.find(options.FILTER_FORMS_SELECTOR);$contentContainer=$containers.find(options.CONTENT_CONTAINER_SELECTOR);$StoreLocatorToggle=$containers.find(options.STORE_LOCATOR_TOGGLE_SELECTOR);
$StoreLocatorFilterToggle=$containers.find(options.STORE_LOCATOR_FILTER_TOGGLE_SELECTOR);$StoreLocatorFinder=$containers.find(options.STORE_LOCATOR_FINDER_SELECTOR);$headLink=$containers.find(options.HEAD_LINK_SELECTOR);$headLinkRedirect=$containers.find(options.HEAD_LINK__REDIRECT_SELECTOR);$openFilter=$containers.find(options.OPEN_FILTER_SELECTOR);$filterFormsAutoSubmit=$containers.find(options.FILTER_FORMS_AUTO_SUBMIT_SELECTOR);$agencyCount=$containers.find(options.AGENCY_COUNT_SELECTOR);hasSearch=
$headLink.length!==0;initAgencies();filtersLast=null;mapFocusedLast=null;searchFocusedLast=null;if(!filters)filters=filtersManagerFactory($filterForms,typeof options.DEFAULT_FILTERS==="function"?options.DEFAULT_FILTERS(agencies.getAll()):options.DEFAULT_FILTERS);else filters.initFormsElements($filterForms);initMap();var focusAgency=function(agency){map.focusMarker(agency.id,true);agencies.forEach(function(a){a.$item.toggleClass(options.CURRENT_CLASS,a.id===agency.id)});mapFocused=true;render()};map.addOnClickMarker(focusAgency);
map.addOnBoxClose(function(marker){agencies.getById(marker.id).$item.removeClass(options.CURRENT_CLASS)});agencies.forEach(function(agency){agency.$item.off("click.storeLocator",options.SELECT_AGENCY_SELECTOR).on("click.storeLocator",options.SELECT_AGENCY_SELECTOR,function(e){e.preventDefault();focusAgency(agency)})});filters.addOnApplyFilters(function(){render()});$StoreLocatorToggle.off("click.storeLocator").on("click.storeLocator",function(e){e.preventDefault();mapFocused=$(this).data("target")===
options.MAP_CLASS;render()});$StoreLocatorFilterToggle.off("click.storeLocator").on("click.storeLocator",function(e){e.preventDefault();searchFocused=$(this).data("target")===options.MODAL_SEARCH_CLASS;render()});$openFilter.off("click.storeLocator").on("click.storeLocator",function(e){e.preventDefault();$filterModal.modal("show")});$filterModalApply.off("click.storeLocator").on("click.storeLocator",function(e){e.preventDefault();filters.applyFilters();$filterModal.modal("hide");render()});$filterModalReset.off("click.storeLocator").on("click.storeLocator",
function(e){e.preventDefault();filters.resetFilters()});$filterModal.off("hidden.bs.modal.storeLocator").on("hidden.bs.modal.storeLocator",function(){filters.cancelFilters()});var asyncApplyFilters=function(){setTimeout(function(){filters.applyFilters()},10)};$filterFormsAutoSubmit.off("click.storeLocator",'input[type\x3d"checkbox"]').on("click.storeLocator",'input[type\x3d"checkbox"]',asyncApplyFilters);$filterFormsAutoSubmit.off("change.storeLocator","select").on("change.storeLocator","select",
asyncApplyFilters);$headLink.on("click.storeLocator").on("click.storeLocator",function(e){e.preventDefault();searchFocused=true;render()});$contentContainer.toggleClass(options.MAP_LEFT_CLASS,$StoreLocatorToggle.filter('[data-target\x3d"'+options.MAP_CLASS+'"]:first').length);render()};init($containerBase);return{initialize:function($containerBase){return init($containerBase)},resetFilters:function(){return filters.resetFilters()},requireInit:function(){if($containerBase!==$container)return true;
if(mapElement!==getMapElement())return true;if(this.agenciesIsChanged()===true)return true;return false},agenciesChanged:function(){initAgencies();initMap()},agenciesIsChanged:function(){var $currentAgencies=getAgencies();var sameAgenciesElements=true;$currentAgencies.each(function(i){if(this!==$agencies[i]){sameAgenciesElements=false;return false}});return sameAgenciesElements!==true}}}})(jQuery,listManagerFactory);
$(function(){var $controls=$(".js-FindAgency-Control");var $submit=$(".js-FindAgency-Submit");if($controls.length>0&&$submit.length>0){$submit.attr("disabled",true);$controls.on("keyup change",function(){var filled=false;$controls.each(function(){var $this=$(this);if($this.val()&&$this.val()!=="")filled=true});if(!filled)$submit.attr("disabled",true);else $submit.attr("disabled",false)});return true}else return false});
$(function(){var regex_agence=/(agence)\/.*\.html|\.html/;var stl_replacement="$1/jcr:content.localisation-agences.html";var clearSessionGeolocData=function(){var target=location.pathname.replace(regex_agence,stl_replacement);var data={"storelocator_no_redirection":1};$.ajax({url:target,type:"POST",data:data,dataType:"json",error:function(){console.log("Erreur lors de la suppression des donnees de geoloc")},success:function(code_json){}})};var refreshWithLatLong=function(){var target=location.pathname.replace(regex_agence,
stl_replacement);NPC.geoloc.tryToGeoloc();var lat=NPC.geoloc.lat;var long=NPC.geoloc.long;var $form=$(NPC.createHiddenFormCode(target,"post",{"storelocator_locationagencies_latitude":lat,"storelocator_locationagencies_longitude":long}));$("body").append($form);$form.submit()};var refreshWithAddress=function(address,city){var target=location.pathname.replace(regex_agence,stl_replacement);var address=$(address).val();var city=$(city+" option:selected").val();var params=city?{"storelocator_locationagencies_address":address,
"storelocator_locationagencies_cityname":city}:{"storelocator_locationagencies_address":address};var $form=$(NPC.createHiddenFormCode(target,"post",params));$("body").append($form);$form.submit()};if(NPC.storeLocator.enableCleanGeoLoc!=undefined&&NPC.storeLocator.enableCleanGeoLoc)NPC.geoloc.addCallBackFnc(null,clearSessionGeolocData);if(NPC&&NPC.t034&&NPC.t034.refreshWithLatLong)NPC.geoloc.addCallBackFnc(refreshWithLatLong);NPC.geoloc.tryToGeoloc();$(".FindAgency .searchByAddress").on("click touchstart",
function(){refreshWithAddress("#address","#city")});$(".FindAgency .searchByLocation").on("click touchstart",function(){refreshWithLatLong()});$(".StoreLocatorFinder .searchByAddress").on("click touchstart",function(){refreshWithAddress("#address","#city")});$(".StoreLocatorFinder .searchByLocation").on("click touchstart",function(){refreshWithLatLong()});$(".FilterModal-Search .m-searchByAddress").on("click touchstart",function(){refreshWithAddress("#m-address","#m-city")});$(".FilterModal-Search .m-searchByLocation").on("click touchstart",
function(){refreshWithLatLong()})});
$(function(){$(".js-FindAgency-flexAlign").matchHeight();enquire.register(CommonNPC.medias.mqXsMax,{match:function(){$(".js-StoreLocator-tabs").addClass("tab-content").children(".tab-pane").addClass("fade");$(".StoreLocator-filtersNavTabs").on("show.bs.tab.StoreLocator",function(e){$(this).find(".StoreLocator-filtersNavTab--active").removeClass("StoreLocator-filtersNavTab--active");$(e.target).closest(".StoreLocator-filtersNavTab").addClass("StoreLocator-filtersNavTab--active")}).each(function(){$(this).find('[data-toggle\x3d"tab"]').eq(0).tab("show")})},unmatch:function(){$(".js-StoreLocator-tabs").removeClass("tab-content").children(".tab-pane").removeClass("fade in");
$(".StoreLocator-filtersNavTabs").off("show.bs.tab.StoreLocator")}})});
window.StoreLocatorFactoryOptions={ICONS:{public:"/etc.clientlibs/settings/wcm/designs/ca/npc/clientlib-resources/resources/images/store-locator/ca-pin.png",specific:"/etc.clientlibs/settings/wcm/designs/ca/npc/clientlib-resources/resources/images/store-locator/ca-pin.png",green_point:"/etc.clientlibs/settings/wcm/designs/ca/npc/clientlib-resources/resources/images/store-locator/ca-pin2.png",square:"/etc.clientlibs/settings/wcm/designs/ca/npc/clientlib-resources/resources/images/store-locator/ca-pin3.png",dab:"/etc.clientlibs/settings/wcm/designs/ca/npc/clientlib-resources/resources/images/store-locator/ca-pin4.png",
chalus:"/etc.clientlibs/settings/wcm/designs/ca/npc/clientlib-resources/resources/images/store-locator/ca-pin-chalus.png"}};var NPC=NPC||{};
(function($){NPC.formTrouverAgence=NPC.formTrouverAgence||function(){var me={};me.countDesk=0;me.countMobile=0;me.clearAddress=function(){if(me.countDesk==0)var $desk=$("#address").val("");else me.countDesk=0};me.clearAddressMobile=function(){if(me.countMobile==0)var $mobile=$("#m-address").val("");else me.countMobile=0};me.clearCity=function(){if(me.countDesk==0){var $desk=$("#city").val("");$desk.prop("selected",true);$desk.parent().find("li.selected").removeClass("selected");me.countDesk++;$desk.trigger("change")}else me.clearAddress()};
me.clearCityMobile=function(){if(me.countMobile==0){var $mobile=$("#m-city").val("");$desk.parent().find("li.selected").removeClass("selected");me.countMobile++;$mobile.trigger("change")}else me.clearAddress()};return me}()})($);
(function($,mapManagerFactory){$(window).on("google.maps.api.loaded",function(){if(!mapManagerFactory){console.warn("error while loading store map module");return false}$(".js-StoreLocator-bloc").each(function(){var $StoreLocatorBloc=$(this);var mapManager=mapManagerFactory($StoreLocatorBloc,$StoreLocatorBloc.data("store-map-param")||{});$(window).on("storemap.init",function(){if(mapManager.requireInit()===true){console.log("storemap.init",mapManager);mapManager.initialize($StoreLocatorBloc)}});$(window).on("storemap.agenciesChanged",
function(){if(mapManager.agenciesIsChanged()===true){console.log("storemap.agenciesChanged",mapManager);mapManager.agenciesChanged($StoreLocatorBloc)}});$(window).on("storemap.resetFilters",function(){mapManager.resetFilters()})})})})(jQuery,mapManagerFactory);NPC.BV={isBoutonVertOpen:false};
$(function(){var HIDDEN_MODAL_CLASS="ContainerBvModal--hidden";var BODY_REMOVE_OVERFLOW_CLASS="is-overflowHidden";var TRUE_POPIN_MEDIA=CommonNPC.medias.mqSmMax;var bvOpened=false;var ContainerBvModalClasses=["ContainerBvModal","js-ContainerBvModal","ContainerBvModal--hidden"];var ContainerBvModalHtml='\x3cdiv class\x3d"'+ContainerBvModalClasses.join(" ")+'"/\x3e';var $ContainerBvModal=$(ContainerBvModalHtml).appendTo("body");var $ContainerBvZDG=$(".bvContainer");var $containerBase=$(".bouton-vertWrapper");
var $bvContent=$(".js-GreenBtnContainer");var isZDG5050=$ContainerBvZDG.closest(".col-md-4").length===0;var openBV=function(){bvOpened=true};var closeBV=function(){bvOpened=false};var layerBvZDGFactory=function(){var open=function(){CommonNPC.scrollTo(0);$ContainerBvZDG.prepend($bvContent)};var close=function(){$containerBase.append($bvContent)};return{init:function(){$(window).off("open.bv.zdg").on("open.bv.zdg",function(){open()}).off("close.bv.zdg").on("close.bv.zdg",function(){close()});if(bvOpened===
true)open();else close()},destroy:function(){$(window).off("open.bv.zdg").off("close.bv.zdg")},close:close}};var layerBvZDG=layerBvZDGFactory();var layerBvModalFactory=function(layerBvZDG){var $bodyHtml=$("body,html");var overlayMobile={match:function(){$(window).off("open.bv.mobile.popin").on("open.bv.mobile.popin",function(){$bodyHtml.addClass(BODY_REMOVE_OVERFLOW_CLASS)}).off("close.bv.mobile.popin").on("close.bv.mobile.popin",function(){$bodyHtml.removeClass(BODY_REMOVE_OVERFLOW_CLASS)});if(bvOpened)$bodyHtml.addClass(BODY_REMOVE_OVERFLOW_CLASS)},
unmatch:function(){if(bvOpened&&!window.matchMedia(TRUE_POPIN_MEDIA).matches){CommonNPC.scrollTo(0);$bodyHtml.removeClass(BODY_REMOVE_OVERFLOW_CLASS)}}};var setHeights=function(){var headerHeight;if(window.matchMedia(TRUE_POPIN_MEDIA).matches){var $header=$(".js-Header,.js-HeaderSticky").filter(":visible");headerHeight=$header.outerHeight(true)-$header.outerHeight();$ContainerBvModal.css({top:"",marginTop:headerHeight,minHeight:"",height:$(window.top).height()-headerHeight})}else{headerHeight=$(".Template").offset().top;
$ContainerBvModal.css({top:headerHeight,marginTop:"",minHeight:$(window.top).height()-headerHeight,height:""})}};var centerItems=function(){function getElementHeight(element){if(element)return element.outerHeight()}function centerElem(element,delta,contentHeight){if(delta>0&&contentHeight!==0)element.addClass("centerElm");else element.removeClass("centerElm")}var centerElm=$(".centerElm");if(centerElm)centerElm.each(function(){$(this).removeClass("centerElm")});var $header=$(".GreenBtn-header");var $headerWCB=
$(".GreenBtn-callbackHomeHeader");var $ContainerBvLayerWCB=$(".GreenBtn-callbackHome");var $ContainerBvLayerWCBContent=$(".GreenBtn-callbackHomeContent");var $ContainerBvLayer=$(".GreenBtn");var $ContainerBvLayerContent=$(".GreenBtn-content");var heightheader=getElementHeight($header);var heightheaderWCB=getElementHeight($headerWCB);var heightContainerBvLayerWCB=getElementHeight($ContainerBvLayerWCB);var heightContainerBvLayerWCBContent=getElementHeight($ContainerBvLayerWCBContent);var heightContainerBvLayer=
getElementHeight($ContainerBvLayer);var heightContainerBvLayerContent=getElementHeight($ContainerBvLayerContent);if($headerWCB&&$ContainerBvLayerWCB&&$ContainerBvLayerWCBContent)var DeltaWCB=heightContainerBvLayerWCB-heightContainerBvLayerWCBContent-heightheaderWCB;if($header&&$ContainerBvLayer&&$ContainerBvLayerContent)var DeltaLayer=heightContainerBvLayer-heightContainerBvLayerContent-heightheader;centerElem($ContainerBvLayerWCB,DeltaWCB,heightContainerBvLayerWCBContent);centerElem($ContainerBvLayer,
DeltaLayer,heightContainerBvLayerContent)};return{init:function(){layerBvZDG.destroy();var openPopinBV=function(){CommonNPC.scrollTo(0);$ContainerBvModal.removeClass(HIDDEN_MODAL_CLASS)};var closePopinBV=function(){$ContainerBvModal.addClass(HIDDEN_MODAL_CLASS)};$(window).off("open.bv.popin").on("open.bv.popin",openPopinBV).off("close.bv.popin").on("close.bv.popin",closePopinBV).off("layout.bv").on("layout.bv",function(){var sAgent=window.navigator.userAgent;var Idx=sAgent.indexOf("MSIE");if(Idx>
0)centerItems();else if(!!navigator.userAgent.match(/Trident\/7\./))centerItems()});$ContainerBvModal.toggleClass(HIDDEN_MODAL_CLASS,bvOpened===false);$ContainerBvModal.append($bvContent);$(window).off("load.ContainerBvOnFullPage",setHeights).on("load.ContainerBvOnFullPage",setHeights).off("header.heightChanged.ContainerBvOnFullPage",setHeights).on("header.heightChanged.ContainerBvOnFullPage",setHeights).off("marginChanged.template.ContainerBvOnFullPage",setHeights).on("marginChanged.template.ContainerBvOnFullPage",
setHeights).off("debounced-resize.ContainerBvOnFullPage",setHeights).on("debounced-resize.ContainerBvOnFullPage",setHeights);enquire.register(TRUE_POPIN_MEDIA,overlayMobile);setHeights()},destroy:function(){enquire.unregister(TRUE_POPIN_MEDIA,overlayMobile);$ContainerBvModal.css({top:"",height:""});$(window).off("load.ContainerBvOnFullPage",setHeights).off("header.heightChanged.ContainerBvOnFullPage",setHeights).off("marginChanged.template.ContainerBvOnFullPage",setHeights).off("debounced-resize.ContainerBvOnFullPage",
setHeights);layerBvZDG.init();$(window).off("open.bv.popin").off("close.bv.popin")}}};var layerBvModal=layerBvModalFactory(layerBvZDG);$(window).off("open.bv.init").on("open.bv.init",openBV).off("close.bv.init").on("close.bv.init",closeBV);if($ContainerBvZDG.length===0||isZDG5050===false)layerBvModal.init();else{layerBvZDG.init();enquire.register(CommonNPC.medias.mqSmMax,{match:layerBvModal.init,unmatch:layerBvModal.destroy})}});var NPC=NPC||{};
(function(document,$,Granite,$document){NPC.layoutTriggerd=false;var contactNumberShow=true;var isTrouverNumeroAgence=true;NPC.boutonVert=NPC.boutonVert||{};NPC.boutonVert.layerBoutonVert=NPC.boutonVert.layerBoutonVert||{};var boutonVerWrapperSelector=$(".bouton-vertWrapper");var messageOuverture;var arrayOuvertureCanaux=[];var bubblesSelector=$(".GreenBtn-callbackHomeContentBubbleLink");var selectorSelectMotifBV=$("#selectMotifBV");var numeroConseillerLienSelector=$("#numeroConseillerLien");var numeroAgenceLienSelector=
$("#numeroAgenceLien");var blockConseillerSelector=$("#blockConseiller");var blockAgenceSelector=$("#blockAgence");var conseilleDispoSelector=$("#conseilleDispo");var agenceDispoSelector=$("#agenceDispo");var infoConseiller=blockConseillerSelector.find(".GreenBtn-advisorInfo");var iconConseiller=blockConseillerSelector.find(".GreenBtn-advisorIcon").parent();var infoAgence=blockAgenceSelector.find(".GreenBtn-advisorInfo");var iconAgence=blockAgenceSelector.find(".GreenBtn-advisorIcon").parent();var erreurTechniqueBloc=
$("#erreurTechniqueBloc");var blocNonCoProblemeTableStart=$("#blocNonCoProblemeTableStart");var nonConnecteArcepBloc=$("#nonConnecteArcepBloc");var nonConnecteNumAgenceBloc=$("#nonConnecteNumAgenceBloc");NPC.AddTransactionIdToUrl=function(url){if(NPC.checkMemeOrigin(url)){var transactionId=NPC.$_GET("transactionId");if(transactionId!==undefined&&transactionId!=null&&transactionId!=="")if(url.indexOf("?")>-1)url=url+"\x26transactionId\x3d"+transactionId;else url=url+"?transactionId\x3d"+transactionId}return url};
$("#lienFaq").attr("href",NPC.recupererUrlFaq);NPC.boutonVert.layerBoutonVert._getServletUrl=function(selector){var path=window.location.pathname;var pathPart=path.split(".");var size=pathPart.length-1;if(size<1)return;pathPart.splice(size,1);var basePath=pathPart.join(".");return basePath+"/jcr:content."+selector};NPC.boutonVert.layerBoutonVert.getGpuInformation=function(){var urlGpuInfo=NPC.genererURLJson("get-info-gpu");var urlFoncInfo=NPC.genererURLJson("get-info-date");var urlStartInfo=NPC.genererURLJson("get-info-start");
var modelData=boutonVerWrapperSelector.data("value").modelData;var isConnected=NPC!=undefined&&NPC.user!=undefined&&NPC.user.isConnected!=undefined?NPC.user.isConnected:false;var agence=boutonVerWrapperSelector.data("value").agence;if(agence!="undefined"&&agence!=null){boutonVerWrapperSelector.data("value").erreurSi=false;if(isConnected){var horaireOuvertures=NPC.boutonVert.layerBoutonVert.gererMessageOuvertureAgenceConnecte(agence.messageHorairesBlocAdvisorConnecte);if(horaireOuvertures!=undefined)$(horaireOuvertures).each(function(index,
currentElement){var ligneOuverture=".ouverturesAgenceCoL"+(index+1);$(ligneOuverture).html(currentElement)})}}var numeroCR=NPC.idLiveCopyCaisse;var userTimeZoneOffset=-(new Date).getTimezoneOffset();var marcheCourant=modelData!=null&&modelData!="undefined"&&modelData.idMarche!=undefined&&modelData.idMarche!=-1?modelData.idMarche:null;var postParamsFonc={"numeroCR":numeroCR,"userTimeZoneOffset":userTimeZoneOffset};var _timeZoneCaisse=function(numeroCR){if(numeroCR=="900")return NPC.offsetGuadeloupe;
else if(numeroCR=="902")return NPC.offsetMartinique;else if(numeroCR=="903")return NPC.offsetReunion;return NPC.offsetParis};var urlFoncInfoAjax=NPC.AddTransactionIdToUrl(urlFoncInfo);$.ajax({type:"POST",url:urlFoncInfoAjax,data:postParamsFonc,cache:true,success:function(data){var dateCR=data;if(dateCR!=undefined&&dateCR!=null){var dayDateData=dateCR.dateDuJour;var dayTimeData=dateCR.dayTime;var timezoneCaisse=_timeZoneCaisse(numeroCR)/6E4;var timezoneDifference=timezoneCaisse/60-userTimeZoneOffset/
60;if(dayDateData!=undefined){var dayDateArray=dayDateData.split("-");dayDateData=new Date(dayDateArray[0],dayDateArray[1]-1,dayDateArray[2]);boutonVerWrapperSelector.data("value").dayDate=dayDateData}if(dayTimeData!=undefined)boutonVerWrapperSelector.data("value").dayTime=dayTimeData;if(timezoneDifference!=undefined)boutonVerWrapperSelector.data("value").timezone_difference=timezoneDifference}},fail:function(data){$(".bouton-vertWrapper").data("value").erreurTableStart=true;console.error("erreur d'appel Start");
NPC.boutonVert.layerBoutonVert.manageBlocs()}});if(modelData!="undefined"&&modelData!=undefined&&modelData.idMarche!=undefined){numeroCR=numeroCR!="national"&&numeroCR!="master"?numeroCR.substring(2):numeroCR;var ListeMotifArboRecup=boutonVerWrapperSelector.data("value").idMotif;var listMotifString=ListeMotifArboRecup!=null?ListeMotifArboRecup.toString():"";var postParamsGpu={"numeroCR":numeroCR,"MODE_CLIENT":isConnected,"idMarche":modelData.idMarche,"listMotifArboresence":listMotifString};var urlGpuInfoAjax=
NPC.AddTransactionIdToUrl(urlGpuInfo);$.ajax({type:"POST",url:urlGpuInfoAjax,data:postParamsGpu,cache:true,success:function(data){$(".bouton-vertWrapper").data("value").erreurGpu=false;boutonVerWrapperSelector.data("value").gpuData=data;var gpuData=boutonVerWrapperSelector.data("value").gpuData;if(gpuData!="undefined"&&gpuData!=undefined&&gpuData!=null){var themeParDefaut=gpuData.themeParDefaut;var listObjetMotif=gpuData.motifMapDeroulantes;if(themeParDefaut!=undefined&&themeParDefaut!=null&&themeParDefaut.themeId!=
undefined)delete listObjetMotif[themeParDefaut.themeId];NPC.boutonVert.layerBoutonVert.gererListeDeroulantesMotif(themeParDefaut,listObjetMotif);NPC.boutonVert.layerBoutonVert.setSelectedMotif();var postParamsStart={"numeroCR":NPC.idLiveCopyCaisse,"marche":marcheCourant};appelStartInf(postParamsStart)}boutonVerWrapperSelector.data("value").generatedAt="2017-07-18T19:56:45+0200";var idMotifSelected=boutonVerWrapperSelector.data("value").motifSelected;var resultMotif=null;var channelsListGlobal=null;
if(gpuData!=null&&gpuData!="undefined"&&gpuData!=undefined&&gpuData.listThemes!=null&&gpuData.listThemes!=undefined){channelsListGlobal=gpuData.channelsListGlobal;var motifSelected=boutonVerWrapperSelector.data("value").motifSelected;$(gpuData.listThemes).each(function(index,currentTheme){if(idMotifSelected!=undefined&&idMotifSelected.id==currentTheme.themeId){resultMotif=currentTheme;return false}})}NPC.boutonVert.layerBoutonVert.manageBlocs();if(resultMotif!=null&&resultMotif.channelsList!=null||
channelsListGlobal!=null){NPC.boutonVert.layerBoutonVert.manageBubbles(resultMotif.channelsList,channelsListGlobal,true);NPC.boutonVert.layerBoutonVert.manageMeetingMail(resultMotif.channelsList,channelsListGlobal)}},error:function(data){boutonVerWrapperSelector.data("value").erreurGpu=true;var postParamsStart={"numeroCR":NPC.idLiveCopyCaisse,"marche":marcheCourant};appelStartInf(postParamsStart);NPC.boutonVert.layerBoutonVert.manageBlocs()}})}var appelStartInf=function(postParamsStart){var urlStartInfoAjax=
NPC.AddTransactionIdToUrl(urlStartInfo);$.ajax({type:"POST",url:urlStartInfoAjax,data:postParamsStart,cache:true,success:function(data){if(data!=null){var startDataInf=data.idsParametrageAem;var startDataOpt=data.blocsParcoursOptionnel;$(".bouton-vertWrapper").data("value").startDataInf=startDataInf;$(".bouton-vertWrapper").data("value").startDataOpt=startDataOpt;if(startDataInf!=null&&startDataInf!=undefined&&startDataInf!=""&&startDataInf.length>0)NPC.boutonVert.layerBoutonVert.manageArcep();if(startDataInf!=
null&&startDataInf!=undefined&&startDataInf!=""&&startDataInf.length>0)NPC.boutonVert.layerBoutonVert.manageStartOpt(startDataOpt);if(startDataInf==undefined&&startDataOpt==undefined)$(".bouton-vertWrapper").data("value").erreurTableStart=true;NPC.boutonVert.layerBoutonVert.manageBlocs()}$(window).trigger("startBV.loaded")},error:function(data){$(".bouton-vertWrapper").data("value").erreurTableStart=true;NPC.boutonVert.layerBoutonVert.manageBlocs();$(window).trigger("startBV.loaded")}})}};$("#selectMotifBV").change(function(){$('[data-id\x3d"selectMotifBV"]').attr("data-tracking-oic_objet_demande",
this.value.toUpperCase())});NPC.boutonVert.layerBoutonVert.gererListeDeroulantesMotif=function(themeParDefaut,mapMotif){var $selectMotifBV=$('[data-id\x3d"selectMotifBV"]');selectorSelectMotifBV.find("option").remove();var firstItem=false;if(mapMotif!=undefined){if(themeParDefaut!=null&&themeParDefaut!=undefined){selectorSelectMotifBV.append("\x3coption id\x3d"+themeParDefaut.themeId+"/\x3e\x3c/option\x3e");selectorSelectMotifBV.find("[id\x3d'"+themeParDefaut.themeId+"']").html(themeParDefaut.label);
$selectMotifBV.attr("data-tracking-oic_objet_demande",themeParDefaut.label.toUpperCase());firstItem=true;selectorSelectMotifBV.selectpicker("refresh")}for(var element in mapMotif){var key=element;var value=mapMotif[element];if(firstItem==false){$selectMotifBV.attr("data-tracking-oic_objet_demande",value.toUpperCase());firstItem=true}selectorSelectMotifBV.append("\x3coption id\x3d"+key+"/\x3e\x3c/option\x3e");selectorSelectMotifBV.find("[id\x3d'"+key+"']").html(value);selectorSelectMotifBV.selectpicker("refresh")}}};
NPC.boutonVert.layerBoutonVert.donneesStartRenseignee=function(donneesStart){var donneeRenseigne=false;if(donneesStart!=null&&donneesStart.length>0)donneesStart.forEach(function(element){if(element!=undefined&&element!="")donneeRenseigne=true});return donneeRenseigne};NPC.boutonVert.layerBoutonVert.manageArcep=function(themeParDefaut,mapMotif){var TableauDonneeStart=$(".bouton-vertWrapper").data("value").startDataInf;var donneeStartInfAAfficher=null;var motifSelectionne=boutonVerWrapperSelector.data("value").motifSelected;
if(motifSelectionne==""||motifSelectionne==undefined){var modelData=boutonVerWrapperSelector.data("value").modelData;var listeMotifArboresence=$(".bouton-vertWrapper").data("value").idMotif;motifSelectionne={id:"",label:""};motifSelectionne.id=listeMotifArboresence!=null&&listeMotifArboresence.length>0?listeMotifArboresence[listeMotifArboresence.length-1]:""}var $_titreTelNonCoSelector=$(".titreTelNonCo");var $_phoneAgenceNonCoSelector=$(".phoneAgenceNonCo");var $_arcepNonCoSelector=$("#arcepNonCo");
var $_prixAppelLocalNonCoSelector=$(".prixAppelLocalNonCo");var $_ouvertureAgeneceNonCoL1Selector=$(".ouvertureAgeneceNonCoL1");var $_ouvertureAgeneceNonCoL2Selector=$(".ouvertureAgeneceNonCoL2");var $_ouvertureAgeneceNonCoL3Selector=$(".ouvertureAgeneceNonCoL3");var $_vertSelector=$("#vert");var $_grisSelector=$("#gris");var $_rougeSelector=$("#rouge");if(TableauDonneeStart!=undefined&&TableauDonneeStart!=null)$(TableauDonneeStart).each(function(index,currentElement){if(currentElement!=null&&currentElement.codeMotif!=
null&&currentElement.codeMotif==motifSelectionne.id){if(currentElement.resultatListeGenerique!=null&&currentElement.resultatListeGenerique.indexOf(";")!=-1){var d=currentElement.resultatListeGenerique.trim().replace(/(\r|\n|&nbsp;)/gi,"");donneeStartInfAAfficher=d.split(";");boutonVerWrapperSelector.data("value").startDataInfMotifSelected=donneeStartInfAAfficher}return false}});if(donneeStartInfAAfficher!=null&&NPC.boutonVert.layerBoutonVert.donneesStartRenseignee(donneeStartInfAAfficher)){contactNumberShow=
true;if(donneeStartInfAAfficher[1]!=undefined&&donneeStartInfAAfficher[1]!=""){$_titreTelNonCoSelector.show();$_titreTelNonCoSelector.html(donneeStartInfAAfficher[1])}else $_titreTelNonCoSelector.hide();if(donneeStartInfAAfficher[0]!=undefined&&donneeStartInfAAfficher[0]!=""){var tel="tel://"+donneeStartInfAAfficher[0];$_arcepNonCoSelector.attr("href",tel);$_phoneAgenceNonCoSelector.show();$_phoneAgenceNonCoSelector.html(donneeStartInfAAfficher[0]);$_phoneAgenceNonCoSelector.attr("href",tel)}else{$_phoneAgenceNonCoSelector.hide();
$_arcepNonCoSelector.attr("href","javascript: void(0);");$_phoneAgenceNonCoSelector.attr("href","javascript: void(0);")}if(donneeStartInfAAfficher[2]!=undefined&&donneeStartInfAAfficher[2]!=""){$_prixAppelLocalNonCoSelector.show();$_prixAppelLocalNonCoSelector.html(donneeStartInfAAfficher[2])}else{$_prixAppelLocalNonCoSelector.hide();$_prixAppelLocalNonCoSelector.html("")}var isHorairesOuvertureAgenceL1=donneeStartInfAAfficher[5]!=undefined&&donneeStartInfAAfficher[5].trim()!="";var isHorairesOuvertureAgenceL2=
donneeStartInfAAfficher[6]!=undefined&&donneeStartInfAAfficher[6].trim()!="";var isHorairesOuvertureAgenceL3=donneeStartInfAAfficher[7]!=undefined&&donneeStartInfAAfficher[7].trim()!="";if(isHorairesOuvertureAgenceL1||isHorairesOuvertureAgenceL2||isHorairesOuvertureAgenceL3){$_ouvertureAgeneceNonCoL1Selector.parent().show();$_ouvertureAgeneceNonCoL1Selector.html(donneeStartInfAAfficher[5]);$_ouvertureAgeneceNonCoL2Selector.html(donneeStartInfAAfficher[6]);$_ouvertureAgeneceNonCoL3Selector.html(donneeStartInfAAfficher[7])}else{$_ouvertureAgeneceNonCoL1Selector.parent().hide();
$_ouvertureAgeneceNonCoL1Selector.html("");$_ouvertureAgeneceNonCoL2Selector.html("");$_ouvertureAgeneceNonCoL3Selector.html("")}var arcepId=donneeStartInfAAfficher[3];if(arcepId!=undefined&&arcepId!=""&&arcepId!=0){var isConnected=NPC!=undefined&&NPC.user!=undefined&&NPC.user.isConnected!=undefined?NPC.user.isConnected:false;$(".bouton-vertWrapper").data("value").activationNumArcep=true;if(isConnected==false){$("#nonConnecteArcepBloc").show();if(arcepId==1){$_vertSelector.show();$_grisSelector.hide();
$_rougeSelector.hide()}else if(arcepId==2){$_grisSelector.show();$_vertSelector.hide();$_rougeSelector.hide()}else if(arcepId==3){var prixAppel=donneeStartInfAAfficher[4];if(prixAppel!=undefined&&prixAppel!=""){prixAppel=prixAppel+"\u20ac";var periodicite=" / min";$("#prixAppel").html(prixAppel);$("#prixAppel").next().html(periodicite)}$_rougeSelector.show();$_vertSelector.hide();$_grisSelector.hide()}else{$_vertSelector.hide();$_grisSelector.hide();$_rougeSelector.hide()}}}else $(".bouton-vertWrapper").data("value").activationNumArcep=
false}else{contactNumberShow=false;$_vertSelector.hide();$_grisSelector.hide();$_rougeSelector.hide();$_phoneAgenceNonCoSelector.hide();$_ouvertureAgeneceNonCoL1Selector.parent().hide();$_titreTelNonCoSelector.hide();$_prixAppelLocalNonCoSelector.html("");$_prixAppelLocalNonCoSelector.hide()}NPC.boutonVert.layerBoutonVert.manageBlocs()};NPC.boutonVert.layerBoutonVert.manageStartOpt=function(){var dataOpt=$(".bouton-vertWrapper").data("value").startDataOpt;var size=dataOpt!=undefined?dataOpt.length:
0;if(size>0){var valeur=null;for(var i=0;i<size;i++){valeur=dataOpt[i].valeur;switch(i){case 0:NPC.boutonVert.layerBoutonVert.manageOptElements("",valeur);break;case 1:NPC.boutonVert.layerBoutonVert.manageOptElements("",valeur);break;case 2:NPC.boutonVert.layerBoutonVert.manageOptElements("",valeur);break;case 3:NPC.boutonVert.layerBoutonVert.manageOptElements("",valeur);break;case 4:NPC.boutonVert.layerBoutonVert.manageOptElements("",valeur);break;case 5:NPC.boutonVert.layerBoutonVert.manageOptElements(".TrouverNumeroAgenceLien",
valeur);isTrouverNumeroAgence=valeur;break;case 6:NPC.boutonVert.layerBoutonVert.manageOptElements("#lienReclamation",valeur);break;case 7:NPC.boutonVert.layerBoutonVert.manageOptElements("conseiller",valeur);break}}}};NPC.boutonVert.layerBoutonVert.manageOptElements=function(element,value){if(element!=""){var selectorElement=element.indexOf(".")>-1||element.indexOf("#")>-1?$(element):null;var nonSelectorElement=selectorElement==null?element:null;if(selectorElement!=null)if(value==false)selectorElement.hide();
else selectorElement.show();else if(element=="conseiller"){var conseillerInfo=$(".bouton-vertWrapper").data("value").conseiller;if(conseillerInfo!=undefined&&conseillerInfo!=""&&(conseillerInfo.firstName!=null||conseillerInfo.lastName!=null)&&value)$(".bouton-vertWrapper").data("value").conseillerDispo=true}}};NPC.boutonVert.layerBoutonVert.manageMeetingMail=function(channelList,globalChannelsList){var mailAvailable=false;var meetingAvailable=false;var meetingMailFound=false;$(".caseMultiLink").show();
var parametrage=$(".bouton-vertWrapper").data("value");if(parametrage.erreurTableStart==true)meetingMailFound=false;else $(channelList).each(function(index,currentChannel){var currentGpuChannelId=this.channelId;if(currentGpuChannelId==4||currentGpuChannelId==5){var position=-1;var disponible=true;if(globalChannelsList!=null){var objetAComparer={channelId:currentGpuChannelId};position=NPC.Utils.searchItemIndexByAttributes(globalChannelsList,objetAComparer,false);if(position>-1){var channelTrouve=globalChannelsList[position];
disponible=channelTrouve!=null&&channelTrouve!=undefined?channelTrouve.available:false}}meetingMailFound=true;if(currentChannel.available==true&&disponible==true)if(currentGpuChannelId==4)mailAvailable=true;else meetingAvailable=true}});if(meetingMailFound==false||mailAvailable==false&&meetingAvailable==false){$("#caseOneLinkMail").hide();$("#caseOneLinkMeeting").hide();$(".caseMultiLink").hide()}else if(mailAvailable&&meetingAvailable){$(".caseMultiLink").show();$("#caseOneLinkMail").hide();$("#caseOneLinkMeeting").hide()}else if(mailAvailable){$("#caseOneLinkMail").show();
$(".caseMultiLink").hide();$("#caseOneLinkMeeting").hide()}else{$("#caseOneLinkMeeting").show();$("#caseOneLinkMail").hide();$("#CoBlockContactAffichage").hide();$(".caseMultiLink").hide()}};NPC.boutonVert.layerBoutonVert.manageBubbles=function(channelList,globalChannelsList,updateWcb){var dayDate=boutonVerWrapperSelector.data("value").dayDate;var dayTime=boutonVerWrapperSelector.data("value").dayTime;bubblesSelector.each(function(index2){var currentPageChannel=$(this).data("bubblenumber");if(currentPageChannel!=
undefined&&currentPageChannel.indexOf("bubble")>-1){var currentPageChannelNumber=currentPageChannel.replace("bubble","");var foundChannel=false;if(globalChannelsList!=null){var objetPourComparer={channelId:currentPageChannelNumber};var position=NPC.Utils.searchItemIndexByAttributes(globalChannelsList,objetPourComparer,false);if(position>-1){var channelTrouve=globalChannelsList[position];var disponible=channelTrouve!=null&&channelTrouve!=undefined?channelTrouve.available:false;if(disponible==true)$(channelList).each(function(index,
currentChannel){var currentGpuChannelId=this.channelId;if(currentPageChannelNumber==currentGpuChannelId){foundChannel=true;var disableChannel=true;var disableChannelExceptional=null;var scheduleList=currentChannel.schedule;var arryOuvertureCanal=[];arryOuvertureCanal=NPC.boutonVert.layerBoutonVert.fillArrayOuvertureCanal(arryOuvertureCanal,currentChannel.schedule);var exceptionalOpenning=currentChannel.exceptional0penning;var exceptionalClosing=currentChannel.exceptionalClosing;var availableChannel=
currentChannel.available;if(availableChannel==true){var conditionWCBOpen=currentGpuChannelId==2&&scheduleList!=null&&scheduleList.length>0;if(currentChannel.alwaysOpen==true||conditionWCBOpen)disableChannel=false;else{if(exceptionalOpenning!=null&&exceptionalOpenning.length>0)$(exceptionalOpenning).each(function(index,currentOpenning){currentOpenning=currentOpenning.split(" - ");var exceptionalOpennigStart=currentOpenning[0].split(" ");var exceptionalOpennigEnd=currentOpenning[1].split(" ");var day=
exceptionalOpennigStart[0].split("/");var startingTime=exceptionalOpennigStart[1];var endingTime=exceptionalOpennigEnd[1];day=new Date(day[2],day[1]-1,day[0]);var sameDay=NPC.boutonVert.layerBoutonVert.isSameDay(day,dayDate);if(sameDay){var timeLap=startingTime+" - "+endingTime;var isIn=NPC.boutonVert.layerBoutonVert.testTimeIn(timeLap,dayTime);if(isIn)disableChannelExceptional=false;return false}});if(exceptionalClosing!=null&&exceptionalClosing.length>0)$(exceptionalClosing).each(function(index,
currentClosing){currentClosing=currentClosing.split(" - ");var exceptionalClosingStart=currentClosing[0].split(" ");var exceptionalClosingEnd=currentClosing[1].split(" ");var day=exceptionalClosingStart[0].split("/");var startingTime=exceptionalClosingStart[1];var endingTime=exceptionalClosingEnd[1];day=new Date(day[2],day[1]-1,day[0]);var sameDay=NPC.boutonVert.layerBoutonVert.isSameDay(day,dayDate);if(sameDay){var timeLap=startingTime+" - "+endingTime;var isIn=NPC.boutonVert.layerBoutonVert.testTimeIn(timeLap,
dayTime);if(isIn)disableChannelExceptional=true;return false}});if(scheduleList!=null&&scheduleList.length>0)$(scheduleList).each(function(index,currentSchedule){var currentScheduleDayDate=currentSchedule.date;var scheduleTimeLaps=currentSchedule.openning;if(currentScheduleDayDate!=null&&currentScheduleDayDate!=undefined&&currentSchedule.openning!=null){currentScheduleDayDate=currentScheduleDayDate.split("-");currentScheduleDayDate=new Date(currentScheduleDayDate[0],currentScheduleDayDate[1]-1,currentScheduleDayDate[2]);
var sameDay=NPC.boutonVert.layerBoutonVert.isSameDay(currentScheduleDayDate,dayDate);if(sameDay){if(currentSchedule.holiday==false){var isIn;if(scheduleTimeLaps.indexOf(",")==-1){isIn=NPC.boutonVert.layerBoutonVert.testTimeIn(scheduleTimeLaps,dayTime);disableChannel=!isIn}else{scheduleTimeLaps=scheduleTimeLaps.split(" , ");$(scheduleTimeLaps).each(function(index,currentLaps){isIn=NPC.boutonVert.layerBoutonVert.testTimeIn(currentLaps,dayTime);if(isIn){disableChannel=false;return false}})}}return false}}})}}NPC.boutonVert.layerBoutonVert.manageChannelDisplay(availableChannel,
currentPageChannel,disableChannel,disableChannelExceptional,currentGpuChannelId,arryOuvertureCanal,updateWcb)}if(foundChannel)return false})}}var chanATags=$('a[data-bubblenumber\x3d"'+currentPageChannel+'"]');if(foundChannel===false)chanATags.each(function(index,chanA){if(updateWcb||$(chanA).parents(".tchatWCBContainer").length===0)$(chanA).hide()})}});var nombreCannauxAffichees=$('.GreenBtn-callbackHomeContentBubbleLink:not([style*\x3d"display: none"])');if(nombreCannauxAffichees.length==0){$(".GreenBtn-callbackHomeContentWayContact.moyensDeContact").hide();
$("#bubblesContainer").hide()}else{$(".GreenBtn-callbackHomeContentWayContact.moyensDeContact").show();$("#bubblesContainer").show();$(".bubblesTchatWCBContainer").show();if(nombreCannauxAffichees.length==4){$("#bubblesContainer").addClass("GreenBtn-callbackHomeContentBubbles--fourBubbles");$(".bubblesTchatWCBContainer").addClass("GreenBtn-callbackHomeContentBubbles--fourBubbles")}else{if($("#bubblesContainer").hasClass("GreenBtn-callbackHomeContentBubbles--fourBubbles"))$("#bubblesContainer").removeClass("GreenBtn-callbackHomeContentBubbles--fourBubbles");
if($(".bubblesTchatWCBContainer").hasClass("GreenBtn-callbackHomeContentBubbles--fourBubbles"))$(".bubblesTchatWCBContainer").removeClass("GreenBtn-callbackHomeContentBubbles--fourBubbles")}}var tchatBubble=$('a[data-bubblenumber\x3d"bubble1"]:not([style*\x3d"display: none"])');var wcbBubble=$('a[data-bubblenumber\x3d"bubble2"]:not([style*\x3d"display: none"])');if(!tchatBubble.length&&!wcbBubble.length)$(".tchatWCBContainer").hide();else $(".tchatWCBContainer").show()};NPC.boutonVert.layerBoutonVert.manageChannelDisplay=
function(availableChannel,currentPageChannel,disableChannel,disableChannelExceptional,currentGpuChannelId,arryOuvertureCanal,updateWcb){var chanATag=$('a[data-bubblenumber\x3d"'+currentPageChannel+'"]');var chanDivTag=chanATag.find("div[class*\x3d'GreenBtn-callbackHomeContentBubbleDisplay']");var isChanATagCorrect=chanATag!=undefined&&chanATag.find(".GreenBtn-callbackHomeContentBubble")!=undefined;if(availableChannel!=true)chanATag.each(function(index,chanA){if(updateWcb||$(chanA).parents(".tchatWCBContainer").length===
0)$(chanA).hide()});else if(disableChannel&&disableChannelExceptional!=false||!disableChannel&&disableChannelExceptional==true){if(isChanATagCorrect){chanATag.each(function(index,chanA){if(updateWcb||$(chanA).parents(".tchatWCBContainer").length===0){$(chanA).show();$(chanA).addClass("GreenBtn-callbackHomeContentBubble--disable")}});chanDivTag.addClass("GreenBtn-callbackHomeContentBubble--errorChat");messageOuverture=NPC.boutonVert.layerBoutonVert.fillChannelOpenningMessage(arryOuvertureCanal);if(messageOuverture!=
null&&messageOuverture!=undefined&&messageOuverture.trim()!=""){var objetMessageCanal={canalId:currentGpuChannelId,message:messageOuverture};NPC.boutonVert.layerBoutonVert.addToArrayOuvertureCanaux(objetMessageCanal)}}}else if(isChanATagCorrect){chanATag.each(function(index,chanA){if(updateWcb||$(chanA).parents(".tchatWCBContainer").length===0){$(chanA).show();$(chanA).removeClass("GreenBtn-callbackHomeContentBubble--disable")}});chanDivTag.removeClass("GreenBtn-callbackHomeContentBubble--errorChat");
NPC.boutonVert.layerBoutonVert.removeFromArrayOuvertureCanaux(currentGpuChannelId)}};NPC.boutonVert.layerBoutonVert.isSameDay=function(currentSechedulDate,currentDate){if(currentSechedulDate!=null&&currentSechedulDate!=undefined&&currentDate!=null&&currentDate!=undefined)try{var currentDateMs=currentDate.getTime();var currentSechedulDateMs=currentSechedulDate.getTime();if(currentSechedulDateMs==currentDateMs)return true;else return false}catch(err){return false}};NPC.boutonVert.layerBoutonVert.isTimeIn=
function(scheduleTimeLaps,dayTime){var isIn=false;if(scheduleTimeLaps!=null&&scheduleTimeLaps!=undefined&&dayTime!=null&&dayTime!=undefined)if(Array.isArray(scheduleTimeLaps))$(scheduleTimeLaps).each(function(index,currentScheduleTimeLap){isIn=NPC.boutonVert.layerBoutonVert.testTimeIn(currentScheduleTimeLap,dayTime);if(isIn)return false});else isIn=NPC.boutonVert.layerBoutonVert.testTimeIn(scheduleTimeLaps,dayTime);return isIn};NPC.boutonVert.layerBoutonVert.addToArrayOuvertureCanaux=function(objetMessageCanal){var objetPourComparer=
{canalId:objetMessageCanal.canalId};var positionInArray=NPC.Utils.searchItemIndexByAttributes(arrayOuvertureCanaux,objetPourComparer,false);if(positionInArray>-1)arrayOuvertureCanaux[positionInArray]=objetMessageCanal;else arrayOuvertureCanaux.push(objetMessageCanal)};NPC.boutonVert.layerBoutonVert.removeFromArrayOuvertureCanaux=function(canalId){var objetPourComparer={canalId:canalId};var positionInArray=NPC.Utils.searchItemIndexByAttributes(arrayOuvertureCanaux,objetPourComparer,false);if(positionInArray>
-1)arrayOuvertureCanaux.splice(positionInArray,1)};NPC.boutonVert.layerBoutonVert.formatChannelSchedule=function(schedule){var scheduleOutput=null;if(schedule!=undefined&&schedule!=null&&schedule.length>0){var countTimeLaps=(schedule.match(/\[/g)||[]).length;if(countTimeLaps>0){var scheduleTmp=schedule.replace(/\[/g,"").trim();scheduleOutput=scheduleTmp.split("]");scheduleOutput.splice(-1,1)}}return scheduleOutput};NPC.boutonVert.layerBoutonVert.testTimeIn=function(timeLap,dayTime){var isIn=false;
var formatedOppening=NPC.boutonVert.layerBoutonVert.formatChannelSchedule(timeLap);if(formatedOppening!=undefined&&formatedOppening!=null)$(formatedOppening).each(function(index,currentSchedule){isIn=NPC.boutonVert.layerBoutonVert.scheduleIsIn(currentSchedule,dayTime);if(isIn)return false});return isIn};NPC.boutonVert.layerBoutonVert.scheduleIsIn=function(schedule,dayTime){var isIn=false;var scheduleHourDebut;var scheduleHourFin;var scheduleMinDebut;var scheduleMinFin;var timeLap=NPC.boutonVert.layerBoutonVert.getStartEndScheduleOpenning(schedule);
if(timeLap!=null){var scheduleDebut=timeLap[0].split(":");var scheduleFin=timeLap[1].split(":");dayTime=dayTime.split(":");var dayHour=dayTime[0];var dayMin=dayTime[1];scheduleHourDebut=scheduleDebut[0];scheduleMinDebut=scheduleDebut[1];scheduleHourDebut=scheduleHourDebut.replace("[","");scheduleHourFin=scheduleFin[0];scheduleMinFin=scheduleFin[1];scheduleMinFin=scheduleMinFin.replace("]","");var isSupStartInfEndHour=dayHour<scheduleHourFin&&dayHour>scheduleHourDebut;var isEqualEndHourInfEndMin=dayHour==
scheduleHourFin&&dayMin<=scheduleMinFin;var isEqualStartHourSupStartMin=dayHour==scheduleHourDebut&&dayMin>=scheduleMinDebut;if(isSupStartInfEndHour||isEqualEndHourInfEndMin||isEqualStartHourSupStartMin)isIn=true}return isIn};NPC.boutonVert.layerBoutonVert.setSelectedMotif=function(){var idMotifSelected=selectorSelectMotifBV.children(":selected").attr("id");idMotifSelected=idMotifSelected!=undefined&&!isNaN(idMotifSelected)?parseInt(idMotifSelected):-1;var labelMotifSelected=idMotifSelected!=-1?selectorSelectMotifBV.find("[id\x3d'"+
idMotifSelected+"']").html():undefined;var motifSelectionne={"id":idMotifSelected,"label":labelMotifSelected};boutonVerWrapperSelector.data("value").motifSelected=motifSelectionne};NPC.boutonVert.layerBoutonVert.manageBubblesMaster=function(){$("#caseOneLinkMail").hide();$("#caseOneLinkMeeting").hide();$(window).trigger("startBV.loaded")};NPC.boutonVert.layerBoutonVert.fillArrayOuvertureCanal=function(arryOuvertureCanal,scheduleList){if(scheduleList!=null&&scheduleList.length>0)$(scheduleList).each(function(index,
currentSchedule){if(currentSchedule.openning!=null){var elementOuvertureCanal={label:currentSchedule.label,openning:currentSchedule.openning};arryOuvertureCanal.push(elementOuvertureCanal)}});return arryOuvertureCanal};NPC.boutonVert.layerBoutonVert.fillChannelOpenningMessage=function(arryOuvertureCanal){var message="";if(arryOuvertureCanal.length>0)$(arryOuvertureCanal).each(function(index,currentElement){var dayLabel=currentElement.label;var formatedOppening=NPC.boutonVert.layerBoutonVert.formatChannelSchedule(currentElement.openning);
if(formatedOppening!=undefined&&formatedOppening!=null){var arraySchedule=formatedOppening;if(arraySchedule.length==1){var openning=NPC.boutonVert.layerBoutonVert.getStartEndScheduleOpenning(arraySchedule[0]);if(openning!=null){var messageOuvertureMatin=NPC.boutonVert.layerBoutonVert.getChannelOpenningMessage(openning,dayLabel,true);message=message+messageOuvertureMatin;if(index!=arryOuvertureCanal.length-1)message=message+", "}}else if(arraySchedule.length==2){var openningMatin=NPC.boutonVert.layerBoutonVert.getStartEndScheduleOpenning(arraySchedule[0]);
var openningSoir=NPC.boutonVert.layerBoutonVert.getStartEndScheduleOpenning(arraySchedule[1]);if(openningMatin!=null){var messageOuvertureMatin=NPC.boutonVert.layerBoutonVert.getChannelOpenningMessage(openningMatin,dayLabel,true);message=message+messageOuvertureMatin}if(openningSoir!=null){var messageOuvertureSoir=NPC.boutonVert.layerBoutonVert.getChannelOpenningMessage(openningSoir,dayLabel,false);message=message+messageOuvertureSoir}if((openningMatin!=null||openningSoir!=null)&&index!=arryOuvertureCanal.length-
1)message=message+", "}}});return message};NPC.boutonVert.layerBoutonVert.getChannelOpenningMessage=function(openning,dayLabel,morning){var ouverture=openning[0].split(":");var fermeture=openning[1].split(":");var message=morning?"le "+dayLabel+" de "+ouverture[0]+"h"+ouverture[1]+" \u00e0 "+fermeture[0]+"h"+fermeture[1]:" et de "+ouverture[0]+"h"+ouverture[1]+" \u00e0 "+fermeture[0]+"h"+fermeture[1];return message};NPC.boutonVert.layerBoutonVert.gererMessageOuvertureAgenceConnecte=function(message){var messageModifie=
[];if(message!=undefined&&message!=null)if(message.indexOf(" | ")>-1){message=message.split(" | ");for(var i=0;i<message.length;i++)if(message[i]!=""){message[i]=NPC.boutonVert.layerBoutonVert.gererFormatHorairesAgenceCo(message[i]);messageModifie.push(message[i])}}else if(message[i]!=""){message=NPC.boutonVert.layerBoutonVert.gererFormatHorairesAgenceCo(message);messageModifie.push(message)}return messageModifie};NPC.boutonVert.layerBoutonVert.gererFormatHorairesAgenceCo=function(message){message=
message.replace(/:/g,"h");message=message.replace(/00/g,"");return message};NPC.boutonVert.layerBoutonVert.getStartEndScheduleOpenning=function(timeLaps){if(timeLaps.indexOf(" - ")!=-1){timeLaps=timeLaps.replace("[","");timeLaps=timeLaps.replace("]","");timeLaps=timeLaps.split(" - ")}else if(timeLaps.indexOf("-")!=-1)timeLaps=timeLaps.split("-");else timeLaps=null;return timeLaps};NPC.boutonVert.layerBoutonVert.addChannelErrorMessage=function(channelId,message){var channelName="";switch(channelId){case "1":channelName=
"Tchat";break;case "3":channelName="Visio";break;case "6":channelName="Twitter";break;case "7":channelName="Messenger";break}if(channelName!=""){message="Le service "+channelName+" est ouvert "+message;if(message.indexOf("[")>-1)message=message.replace(/\[/g,"");$("#messageChannelAvailable").html(message);$("#messageChannelAvailable").next().html("Vous pouvez nous contacter par un autre canal :")}};NPC.boutonVert.layerBoutonVert.deleteChannelErrorMessage=function(currentPageChannel){$("#messageChannelAvailable").html("");
$("#messageChannelAvailable").next().html("")};NPC.boutonVert.layerBoutonVert.refreshDisplay=function(){var $_blockContactNumberNonCo=nonConnecteNumAgenceBloc.find(".GreenBtn-callbackHomeContentContactNumber");if(nonConnecteNumAgenceBloc.css("display")=="none"||$_blockContactNumberNonCo.css("display")=="none"&&$_blockContactNumberNonCo.find(".GreenBtn-advisorScheduleWrapper").css("display")=="none"&&$(".caseMultiLink").css("display")=="none")nonConnecteNumAgenceBloc.hide();else nonConnecteNumAgenceBloc.show();
if(!NPC.layoutTriggerd){$(window).trigger("layout.bv");NPC.layoutTriggerd=true}};NPC.boutonVert.layerBoutonVert.manageBlocs=function(){var $_blockContactNumberNonCo=nonConnecteNumAgenceBloc.find(".GreenBtn-callbackHomeContentContactNumber");var $_blockContactNumberNonCoArcep=nonConnecteArcepBloc.find(".GreenBtn-callbackHomeContentContactNumber");var parametrage=$(".bouton-vertWrapper").data("value");var isEditAuthorPage=$(".tchatWCBContainer")&&$(".tchatWCBContainer").attr("value")==="EDIT";if(parametrage.erreurGpu==
true){$(".gpuReponseKo").each(function(){$(this).show()});$(".gpuReponseOk").each(function(){if(!isEditAuthorPage||$(this).parents(".tchatWCBContainer").length===0)$(this).hide()})}var isConnected=NPC!=undefined&&NPC.user!=undefined&&NPC.user.isConnected!=undefined?NPC.user.isConnected:false;if(isConnected)if(parametrage.erreurGeoloc==true||parametrage.erreurSi==true||parametrage.erreurTableStart==true&&parametrage.conseillerDispo==false){$("#reponseOkBloc").hide();erreurTechniqueBloc.show();NPC.boutonVert.layerBoutonVert.hideBlockConseiller();
NPC.boutonVert.layerBoutonVert.hideBlockAgence()}else if(parametrage.conseillerDispo==true&&parametrage.erreurTableStart==true||parametrage.conseillerDispo==false)NPC.boutonVert.layerBoutonVert.hideBlockConseiller();else{NPC.boutonVert.layerBoutonVert.showBlockConseiller();NPC.boutonVert.layerBoutonVert.hideBlockAgence();numeroAgenceLienSelector.show();numeroConseillerLienSelector.hide()}else if(parametrage.erreurGpu==false)if(parametrage.erreurTableStart==true){blocNonCoProblemeTableStart.show();
blocNonCoProblemeTableStart.find(".TrouverNumeroAgenceLien").show();nonConnecteNumAgenceBloc.hide();nonConnecteArcepBloc.hide()}else if(parametrage.activationNumArcep==true){nonConnecteArcepBloc.show();if(contactNumberShow==false&&isTrouverNumeroAgence==false)$_blockContactNumberNonCoArcep.hide();else $_blockContactNumberNonCoArcep.show();nonConnecteNumAgenceBloc.hide();blocNonCoProblemeTableStart.hide();var prixAppelLocalNonCoSelector=$(".prixAppelLocalNonCo");var prixAppelLocalValue=prixAppelLocalNonCoSelector.html();
if(prixAppelLocalValue!=undefined&&prixAppelLocalValue.trim()=="")prixAppelLocalNonCoSelector.hide();else prixAppelLocalNonCoSelector.show()}else{nonConnecteNumAgenceBloc.show();if(contactNumberShow==false&&isTrouverNumeroAgence==false)$_blockContactNumberNonCo.hide();else $_blockContactNumberNonCo.show();blocNonCoProblemeTableStart.hide();nonConnecteArcepBloc.hide();var prixAppelLocalNonCoSelector=$(".prixAppelLocalNonCo");var prixAppelLocalValue=prixAppelLocalNonCoSelector.html();if(prixAppelLocalValue!=
undefined&&prixAppelLocalValue.trim()=="")prixAppelLocalNonCoSelector.hide();else prixAppelLocalNonCoSelector.show()}};NPC.boutonVert.layerBoutonVert.hideBlockConseiller=function(){infoConseiller.addClass("hidden");iconConseiller.addClass("hidden")};NPC.boutonVert.layerBoutonVert.hideBlockAgence=function(){iconAgence.addClass("hidden");infoAgence.addClass("hidden")};NPC.boutonVert.layerBoutonVert.showBlockConseiller=function(){iconConseiller.removeClass("hidden");infoConseiller.removeClass("hidden")};
NPC.boutonVert.layerBoutonVert.showBlockAgence=function(){iconAgence.removeClass("hidden");infoAgence.removeClass("hidden")};bubblesSelector.click(function(event){var channelId=$(this).data("bubblenumber");var channelIsFound=false;if(channelId!=undefined&&channelId.indexOf("bubble")>-1){channelId=channelId.replace("bubble","");$(arrayOuvertureCanaux).each(function(index,currentChannel){if(channelId==currentChannel.canalId){var message=currentChannel.message;channelIsFound=true;NPC.boutonVert.layerBoutonVert.addChannelErrorMessage(channelId,
message);event.preventDefault()}})}if(channelIsFound==false)NPC.boutonVert.layerBoutonVert.deleteChannelErrorMessage(channelId)});numeroConseillerLienSelector.click(function(){numeroAgenceLienSelector.show();numeroConseillerLienSelector.hide();NPC.boutonVert.layerBoutonVert.hideBlockAgence();NPC.boutonVert.layerBoutonVert.showBlockConseiller()});numeroAgenceLienSelector.click(function(){numeroConseillerLienSelector.show();numeroAgenceLienSelector.hide();NPC.boutonVert.layerBoutonVert.hideBlockConseiller();
NPC.boutonVert.layerBoutonVert.showBlockAgence()});selectorSelectMotifBV.on("change",function(){NPC.boutonVert.layerBoutonVert.deleteChannelErrorMessage();NPC.boutonVert.layerBoutonVert.setSelectedMotif();NPC.boutonVert.layerBoutonVert.manageArcep();var gpuData=boutonVerWrapperSelector.data("value").gpuData;var id=$(this).children(":selected").attr("id");var listMotif=null;var globalChannelsList=null;if(gpuData!=null&&gpuData!="undefined"&&gpuData!=undefined&&gpuData!=""){listMotif=gpuData.listThemes;
globalChannelsList=gpuData.channelsListGlobal}if(id!=undefined&&listMotif!=null)$(listMotif).each(function(index,currentMotif){if(currentMotif.themeId==id){NPC.boutonVert.layerBoutonVert.manageBubbles(currentMotif.channelsList,globalChannelsList,false);NPC.boutonVert.layerBoutonVert.manageMeetingMail(currentMotif.channelsList,globalChannelsList);return false}});NPC.boutonVert.layerBoutonVert.refreshDisplay()});$(document).on("click",".openBV",function(){NPC.boutonVert.storeLocatorEmailRdv.ouvrirBoutonVert()});
$(document).on("click",".GreenBtn-callbackHomeContentContactMail, .GreenBtn-callbackHomeContentContactMeeting, #rdv, #sendEmail, .TrouverNumeroAgenceLien, #sendEmailForm",function(){$("html,body").scrollTop(0)});$(window).on("triggerBV",function(){NPC.boutonVert.storeLocatorEmailRdv.ouvrirBoutonVert()});$(".js-GreenBtn-Main").on("click",".GreenBtn-callbackHomeHeaderBtn",function(){$(window).trigger("layout.bv")})})(document,jQuery,Granite,jQuery(document));var NPC=NPC||{};
NPC.boutonVert.urlLogin="/content/ca/"+NPC.utilisateur.idLiveCopyCaisse+"/npc/"+NPC.utilisateur.langue+"/"+NPC.utilisateur.marche+"/acceder-a-mes-comptes.html";
(function(document,$,Granite,$document){$document=$(document);var SELECTEUR_CAPTCHA="#CaptchaBoutonVert";var autocompleteAdresse;NPC.boutonVert=NPC.boutonVert||{};NPC.boutonVert.storeLocatorEmailRdv=NPC.boutonVert.storeLocatorEmailRdv||{};NPC.boutonVert.storeLocatorEmailRdv.getCaptcha=function(){return $(SELECTEUR_CAPTCHA).find("[data-npc-captcha]")};NPC.boutonVert.storeLocatorEmailRdv.refreshCaptcha=function(callback){var captchaElement=NPC.boutonVert.storeLocatorEmailRdv.getCaptcha();captchaElement.npcCaptcha("refresh",
callback)};function deplaceCaptchaDansFormulaire(){NPC.boutonVert.storeLocatorEmailRdv.refreshCaptcha(function(){this.npcCaptcha("hideErrors");$(SELECTEUR_CAPTCHA).insertAfter("#CaptchaBoutonVertAfter");$(SELECTEUR_CAPTCHA).removeClass("hidden")})}function deplaceCaptchaPositionOrigine(){$(SELECTEUR_CAPTCHA).insertAfter(".js-GreenBtnContainer .GreenBtn");$(SELECTEUR_CAPTCHA).addClass("hidden")}$(".js-ContainerBvModal").on("click",".plusInfo.GreenBtn-GMap-more",function(){window.scrollTo(0,0)});NPC.boutonVert.storeLocatorEmailRdv.ouvrirBoutonVert=
function(){if(NPC.BV.isBoutonVertOpen)return;$(window).off("startBV.loaded").on("startBV.loaded",function(){NPC.boutonVert.storeLocatorEmailRdv.fermerBoutonVert();$(".GreenBtn-callbackHomeHeader").show();$(".js-GreenBtn-Main").show();$(".js-GreenBtn-Urgence").hide();$(window).trigger("open.bv");var greenBtnCallBackHome=$(".js-GreenBtnContainer .GreenBtn-callbackHome");var targetgGreenBtnCallBackHome=$(".GreenBtnContainer").find(".GreenBtn-callbackHome");targetgGreenBtnCallBackHome.show();var greenBtn=
$(".bouton-vertWrapper .GreenBtn");$(greenBtnCallBackHome).trigger("heightChanged");$(greenBtn).trigger("heightChanged");$(window).trigger("layout.bv")});var numeroCR=NPC.idLiveCopyCaisse;if(numeroCR!="master"&&numeroCR!="national")NPC.boutonVert.layerBoutonVert.getGpuInformation();else if(numeroCR=="master")NPC.boutonVert.layerBoutonVert.manageBubblesMaster();else if(numeroCR=="national")$(window).trigger("startBV.loaded")};NPC.boutonVert.storeLocatorEmailRdv.fermerBoutonVert=function(){$(window).trigger("close.bv");
NPC.layoutTriggerd=false;$(".js-GreenBtnContainer").find(".GreenBtn-callbackHome").hide();$(".js-GreenBtnContainer").find(".GreenBtn").empty()};NPC.boutonVert.storeLocatorEmailRdv.ouvrirUrgence=function(){$(".js-GreenBtn-Main").hide();$(".js-GreenBtn-Urgence").show();$(".GreenBtn-callbackHome").trigger("heightChanged")};NPC.boutonVert.storeLocatorEmailRdv.ouvrirParours=function(param){var templateParcours=$("#template-parcours-storelocator-email-rdv");var greenBtn=$(".GreenBtn");var greenBtnCallbackHome=
$(".GreenBtn-callbackHome");greenBtn.empty();greenBtn.loadTemplate(templateParcours,param);$(".GreenBtn .selectpicker").selectpicker("refresh");greenBtnCallbackHome.hide();greenBtn.show();$(window).trigger("layout.bv")};NPC.boutonVert.storeLocatorEmailRdv.retourBoutonVertFromUrgence=function(){$(".js-GreenBtn-Main").show();$(".js-GreenBtn-Urgence").hide();$(".GreenBtn-callbackHome").trigger("heightChanged");$(window).trigger("layout.bv")};NPC.boutonVert.storeLocatorEmailRdv.initDatePickerAppointment=
function(){var $birthdatepicker=$("#birthdateForm.js-appointmentCalendar");var $dayformdatepicker=$("#dayForm.js-appointmentCalendar");var lang="fr";var natDays=["2017-11-30","2017-12-25","2018-01-01"];if($birthdatepicker.length){var disabledDates=[];for(var i=0;i<natDays.length;i++)disabledDates[i]=$.fn.datepicker.DPGlobal.formatDate(new Date(natDays[i]),$.fn.datepicker.dates[lang]["format"],lang);var startDate=new Date("01/01/1850"),endDate=new Date;$birthdatepicker.datepicker({language:lang,startView:2,
startDate:startDate,endDate:endDate,autoclose:true})}if($dayformdatepicker.length)$dayformdatepicker.datepicker({todayBtn:"linked",language:lang,startDate:new Date,autoclose:true,todayHighlight:true,datesDisabled:disabledDates,daysOfWeekDisabled:[0,1]})};$(".Header-help--bouton-vert--trigger").on("click",function(){NPC.boutonVert.storeLocatorEmailRdv.ouvrirBoutonVert()});$(".bv-trigger-burger").on("click",function(e){e.preventDefault();$(window).trigger("close.layerNav");NPC.boutonVert.storeLocatorEmailRdv.ouvrirBoutonVert()});
$(".HeaderSticky-help").on("click",function(){NPC.boutonVert.storeLocatorEmailRdv.ouvrirBoutonVert()});$(".GreenBtn-callbackHomeHeaderBtn").on("click",function(){NPC.boutonVert.storeLocatorEmailRdv.ouvrirUrgence()});$document.on("click",".bouton-vertNumeroRetour",function(){NPC.boutonVert.storeLocatorEmailRdv.retourBoutonVertFromUrgence()});$(".GreenBtn-callbackClose").on("click",function(){NPC.boutonVert.storeLocatorEmailRdv.fermerBoutonVert()});$document.on("click",".TrouverNumeroAgenceLien",function(){NPC.boutonVert.storeLocatorEmailRdv.ouvrirParours({title:"trouver le num\u00e9ro d'une agence",
showHideStoreLocator:"",showHideBlocContactTel:"hidden",showHideBlocContactForm:"hidden",niveau:"1",parcours:"storelocator",lienConnexionClient:NPC.user!=null&&NPC.user.isConnected!=true?"":"hidden",itemTitlebloc:"Choisissez l'agence que vous souhaitez contacter."});intialiserAutoCompletion()});$document.on("click",".LienEnvoyerMail",function(){var blocShowTableau=$(".bouton-vertWrapper").data("value").startDataOpt;var blocInfoTableau=$(".bouton-vertWrapper").data("value").startDataInfMotifSelected;
var showHideStoreLocator=blocShowTableau!=undefined&&blocShowTableau[4]&&blocShowTableau[4].valeur?blocShowTableau[4].valeur:false;var showHideBlocContactForm=blocShowTableau!=undefined&&blocShowTableau[3]&&blocShowTableau[3].valeur?blocShowTableau[3].valeur:false;NPC.boutonVert.storeLocatorEmailRdv.ouvrirParours({title:"envoyer un email",showHideStoreLocator:showHideStoreLocator!=false?"":"hidden",showHideBlocContactTel:"hidden",showHideBlocContactForm:showHideBlocContactForm!=false?"":"hidden",
niveau:"1",boutonParcours:"sendEmail",parcours:"parcoursEmail",lienConnexionClient:NPC.user!=null&&NPC.user.isConnected!=true?"":"hidden",itemTitlebloc:"Choisissez l'agence que vous souhaitez contacter."});intialiserAutoCompletion()});$document.on("click",".LienPrendreRdv",function(){var blocShowTableau=$(".bouton-vertWrapper").data("value").startDataOpt;var blocInfoTableau=$(".bouton-vertWrapper").data("value").startDataInfMotifSelected;NPC.boutonVert.storeLocatorEmailRdv.serviceArcep={0:"",1:"Service \x26 appel gratuits",
2:"Service gratuit + prix appel",3:"Service \x3cb\x3e"+blocInfoTableau[11]+"\x3c/b\x3e \u20ac / min + prix appel"};var showHideStoreLocator=blocShowTableau!=undefined&&blocShowTableau[1]&&blocShowTableau[1].valeur?blocShowTableau[1].valeur:false;var showHideBlocContactTel=blocShowTableau!=undefined&&blocShowTableau[2]&&blocShowTableau[2].valeur?blocShowTableau[2].valeur:false;var showHideBlocContactForm=blocShowTableau!=undefined&&blocShowTableau[0]&&blocShowTableau[0].valeur?blocShowTableau[0].valeur:
false;var numberNotStartWithZero=blocInfoTableau[8]!=undefined?blocInfoTableau[8].substring(1,14):"";NPC.boutonVert.storeLocatorEmailRdv.ouvrirParours({title:"prendre rendez-vous",showHideStoreLocator:showHideStoreLocator!=false?"":"hidden",showHideBlocContactTel:showHideBlocContactTel!=false?"":"hidden",showHideBlocContactForm:showHideBlocContactForm!=false?"":"hidden",niveau:"1",sansArcep:blocInfoTableau[10]!=undefined&&blocInfoTableau[10]==="0"?"":"hidden",avecArcep:blocInfoTableau[10]!=undefined&&
blocInfoTableau[10]!=="0"?"":"hidden",serviceArcep:NPC.boutonVert.storeLocatorEmailRdv.serviceArcep[blocInfoTableau[10]],typeArcep:NPC.boutonVert.storeLocatorEmailRdv.arcep[blocInfoTableau[10]],phoneNumber:blocInfoTableau[8],phoneNumberHref:"tel://+33"+numberNotStartWithZero,callPrice:blocInfoTableau[11],greyTitle:blocInfoTableau[9],hours1:blocInfoTableau[12],hours2:blocInfoTableau[13],hours3:blocInfoTableau[14],boutonParcours:"rdv",parcours:"parcoursRdv",lienConnexionClient:NPC.user!=null&&NPC.user.isConnected!=
true?"":"hidden",itemTitlebloc:"Prendre rendez-vous en ligne."});intialiserAutoCompletion()});$(".GreenBtn").on("click",".GreenBtn-headerClose",function(){if($(".GreenBtn-back").attr("data-niveau")==="2"||$(".GreenBtn-back").attr("data-niveau")==="3"||$(".GreenBtn-back").attr("data-niveau")==="4")deplaceCaptchaPositionOrigine();NPC.boutonVert.storeLocatorEmailRdv.fermerBoutonVert();$("#FilterModal-Bv").remove()});$(".GreenBtn").on("click",'.GreenBtn-back[data-niveau\x3d"1"]',function(){$(".GreenBtn").hide();
$(".GreenBtn-callbackHome").show();$(window).trigger("layout.bv")});$(".GreenBtn").on("click",".listeAgenceGeolocalisee",function(){$(".GreenBtn .GreenBtn-back").attr("data-niveau","4")});$(".GreenBtn").on("click",'.GreenBtn-back[data-niveau\x3d"2"]',function(){deplaceCaptchaPositionOrigine();$(".GreenBtn .GreenBtn-back").attr("data-niveau","1");if($(".GreenBtn-back").attr("data-parcours")==="parcoursEmail"){var blocShowTableau=$(".bouton-vertWrapper").data("value").startDataOpt;var blocInfoTableau=
$(".bouton-vertWrapper").data("value").startDataInfMotifSelected;var showHideStoreLocator=blocShowTableau!=undefined&&blocShowTableau[4]&&blocShowTableau[4].valeur?blocShowTableau[4].valeur:false;var showHideBlocContactForm=blocShowTableau!=undefined&&blocShowTableau[3]&&blocShowTableau[3].valeur?blocShowTableau[3].valeur:false;NPC.boutonVert.storeLocatorEmailRdv.ouvrirParours({title:"envoyer un email",showHideStoreLocator:showHideStoreLocator!=false?"":"hidden",showHideBlocContactTel:"hidden",showHideBlocContactForm:showHideBlocContactForm!=
false?"":"hidden",niveau:"1",boutonParcours:"sendEmail",parcours:"parcoursEmail",lienConnexionClient:NPC.user!=null&&NPC.user.isConnected!=true?"":"hidden",itemTitlebloc:"Choisissez l'agence que vous souhaitez contacter."});intialiserAutoCompletion()}else if($(".GreenBtn-back").attr("data-parcours")==="parcoursRdv"){var blocShowTableau=$(".bouton-vertWrapper").data("value").startDataOpt;var blocInfoTableau=$(".bouton-vertWrapper").data("value").startDataInfMotifSelected;NPC.boutonVert.storeLocatorEmailRdv.serviceArcep=
{0:"",1:"Service \x26 appel gratuits",2:"Service gratuit + prix appel",3:"Service \x3cb\x3e"+blocInfoTableau[11]+"\x3c/b\x3e \u20ac / min + prix appel"};var showHideStoreLocator=blocShowTableau!=undefined&&blocShowTableau[1]&&blocShowTableau[1].valeur?blocShowTableau[1].valeur:false;var showHideBlocContactTel=blocShowTableau!=undefined&&blocShowTableau[2]&&blocShowTableau[2].valeur?blocShowTableau[2].valeur:false;var showHideBlocContactForm=blocShowTableau!=undefined&&blocShowTableau[0]&&blocShowTableau[0].valeur?
blocShowTableau[0].valeur:false;var numberNotStartWithZero=blocInfoTableau[8]!=undefined?blocInfoTableau[8].substring(1,14):"";NPC.boutonVert.storeLocatorEmailRdv.ouvrirParours({title:"prendre rendez-vous",showHideStoreLocator:showHideStoreLocator!=false?"":"hidden",showHideBlocContactTel:showHideBlocContactTel!=false?"":"hidden",showHideBlocContactForm:showHideBlocContactForm!=false?"":"hidden",niveau:"1",sansArcep:blocInfoTableau[10]!=undefined&&blocInfoTableau[10]==="0"?"":"hidden",avecArcep:blocInfoTableau[10]!=
undefined&&blocInfoTableau[10]!=="0"?"":"hidden",serviceArcep:NPC.boutonVert.storeLocatorEmailRdv.serviceArcep[blocInfoTableau[10]],typeArcep:NPC.boutonVert.storeLocatorEmailRdv.arcep[blocInfoTableau[10]],phoneNumber:blocInfoTableau[8],phoneNumberHref:"tel://+33"+numberNotStartWithZero,callPrice:blocInfoTableau[11],greyTitle:blocInfoTableau[9],hours1:blocInfoTableau[12],hours2:blocInfoTableau[13],hours3:blocInfoTableau[14],boutonParcours:"rdv",parcours:"parcoursRdv",lienConnexionClient:NPC.user!=
null&&NPC.user.isConnected!=true?"":"hidden",itemTitlebloc:"Prendre rendez-vous en ligne."});intialiserAutoCompletion()}if($("#lienConnexionBV").hasClass("hidden")&&NPC.user.isConnected===false)$("#lienConnexionBV").removeClass("hidden");$(window).trigger("layout.bv")});$(".GreenBtn").on("click",'.GreenBtn-back[data-niveau\x3d"3"]',function(){$(".GreenBtn .GreenBtn-back").attr("data-niveau","2");if($(".GreenBtn-back").attr("data-parcours")==="storelocator"){$("#FilterModal-Bv").remove();NPC.boutonVert.storeLocatorEmailRdv.ouvrirParours({title:"trouver le num\u00e9ro d'une agence",
showHideStoreLocator:"",showHideBlocContactTel:"hidden",showHideBlocContactForm:"hidden",niveau:"1",parcours:"storelocator",lienConnexionClient:NPC.user!=null&&NPC.user.isConnected!=true?"":"hidden",itemTitlebloc:"Choisissez l'agence que vous souhaitez contacter."});intialiserAutoCompletion()}else if($(".GreenBtn-back").attr("data-parcours")==="parcoursEmail"){$("#FilterModal-Bv").remove();deplaceCaptchaPositionOrigine();var blocShowTableau=$(".bouton-vertWrapper").data("value").startDataOpt;var blocInfoTableau=
$(".bouton-vertWrapper").data("value").startDataInfMotifSelected;var showHideStoreLocator=blocShowTableau!=undefined&&blocShowTableau[4]&&blocShowTableau[4].valeur?blocShowTableau[4].valeur:false;var showHideBlocContactForm=blocShowTableau!=undefined&&blocShowTableau[3]&&blocShowTableau[3].valeur?blocShowTableau[3].valeur:false;NPC.boutonVert.storeLocatorEmailRdv.ouvrirParours({title:"envoyer un email",showHideStoreLocator:showHideStoreLocator!=false?"":"hidden",showHideBlocContactTel:"hidden",showHideBlocContactForm:showHideBlocContactForm!=
false?"":"hidden",niveau:"1",boutonParcours:"sendEmail",parcours:"parcoursEmail",lienConnexionClient:NPC.user!=null&&NPC.user.isConnected!=true?"":"hidden",itemTitlebloc:"Choisissez l'agence que vous souhaitez contacter."});intialiserAutoCompletion()}else if($(".GreenBtn-back").attr("data-parcours")==="parcoursRdv"){$("#FilterModal-Bv").remove();deplaceCaptchaPositionOrigine();var blocShowTableau=$(".bouton-vertWrapper").data("value").startDataOpt;var blocInfoTableau=$(".bouton-vertWrapper").data("value").startDataInfMotifSelected;
NPC.boutonVert.storeLocatorEmailRdv.serviceArcep={0:"",1:"Service \x26 appel gratuits",2:"Service gratuit + prix appel",3:"Service \x3cb\x3e"+blocInfoTableau[11]+"\x3c/b\x3e \u20ac / min + prix appel"};var showHideStoreLocator=blocShowTableau!=undefined&&blocShowTableau[1]&&blocShowTableau[1].valeur?blocShowTableau[1].valeur:false;var showHideBlocContactTel=blocShowTableau!=undefined&&blocShowTableau[2]&&blocShowTableau[2].valeur?blocShowTableau[2].valeur:false;var showHideBlocContactForm=blocShowTableau!=
undefined&&blocShowTableau[0]&&blocShowTableau[0].valeur?blocShowTableau[0].valeur:false;var numberNotStartWithZero=blocInfoTableau[8]!=undefined?blocInfoTableau[8].substring(1,14):"";NPC.boutonVert.storeLocatorEmailRdv.ouvrirParours({title:"prendre rendez-vous",showHideStoreLocator:showHideStoreLocator!=false?"":"hidden",showHideBlocContactTel:showHideBlocContactTel!=false?"":"hidden",showHideBlocContactForm:showHideBlocContactForm!=false?"":"hidden",niveau:"1",sansArcep:blocInfoTableau[10]!=undefined&&
blocInfoTableau[10]==="0"?"":"hidden",avecArcep:blocInfoTableau[10]!=undefined&&blocInfoTableau[10]!=="0"?"":"hidden",serviceArcep:NPC.boutonVert.storeLocatorEmailRdv.serviceArcep[blocInfoTableau[10]],typeArcep:NPC.boutonVert.storeLocatorEmailRdv.arcep[blocInfoTableau[10]],phoneNumber:blocInfoTableau[8],phoneNumberHref:"tel://+33"+numberNotStartWithZero,callPrice:blocInfoTableau[11],greyTitle:blocInfoTableau[9],hours1:blocInfoTableau[12],hours2:blocInfoTableau[13],hours3:blocInfoTableau[14],boutonParcours:"rdv",
parcours:"parcoursRdv",lienConnexionClient:NPC.user!=null&&NPC.user.isConnected!=true?"":"hidden",itemTitlebloc:"Prendre rendez-vous en ligne."});intialiserAutoCompletion()}if($("#lienConnexionBV").hasClass("hidden")&&NPC.user.isConnected===false)$("#lienConnexionBV").removeClass("hidden");$(window).trigger("layout.bv")});$(".GreenBtn").on("click",'.GreenBtn-back[data-niveau\x3d"3-connecte"]',function(){if($(".GreenBtn-back").attr("data-parcours")==="parcoursEmail"){$("#FilterModal-Bv").remove();
NPC.boutonVert.storeLocatorEmailRdv.ouvrirParours({title:"envoyer un email",showHideStoreLocator:"",showHideBlocContactTel:"hidden",showHideBlocContactForm:"hidden",niveau:"1",boutonParcours:"sendEmail",parcours:"parcoursEmail",lienConnexionClient:"hidden",itemTitlebloc:"Choisissez l'agence que vous souhaitez contacter."});intialiserAutoCompletion()}else if($(".GreenBtn-back").attr("data-parcours")==="parcoursRdv"){$("#FilterModal-Bv").remove();NPC.boutonVert.storeLocatorEmailRdv.ouvrirParours({title:"prendre rendez-vous",
showHideStoreLocator:"",showHideBlocContactTel:"hidden",showHideBlocContactForm:"hidden",niveau:"1",sansArcep:"hidden",avecArcep:"hidden",serviceArcep:"",typeArcep:"",phoneNumber:"",phoneNumberHref:"",callPrice:"",greyTitle:"",hours1:"",hours2:"",hours3:"",boutonParcours:"rdv",parcours:"parcoursRdv",lienConnexionClient:"hidden",itemTitlebloc:"Prendre rendez-vous en ligne."});intialiserAutoCompletion()}$(window).trigger("layout.bv")});$(".GreenBtn").on("click",'.GreenBtn-back[data-niveau\x3d"4"]',
function(){$(".GreenBtn .GreenBtn-contentBlockInner .ficheAgence").addClass("hidden");var ficheAgence=$(".GreenBtn .GreenBtn-contentBlockInner div.ficheAgence");var boutonRetour=$(".GreenBtn .GreenBtn-contentBlockInner button.ficheAgence");ficheAgence.detach().appendTo($("#greenBtnblockContainer"));boutonRetour.detach().appendTo($("#greenBtnblockContainer"));$("#greenBtnblockContainer").addClass("GreenBtn-content--aL");$(".GreenBtn .GreenBtn-contentBlockInner .restitutionAgences").removeClass("hidden");
if(NPC.user.isConnected!=true)$(".GreenBtn .GreenBtn-back").attr("data-niveau","3");else $(".GreenBtn .GreenBtn-back").attr("data-niveau","3-connecte");$("#formulaire").addClass("hidden");if($(".GreenBtn-back").attr("data-parcours")!=="storelocator"){$(".js-blockMoreInformations").addClass("hidden");$(".js-moreInformationsLink").text("Plus d\u2019informations")}$(".js-GreenBtnContainer .js-StoreLocator-bloc").find(".js-filter").removeClass("hidden");$(window).trigger("layout.bv")});$(".GreenBtn").on("click",
"button.ficheAgence",function(){$("#FilterModal-Bv").remove();NPC.boutonVert.storeLocatorEmailRdv.fermerBoutonVert()});$(".GreenBtn").on("click","#sendEmail",function(){var qualifDemandeBv=$(".bouton-vertContent .GreenBtn-callbackHomeContentDemandForm button[data-toggle\x3d'dropdown']").attr("aria-label");var cr=NPC.idLiveCopyCaisse;var langue=NPC.utilisateur.langue;var marche=NPC.utilisateur.marche;var mentionlegales="/content/ca/"+cr+"/npc/"+langue+"/"+marche+"/mentions-legales.html";$("#greenBtnblockContainer").empty();
$("#greenBtnblockContainer").loadTemplate($("#template-email-rdv-form"),{qualifdemande:qualifDemandeBv,trackingClass:"oic_moyen_email_validation"});$("#comment").val("");deplaceCaptchaDansFormulaire();$(".emailFormHide").addClass("hidden");$("#emailContainer").removeClass("GreenBtn-callbackFormGroup--NoPadLeft");$("#emailDivMove").insertAfter($("#emailNewContainer"));$("#emailContainer").removeClass("col-sm-6");$("#emailContainer").addClass("col-sm-9");$("#greenBtnblockContainer .selectpicker").selectpicker("refresh");
$(window).trigger("datePicker.init.appointment");$(".GreenBtn .GreenBtn-back").attr("data-niveau","2");if(!$("#lienConnexionBV").hasClass("hidden")&&NPC.user.isConnected!=true)$("#lienConnexionBV").addClass("hidden");$(window).trigger("layout.bv")});$(".GreenBtn").on("click","#rdv",function(){var qualifDemandeBv=$(".bouton-vertContent .GreenBtn-callbackHomeContentDemandForm button[data-toggle\x3d'dropdown']").attr("aria-label");var cr=NPC.idLiveCopyCaisse;var langue=NPC.utilisateur.langue;var marche=
NPC.utilisateur.marche;var mentionlegales="/content/ca/"+cr+"/npc/"+langue+"/"+marche+"/mentions-legales.html";$("#greenBtnblockContainer").loadTemplate($("#template-email-rdv-form"),{qualifdemande:qualifDemandeBv,trackingClass:"oic_moyen_prise_de_rdv_validation"});$("#comment").val("");deplaceCaptchaDansFormulaire();$("#greenBtnblockContainer .selectpicker").selectpicker("refresh");$(window).trigger("datePicker.init.appointment");$(".GreenBtn .GreenBtn-back").attr("data-niveau","2");if(!$("#lienConnexionBV").hasClass("hidden")&&
NPC.user.isConnected!=true)$("#lienConnexionBV").addClass("hidden");$(window).trigger("layout.bv")});var _callBac=function(){};$document.on("click","#findAgenceAuto",function(e){e.preventDefault();var $input=$(".js-findAgenceForm-input");$input.css("border-color","#ccc");$("#emptyAdress").addClass("hidden");$("#errorAdress").addClass("hidden");$("#errorGeolocalisation").addClass("hidden");$("#noAgenceByGeolocalisation").addClass("hidden");$("#noAgenceByAdress").addClass("hidden");if(NPC.trouverAgencesRun)NPC.trouverAgencesRun()});
$document.on("submit",".js-findAgenceForm",function(e){e.preventDefault();var $input=$(".js-findAgenceForm-input");var regx=/^[a-zA-Z0-9-\u00e9\u00e8\u00e0\u00e7\u00f9', ]+$/;var str=$.trim($input.val());$input.css("border-color","#ccc");$("#emptyAdress").addClass("hidden");$("#errorAdress").addClass("hidden");$("#errorGeolocalisation").addClass("hidden");$("#noAgenceByGeolocalisation").addClass("hidden");$("#noAgenceByAdress").addClass("hidden");if(str===""){$input.css("border-color","red");$("#emptyAdress").removeClass("hidden")}else if(!regx.test(str)){$input.css("border-color",
"red");$("#errorAdress").removeClass("hidden")}else if(NPC.trouverAgencesAddresseRun){NPC.trouverAgencesAddresseRun();if(NPC.user.isConnected!=true)$(".GreenBtn .GreenBtn-back").attr("data-niveau","3");else $(".GreenBtn .GreenBtn-back").attr("data-niveau","3-connecte")}});$document.on("click",".plusInfo",function(e){e.preventDefault();var idAgence=$(this).attr("data-agenceid");$(".GreenBtn .GreenBtn-back").attr("data-niveau","4");$(".js-GreenBtnContainer .js-StoreLocator-bloc").find(".js-filter").addClass("hidden");
if($(".GreenBtn-back").attr("data-parcours")==="storelocator"){$(".GreenBtn .GreenBtn-contentBlockInner .restitutionAgences").addClass("hidden");var ficheAgence=$("div."+idAgence);var boutonRetour=$("button."+idAgence);ficheAgence.appendTo($(".GreenBtn .GreenBtn-contentBlockInner"));$(ficheAgence).attr("data-trackingclass","Impression_oic_agence");boutonRetour.appendTo($(".GreenBtn .GreenBtn-contentBlockInner"));$("."+idAgence).removeClass("hidden");$("#greenBtnblockContainer").removeClass("GreenBtn-content--aL")}else if($(".GreenBtn-back").attr("data-parcours")===
"parcoursRdv"){var ficheAgence=$("div."+idAgence).slice(0,1);$(".GreenBtn .GreenBtn-contentBlockInner .restitutionAgences").addClass("hidden");$("#formulaire").removeClass("hidden");$("#blocInsertionAgenceAfter").after(ficheAgence);$(".js-blockMoreInformations").addClass("hidden");$(".GreenBtn-contentBlockInner #masquerMoreInfo").removeClass("hidden");ficheAgence.removeClass("hidden");$(ficheAgence).attr("data-trackingclass","Impression_oic_agence");$("#greenBtnblockContainer").removeClass("GreenBtn-content--aL");
$("#greenBtnblockContainer .selectpicker").selectpicker("refresh")}else if($(".GreenBtn-back").attr("data-parcours")==="parcoursEmail"){var ficheAgence=$("div."+idAgence).slice(0,1);$(".GreenBtn .GreenBtn-contentBlockInner .restitutionAgences").addClass("hidden");$("#formulaire").removeClass("hidden");$("#blocInsertionAgenceAfter").after(ficheAgence);$(".js-blockMoreInformations").addClass("hidden");$(".GreenBtn-contentBlockInner #masquerMoreInfo").removeClass("hidden");ficheAgence.removeClass("hidden");
$(ficheAgence).attr("data-trackingclass","Impression_oic_agence");$("#greenBtnblockContainer").removeClass("GreenBtn-content--aL");$("#greenBtnblockContainer .selectpicker").selectpicker("refresh");$(".emailFormHide").addClass("hidden");$("#emailContainer").removeClass("GreenBtn-callbackFormGroup--NoPadLeft");$("#emailDivMove").insertAfter($("#emailNewContainer"));$("#emailContainer").removeClass("col-sm-6");$("#emailContainer").addClass("col-sm-9")}});$(".GreenBtn").on("click",".listeAgenceGeolocalisee",
function(e){e.preventDefault();var idAgence=$(this).attr("data-agenceid");if($(".GreenBtn-back").attr("data-parcours")==="storelocator"){$(".GreenBtn .GreenBtn-contentBlockInner .restitutionAgences").addClass("hidden");var ficheAgence=$("div."+idAgence).slice(0,1);var boutonRetour=$("button."+idAgence).slice(0,1);ficheAgence.appendTo($(".GreenBtn .GreenBtn-contentBlockInner"));boutonRetour.appendTo($(".GreenBtn .GreenBtn-contentBlockInner"));ficheAgence.removeClass("hidden");$(ficheAgence).attr("data-trackingclass",
"Impression_oic_agence");boutonRetour.removeClass("hidden");$("#greenBtnblockContainer").removeClass("GreenBtn-content--aL")}else if($(".GreenBtn-back").attr("data-parcours")==="parcoursRdv"){var ficheAgence=$("div."+idAgence).slice(0,1);$(".GreenBtn .GreenBtn-contentBlockInner .restitutionAgences").addClass("hidden");$("#formulaire").removeClass("hidden");$("#blocInsertionAgenceAfter").after(ficheAgence);$(".js-blockMoreInformations").addClass("hidden");$(".GreenBtn-contentBlockInner #masquerMoreInfo").removeClass("hidden");
ficheAgence.removeClass("hidden");$(ficheAgence).attr("data-trackingclass","Impression_oic_agence");$("#greenBtnblockContainer").removeClass("GreenBtn-content--aL");$("#greenBtnblockContainer .selectpicker").selectpicker("refresh")}else if($(".GreenBtn-back").attr("data-parcours")==="parcoursEmail"){var ficheAgence=$("div."+idAgence).slice(0,1);$(".GreenBtn .GreenBtn-contentBlockInner .restitutionAgences").addClass("hidden");$("#formulaire").removeClass("hidden");$("#blocInsertionAgenceAfter").after(ficheAgence);
$(".js-blockMoreInformations").addClass("hidden");$(".GreenBtn-contentBlockInner #masquerMoreInfo").removeClass("hidden");ficheAgence.removeClass("hidden");$(ficheAgence).attr("data-trackingclass","Impression_oic_agence");$("#greenBtnblockContainer").removeClass("GreenBtn-content--aL");$("#greenBtnblockContainer .selectpicker").selectpicker("refresh");$(".emailFormHide").addClass("hidden");$("#emailContainer").removeClass("GreenBtn-callbackFormGroup--NoPadLeft");$("#emailDivMove").insertAfter($("#emailNewContainer"));
$("#emailContainer").removeClass("col-sm-6");$("#emailContainer").addClass("col-sm-9")}if(!$("#lienConnexionBV").hasClass("hidden")&&NPC.user.isConnected!=true)$("#lienConnexionBV").addClass("hidden");$(".js-GreenBtnContainer .js-StoreLocator-bloc").find(".js-filter").addClass("hidden")});$document.on("click","#masquerMoreInfo .js-moreInformationsLink",function(e){e.preventDefault();$(".js-blockMoreInformations").toggleClass("hidden");if($(".js-blockMoreInformations").hasClass("hidden"))$(".js-moreInformationsLink").text("Plus d\u2019informations");
else if(!$(".js-blockMoreInformations").hasClass("hidden"))$(".js-moreInformationsLink").text("Masquer")});$document.on("click","#voirPlusAgences",function(e){e.preventDefault();var $listeAgence=$(".listeAgenceGeolocalisee.hidden:not(.js-storeLoc-agency)");var numberAgencies=10;$listeAgence.slice(0,numberAgencies).addClass("StoreLocatorMap-Agency").addClass("js-storeLoc-agency").removeClass("hidden");$(window).trigger("storemap.agenciesChanged");if($listeAgence.length<=numberAgencies)$(this).addClass("hidden")});
var afficherFormulaireMessagerie=function(){var blocShowTableau=$(".bouton-vertWrapper").data("value").startDataOpt;var blocInfoTableau=$(".bouton-vertWrapper").data("value").startDataInfMotifSelected;var showHideStoreLocator=blocShowTableau!=undefined&&blocShowTableau[4]&&blocShowTableau[4].valeur?blocShowTableau[4].valeur:false;var showHideBlocContactForm=blocShowTableau!=undefined&&blocShowTableau[3]&&blocShowTableau[3].valeur?blocShowTableau[3].valeur:false;NPC.boutonVert.storeLocatorEmailRdv.ouvrirParours({title:"envoyer un email",
showHideStoreLocator:showHideStoreLocator!=false?"":"hidden",showHideBlocContactTel:"hidden",showHideBlocContactForm:showHideBlocContactForm!=false?"":"hidden",niveau:"1",boutonParcours:"sendEmail",parcours:"parcoursEmail",lienConnexionClient:NPC.user!=null&&NPC.user.isConnected!=true?"":"hidden",itemTitlebloc:"Choisissez l'agence que vous souhaitez contacter."});intialiserAutoCompletion();$("#greenBtnblockContainer").empty();var qualifDemandeBv=$(".bouton-vertContent .GreenBtn-callbackHomeContentDemandForm button[data-toggle\x3d'dropdown']").attr("aria-label");
var cr=NPC.idLiveCopyCaisse;var langue=NPC.utilisateur.langue;var marche=NPC.utilisateur.marche;var mentionlegales="/content/ca/"+cr+"/npc/"+langue+"/"+marche+"/mentions-legales.html";$("#greenBtnblockContainer").loadTemplate($("#template-email-rdv-form"),{qualifdemande:qualifDemandeBv,trackingClass:"oic_moyen_email_validation"});$("#comment").val("");$(".emailFormHide").addClass("hidden");$("#emailContainer").removeClass("GreenBtn-callbackFormGroup--NoPadLeft");$("#emailDivMove").insertAfter($("#emailNewContainer"));
$("#emailContainer").removeClass("col-sm-6");$("#emailContainer").addClass("col-sm-9");$("#greenBtnblockContainer .selectpicker").selectpicker("refresh");$(window).trigger("datePicker.init.appointment");$(".GreenBtn .GreenBtn-back").attr("data-niveau","2");if(!$("#lienConnexionBV").hasClass("hidden")&&NPC.user.isConnected!=true)$("#lienConnexionBV").addClass("hidden");$(".GreenBtn .GreenBtn-back").attr("data-niveau","6");preremplissageChamps()};var preremplissageChamps=function(){var informationsClient=
$(".bouton-vertWrapper").data("value").modelData!=undefined?$(".bouton-vertWrapper").data("value").modelData.informationsClient:null;var nomClient="";var prenomClient="";var civiliteClient="";if(informationsClient!=null){var prenomsClient=informationsClient.firstNames;if(prenomsClient!=null&&prenomsClient.length>0)prenomClient=prenomsClient.join(" ");var namesOfIndividualPerson=informationsClient.namesOfIndividualPerson;if(namesOfIndividualPerson!=null)if(namesOfIndividualPerson.usualName!=null&&
namesOfIndividualPerson.usualName.trim()!="")nomClient=namesOfIndividualPerson.usualName;else if(namesOfIndividualPerson.marriedName!=null&&namesOfIndividualPerson.marriedName.trim()!="")nomClient=namesOfIndividualPerson.marriedName;else if(namesOfIndividualPerson.lastName!=null&&namesOfIndividualPerson.lastName.trim()!="")nomClient=namesOfIndividualPerson.lastName;civiliteClient=informationsClient.titleLongLabel!=null?informationsClient.titleLongLabel:""}$("#lastname").val(nomClient);$("#firstname").val(prenomClient);
if(NPC.utilisateur.email!=null)$("#emailForm").val(NPC.utilisateur.email);$("#civility option").each(function(){if(this.value===civiliteClient)$(this).prop("selected",true)});$("#civility").change()};var afficherFormulaireRdv=function(){var blocShowTableau=$(".bouton-vertWrapper").data("value").startDataOpt;var blocInfoTableau=$(".bouton-vertWrapper").data("value").startDataInfMotifSelected;NPC.boutonVert.storeLocatorEmailRdv.serviceArcep={0:"",1:"Service \x26 appel gratuits",2:"Service gratuit + prix appel",
3:"Service \x3cb\x3e"+blocInfoTableau[11]+"\x3c/b\x3e \u20ac / min + prix appel"};var showHideStoreLocator=blocShowTableau!=undefined&&blocShowTableau[1]&&blocShowTableau[1].valeur?blocShowTableau[1].valeur:false;var showHideBlocContactTel=blocShowTableau!=undefined&&blocShowTableau[2]&&blocShowTableau[2].valeur?blocShowTableau[2].valeur:false;var showHideBlocContactForm=blocShowTableau!=undefined&&blocShowTableau[0]&&blocShowTableau[0].valeur?blocShowTableau[0].valeur:false;var numberNotStartWithZero=
blocInfoTableau[8]!=undefined?blocInfoTableau[8].substring(1,14):"";NPC.boutonVert.storeLocatorEmailRdv.ouvrirParours({title:"prendre rendez-vous",showHideStoreLocator:showHideStoreLocator!=false?"":"hidden",showHideBlocContactTel:showHideBlocContactTel!=false?"":"hidden",showHideBlocContactForm:showHideBlocContactForm!=false?"":"hidden",niveau:"1",sansArcep:blocInfoTableau[10]!=undefined&&blocInfoTableau[10]==="0"?"":"hidden",avecArcep:blocInfoTableau[10]!=undefined&&blocInfoTableau[10]!=="0"?"":
"hidden",serviceArcep:NPC.boutonVert.storeLocatorEmailRdv.serviceArcep[blocInfoTableau[10]],typeArcep:NPC.boutonVert.storeLocatorEmailRdv.arcep[blocInfoTableau[10]],phoneNumber:blocInfoTableau[8],phoneNumberHref:"tel://+33"+numberNotStartWithZero,callPrice:blocInfoTableau[11],greyTitle:blocInfoTableau[9],hours1:blocInfoTableau[12],hours2:blocInfoTableau[13],hours3:blocInfoTableau[14],boutonParcours:"rdv",parcours:"parcoursRdv",lienConnexionClient:NPC.user!=null&&NPC.user.isConnected!=true?"":"hidden",
itemTitlebloc:"Prendre rendez-vous en ligne."});intialiserAutoCompletion();var qualifDemandeBv=$(".bouton-vertContent .GreenBtn-callbackHomeContentDemandForm button[data-toggle\x3d'dropdown']").attr("aria-label");var cr=NPC.idLiveCopyCaisse;var langue=NPC.utilisateur.langue;var marche=NPC.utilisateur.marche;var mentionlegales="/content/ca/"+cr+"/npc/"+langue+"/"+marche+"/mentions-legales.html";$("#greenBtnblockContainer").loadTemplate($("#template-email-rdv-form"),{qualifdemande:qualifDemandeBv,trackingClass:"oic_moyen_prise_de_rdv_validation"});
$("#comment").val("");$("#greenBtnblockContainer .selectpicker").selectpicker("refresh");$(window).trigger("datePicker.init.appointment");$(".GreenBtn .GreenBtn-back").attr("data-niveau","2");if(!$("#lienConnexionBV").hasClass("hidden")&&NPC.user.isConnected!=true)$("#lienConnexionBV").addClass("hidden");$(".GreenBtn .GreenBtn-back").attr("data-niveau","6");preremplissageChamps()};$document.ready(function(){var cr=NPC.idLiveCopyCaisse;var boutonVertRequired=NPC.recupererCookie("ouvrirBoutonVert");
if(cr!=undefined&&cr!=NPC.constantes.ID_CR_NATIONAL&&boutonVertRequired){NPC.boutonVert.storeLocatorEmailRdv.ouvrirBoutonVert();NPC.supprimerCookie("ouvrirBoutonVert")}var boutonVertRequiredModeCo=NPC.recupererCookie("ouvrirBoutonVertModeConnecte");var isConnected=NPC.user.isConnected;if(isConnected&&boutonVertRequiredModeCo){NPC.boutonVert.storeLocatorEmailRdv.ouvrirBoutonVert();NPC.supprimerCookie("ouvrirBoutonVertModeConnecte");if(!localStorage.getItem("npcd"))localStorage.setItem("BVModeConnecteOuvert",
true)}var parcoursRdvRequired=NPC.recupererCookie("boutonvertParcoursRdv");var parcoursEmailRequired=NPC.recupererCookie("boutonvertParcoursEmail");var parcoursStoreLocatorRequired=NPC.recupererCookie("boutonvertParcoursStorelocator");if(isConnected&&parcoursStoreLocatorRequired){NPC.boutonVert.storeLocatorEmailRdv.ouvrirBoutonVert();NPC.supprimerCookie("boutonvertParcoursStorelocator")}if(isConnected&&parcoursRdvRequired&&!NPC.puPriseRdvActivated){NPC.boutonVert.storeLocatorEmailRdv.ouvrirBoutonVert();
afficherFormulaireRdv();NPC.supprimerCookie("boutonvertParcoursRdv")}else if(isConnected&&parcoursRdvRequired&&NPC.puPriseRdvActivated){var marcheUser=NPC.utilisateur.libMarcheUtilisateur;if(marcheUser=="particulier"){NPC.affecterCookie("ouvrirBoutonVertModeConnecte",true);if(NPC.ihmlPriseRdvActivated)window.location.href="profil/banque-moi/prendre-un-rdv.html";else window.location.href="profil/banque-moi/prendre-rdv.html"}else{NPC.affecterCookie("ouvrirBoutonVertModeConnecte",true);if(NPC.ihmlPriseRdvActivated)window.location.href=
"profil/banque-vous/prendre-un-rdv.html";else window.location.href="profil/banque-vous/prendre-rdv.html"}NPC.supprimerCookie("boutonvertParcoursRdv")}if(isConnected&&parcoursEmailRequired&&!NPC.puMessagerieSecuriseeActivated){NPC.boutonVert.storeLocatorEmailRdv.ouvrirBoutonVert();afficherFormulaireMessagerie();NPC.supprimerCookie("boutonvertParcoursEmail")}else if(isConnected&&parcoursEmailRequired&&NPC.puMessagerieSecuriseeActivated){var marcheUser=NPC.utilisateur.libMarcheUtilisateur;if(marcheUser==
"particulier"){NPC.affecterCookie("ouvrirBoutonVertModeConnecte",true);window.location.href="profil/banque-moi/messagerie/msecriture.html"}else{NPC.affecterCookie("ouvrirBoutonVertModeConnecte",true);window.location.href="profil/banque-vous/messagerie/msecriture.html"}NPC.supprimerCookie("boutonvertParcoursEmail")}});$document.on("click",".loginGreenBtn",function(){NPC.affecterCookie("ouvrirBoutonVertModeConnecte",true)});$document.on("click",".GreenBtn-callbackUrgencyMessageBtn",function(){NPC.affecterCookie("ouvrirBoutonVert",
true)});function initAutocompleteAdresse(){if(document.getElementById("trouverAgenceByAdresse"))autocompleteAdresse=new google.maps.places.Autocomplete(document.getElementById("trouverAgenceByAdresse"),{types:["geocode"],componentRestrictions:{country:["fr","mc","gp","mq","gf","re","pm","yt","nc","pf","mf","tf"]}})}function intialiserAutoCompletion(){if(NPC.isGoogleMapsApiLoaded)initAutocompleteAdresse();else $(window).on("google.maps.api.loaded",function(){initAutocompleteAdresse()})}NPC.boutonVert.storeLocatorEmailRdv.arcep=
{0:"",1:"",2:"Arcep--grayDegraded",3:"Arcep--purpleDegraded"};if($(".bouton-vertWrapper").data("value")!=undefined){var blocShowTableau=$(".bouton-vertWrapper").data("value").startDataOpt;var blocInfoTableau=$(".bouton-vertWrapper").data("value").startDataInfMotifSelected}$document.on("click","#emailsuccess",function(){$("#FilterModal-Bv").remove();NPC.boutonVert.storeLocatorEmailRdv.fermerBoutonVert()});var isPhoneTablette=function(){var check=false;if(NPC&&NPC.informationNavigateur&&NPC.informationNavigateur.mobile)check=
true;return check};$document.on("click",".puPriseDeRdvActivated",function(e){if(isPhoneTablette()==false)NPC.affecterCookie("ouvrirBoutonVertModeConnecte",true)});$document.on("click",".puMessagerieSecuriseeActivated",function(e){if(isPhoneTablette()==false)NPC.affecterCookie("ouvrirBoutonVertModeConnecte",true)});$document.on("click",".puMessagerieSecuriseeDesactivated",function(e){NPC.boutonVert.storeLocatorEmailRdv.ouvrirParours({title:"envoyer un email",showHideStoreLocator:"",showHideBlocContactTel:"hidden",
showHideBlocContactForm:"hidden",niveau:"1",boutonParcours:"sendEmail",parcours:"parcoursEmail",lienConnexionClient:"hidden",itemTitlebloc:"Choisissez l'agence que vous souhaitez contacter."});intialiserAutoCompletion()});$document.on("click",".puPriseDeRdvDesactivated",function(e){NPC.boutonVert.storeLocatorEmailRdv.ouvrirParours({title:"prendre rendez-vous",showHideStoreLocator:"",showHideBlocContactTel:"hidden",showHideBlocContactForm:"hidden",niveau:"1",sansArcep:"hidden",avecArcep:"hidden",serviceArcep:"",
typeArcep:"",phoneNumber:"",phoneNumberHref:"",callPrice:"",greyTitle:"",hours1:"",hours2:"",hours3:"",boutonParcours:"rdv",parcours:"parcoursRdv",lienConnexionClient:"hidden",itemTitlebloc:"Prendre rendez-vous en ligne."});intialiserAutoCompletion()});$(".GreenBtn").on("click",'.GreenBtn-back[data-niveau\x3d"6"]',function(){$(".GreenBtn").hide();$(".GreenBtn-callbackHome").show()});$(".GreenBtn").on("click","#changerMotifGreenBtn",function(){if(!NPC.user.isConnected)deplaceCaptchaPositionOrigine();
$(".GreenBtn").hide();$(".GreenBtn-callbackHome").show();$("#FilterModal-Bv").remove()});$document.on("keypress change keyup","#phonenumberForm",function(e){$(this).val(function(index,value){return value.replace(/\W/gi,"").replace(/(.{2})/g,"$1 ").trim()})});$document.on("change","#country",function(){var selectedElement=$(this).find("option:selected");$("#phonenumberForm").attr("maxlength",$(selectedElement).data("maxlength")).attr("minlength",$(selectedElement).data("minlength")).val("")});$(window).on("datePicker.init.appointment",
function(){NPC.boutonVert.storeLocatorEmailRdv.initDatePickerAppointment()});$(".GreenBtn").on("click","#lienConnexionClientAccesCompte",function(){if($("#lienConnexionClientAccesCompte").hasClass("parcoursRdv"))NPC.affecterCookie("boutonvertParcoursRdv",true);else if($("#lienConnexionClientAccesCompte").hasClass("parcoursEmail"))NPC.affecterCookie("boutonvertParcoursEmail",true);else if($("#lienConnexionClientAccesCompte").hasClass("storelocator"))NPC.affecterCookie("boutonvertParcoursStorelocator",
true)});$document.on("click",".js-storeLoc-agency, .GreenBtn-GMap-more",function(){CommonNPC.scrollTo(0)})})(document,jQuery,Granite,jQuery(document));var NPC=NPC||{};NPC.trouverAGENCE=NPC.trouverAGENCE||{};NPC.geoloc=NPC.geoloc||{};
(function($){var SELECTEUR_CAPTCHA="#CaptchaBoutonVert";var recupererMarches=function(data){var markets=[];for(var market in data)if(data[market]===true)markets.push(market);var indexPro=markets.indexOf("pro");var indexFarmer=markets.indexOf("farmer");var indexAssociation=markets.indexOf("association");if(indexPro!=-1||indexFarmer!=-1||indexAssociation!=-1)markets.push("pro_farmer_association");markets.join(",");return markets};var openingDays=function(agenceWeekPlanning){var openingDay=[];if(agenceWeekPlanning!=
null&&agenceWeekPlanning!=undefined){if(agenceWeekPlanning.openMonday===true)openingDay.push("monday");if(agenceWeekPlanning.openSaturday===true)openingDay.push("saturday")}return openingDay};var horaireToday=function(weekPlanning,agence){var horaire="";if(weekPlanning!=null&&weekPlanning!=undefined&&agence.exceptionalClosure!=undefined)horaire=messageHoraire(agence,false);return horaire};var horaireTodayForMobile=function(agence){var horaire="";if(agence)horaire=messageHoraire(agence,true);return horaire};
var planingFunction=function(dayOfWeek,agence,hasOnlyRDV,hasOnlyFermTemp){var dayPlanning="";if(dayOfWeek&&agence)if(dayOfWeek.openingHours.length===0||agence.exceptionalClosure)dayPlanning="Ferm\u00e9";else if(dayOfWeek.openingHours.length===1)dayPlanning=dayOfWeek.openingHours[0].opening+"-"+dayOfWeek.openingHours[0].closing+infoSupHours(agence,dayOfWeek,0,hasOnlyRDV,hasOnlyFermTemp);else dayPlanning=dayOfWeek.openingHours[0].opening+"-"+dayOfWeek.openingHours[0].closing+infoSupHours(agence,dayOfWeek,
0,hasOnlyRDV,hasOnlyFermTemp)+" "+dayOfWeek.openingHours[1].opening+"-"+dayOfWeek.openingHours[1].closing+infoSupHours(agence,dayOfWeek,1,hasOnlyRDV,hasOnlyFermTemp);return dayPlanning};function messageHoraire(agence,mobile){var message="";if(agence.exceptionalClosure)message="Agence exceptionnellement ferm\u00e9e";else if(!agence.weekPlanning.weekScheduleOfNow)message="Agence ferm\u00e9e aujourd\u2019hui";else if(agence.weekPlanning.weekScheduleOfNow&&agence.weekPlanning.weekScheduleOfNow.opening&&
agence.weekPlanning.weekScheduleOfNow.closing)if(onRDV(agence.weekPlanning.weekScheduleOfNow)==="OUV_RDV"){message=messageAgenceOuverte(mobile,agence.weekPlanning.weekScheduleOfNow.opening,agence.weekPlanning.weekScheduleOfNow.closing);message+="\x3cbr/\x3eOuverture uniquement sur rendez-vous"}else if(onRDV(agence.weekPlanning.weekScheduleOfNow)==="FERM_TEMPO")message="Fermeture temporaire";else message=messageAgenceOuverte(mobile,agence.weekPlanning.weekScheduleOfNow.opening,agence.weekPlanning.weekScheduleOfNow.closing);
return message}function onRDV(hours){if(hours&&hours.hoursType&&hours.hoursType.hoursTypeId)return hours.hoursType.hoursTypeId;else return""}function messageAgenceOuverte(mobile,heureDebut,heureFin){if(mobile)return'Agence ouverte aujourd\u2019hui \x3cbr class\x3d"visible-xs visible-sm"/\x3ede '+heureDebut+" \u00e0 "+heureFin;else return"Agence ouverte aujourd\u2019hui de "+heureDebut+" \u00e0 "+heureFin}function infoSupHours(agence,dayOfWeek,dayIndex,hasOnlyRDV,hasOnlyFermTemp){if(!agence.exceptionalClosure&&
(dayOfWeek&&dayOfWeek.openingHours[dayIndex]&&dayOfWeek.openingHours[dayIndex].hoursType&&dayOfWeek.openingHours[dayIndex].hoursType.hoursTypeId))if((hasOnlyRDV||hasOnlyFermTemp)&&(dayOfWeek.openingHours[dayIndex].hoursType.hoursTypeId==="OUV_RDV"||dayOfWeek.openingHours[dayIndex].hoursType.hoursTypeId==="FERM_TEMPO"))return"\x3csup\x3e*\x3c/sup\x3e";else if(dayOfWeek.openingHours[dayIndex].hoursType.hoursTypeId==="OUV_RDV")return"\x3csup\x3e1\x3c/sup\x3e";else if(dayOfWeek.openingHours[dayIndex].hoursType.hoursTypeId===
"FERM_TEMPO")return"\x3csup\x3e2\x3c/sup\x3e";else return"";else return""}var ouverturePlanning=function(dayOfWeek,weekPlanning){var classe="";if(weekPlanning!=null&&dayOfWeek!=null)if(dayOfWeek.dayOfWeek=="today"&&weekPlanning.weekScheduleOfNow===null)classe="CardAgencyFunc-day--today CardAgencyFunc-day--closed";else if(dayOfWeek.dayOfWeek=="today"&&weekPlanning.weekScheduleOfNow!=null)classe="CardAgencyFunc-day--today";return classe};function combineAllMarketObj(listeAgence){return listeAgence.map(function(agency){return agency.market}).reduce(function(accu,
curr){for(var key in curr)if(curr[key]===true)if(accu!=undefined&&typeof accu==="object")if(accu.hasOwnProperty(key))accu[key]=true;return accu})}function getTrueMarketList(uniqueTypesObj){if(uniqueTypesObj)return Object.keys(uniqueTypesObj).filter(function(v){return uniqueTypesObj[v]});else return[]}function _displayResultAgences(listeAgence,estParGeoloc){if(listeAgence.length===0)if(estParGeoloc){$("#noAgenceByAdress").addClass("hidden");$("#noAgenceByGeolocalisation").removeClass("hidden")}else{$("#noAgenceByGeolocalisation").addClass("hidden");
$("#noAgenceByAdress").removeClass("hidden")}else{var uniqueTypes=combineAllMarketObj(listeAgence);var marketList={generalPublic:uniqueTypes.generalPublic,privateBanking:uniqueTypes.privateBanking,enterprise:uniqueTypes.enterprise,pro_farmer_association:uniqueTypes.pro||uniqueTypes.farmer||uniqueTypes.association,publicCollectivity:uniqueTypes.publicCollectivity};$("#greenBtnblockContainer").empty().addClass("GreenBtn-content--aL").loadTemplate($("#template-restitution-agence"),{isNotPublic:marketList.generalPublic?
"":"hidden",isNotPrivateBanking:marketList.privateBanking?"":"hidden",isNotEnterprise:marketList.enterprise?"":"hidden",isNotProFarmAssoc:marketList.pro_farmer_association?"":"hidden",isNotPublicCollectivity:marketList.publicCollectivity?"":"hidden",isNotAll:getTrueMarketList(marketList).length===1?"hidden":"",dataSize:getTrueMarketList(marketList).length}).find(".selectpicker").selectpicker("refresh");if(getTrueMarketList(marketList).length===1)$("#greenBtnblockContainer").find(".selectpicker").val(getTrueMarketList(marketList)[0]).selectpicker("refresh");
$(".js-GreenBtnContainer .js-StoreLocator-bloc").find(".js-filter").removeClass("hidden");var contentAucuneAgence='\x3cli class\x3d"StoreLocatorMap-Agency StoreLocatorMap-Agency--noResult js-StoreLocatorMap-Agency--noResult"\x3e\x3ch2 class\x3d"StoreLocatorMap-AgencyTitle"\x3eAucun r\u00e9sultat\x3c/h2\x3e\x3c/li\x3e';$(".StoreLocatorMap-AgenciesList").append(contentAucuneAgence);if(!listeAgence||listeAgence.length==0){$("#lienConnexionBV").addClass("hidden");$("#voirPlusAgences").addClass("hidden");
return}$(".GreenBtn .StoreLocatorMap-AgenciesList").loadTemplate($("#template-carte-agence"),listeAgence.map(function(agence){var data={latitude:agence.coordinates.latitude,longitude:agence.coordinates.longitude,markets:recupererMarches(agence.market),opening:openingDays(agence.weekPlanning),agenceName:agence.name,horaireTodayAgence:horaireToday(agence.weekPlanning,agence),horaireTodayAgenceForMobile:horaireTodayForMobile(agence),agenceId:"ficheAgence-"+agence.id,horaireAdressCPVille:horaireToday(agence.weekPlanning,
agence)+"\x3cbr\x3e"+agence.address.address+" "+agence.address.zipCode+" "+agence.address.cityName,agenceDistance:"~ "+agence.distance+" km",agenceIdList:"ficheAgence-"+agence.id};data.valueAttr=JSON.stringify({id:data.agenceIdList,latitude:data.latitude,longitude:data.longitude,type:data.markets,openings:data.opening});return data}),{append:true});var $listeAgenceGeoloc=$(".listeAgenceGeolocalisee");var numberAgencies=15;$listeAgenceGeoloc.slice(numberAgencies).addClass("hidden").removeClass("js-storeLoc-agency").addClass("StoreLocatorMap-Agency");
$(window).trigger("google.maps.api.loaded");$("#mapAgency").removeClass("active");$("#listAgency").addClass("active");$(".GreenBtn #greenBtnblockContainer").loadTemplate($("#template-fiche-agence"),listeAgence.map(function(agence){function generateNumeroAgence(){var phoneNumberHref=agence.contact.phoneNumber;var numeroAgence=agence.contact.phoneNumber;if(phoneNumberHref){phoneNumberHref=phoneNumberHref.split(" ").join("");phoneNumberHref=phoneNumberHref.startsWith("0")?"tel://+33"+phoneNumberHref.substr(1):
"tel://+33"+phoneNumberHref;return'\n                        \x3cspan class\x3d"CardAgencyFunc-label"\x3e Tel : \x3c/span\x3e\n                        \x3ca href\x3d"'+phoneNumberHref+'" class\x3d"CardAgencyFunc-value"\x3e'+numeroAgence+"\x3c/a\x3e\n                        "}else return""}function generateNumeroFax(){if(agence.contact.fax)return'\n                        \x3cspan class\x3d"CardAgencyFunc-label"\x3e Fax : \x3c/span\x3e\n                        \x3cspan class\x3d"CardAgencyFunc-value CardAgencyFunc-value--bold"\x3e'+
agence.contact.fax+"\x3c/span\x3e\n                    ";else return""}function generateEmail(){if(agence.contact.emailAddress)return'\n                            \x3cspan class\x3d"CardAgencyFunc-label"\x3e E-mail : \x3c/span\x3e\n                            \x3ca href\x3d"mailto://'+agence.contact.emailAddress+'" class\x3d"CardAgencyFunc-value" id\x3d"emailAgency"\x3e'+agence.contact.emailAddress+"\x3c/a\x3e\n                        ";else return""}function hasAtLeastOne(agence,status){var flag=
false;var days=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"];var weekPlanning=agence.weekPlanning?Object.keys(agence.weekPlanning).filter(function(k){return days.includes(k)}):[];weekPlanning.forEach(function(day){var dayPlanning=agence.weekPlanning[day];var ohs=dayPlanning.openingHours;if(typeof ohs!=="undefined"&&ohs.length>0)ohs.forEach(function(oh,el){var openingHour=dayPlanning.openingHours[el];if(typeof openingHour!=="undefined"){var hourTypeId=openingHour.hoursType&&
openingHour.hoursType.hoursTypeId;if(hourTypeId===status)flag=true}})});return flag}function hasAtLeastOneRDVFunc(agence){return hasAtLeastOne(agence,"OUV_RDV")}function hasAtLeastOneFermTempFunc(agence){return hasAtLeastOne(agence,"FERM_TEMPO")}var hasAtLeastOneFermTemp=hasAtLeastOneFermTempFunc(agence);var hasAtLeastOneRDV=hasAtLeastOneRDVFunc(agence);var hasOnlyRDV=hasAtLeastOneRDV&&!hasAtLeastOneFermTemp;var hasOnlyFermTemp=hasAtLeastOneFermTemp&&!hasAtLeastOneRDV;function generateRDVLegend(hasOnlyRDV,
hasOnlyFermTemp){if(!agence.exceptionalClosure&&hasAtLeastOneRDV)if(hasOnlyRDV!=hasOnlyFermTemp)return"\x3csup\x3e*\x3c/sup\x3eOuverture sur rendez-vous uniquement";else return"\x3csup\x3e1\x3c/sup\x3eOuverture sur rendez-vous uniquement";else return""}function generateTempFermLegend(hasOnlyRDV,hasOnlyFermTemp){if(!agence.exceptionalClosure&&hasAtLeastOneFermTemp)if(hasOnlyFermTemp!=hasOnlyRDV)return"\x3csup\x3e*\x3c/sup\x3eFermeture temporaire";else return"\x3csup\x3e2\x3c/sup\x3eFermeture temporaire";
else return""}return{agenceId:"ficheAgence-"+agence.id,agenceName:agence.name,horaireTodayAgence:horaireToday(agence.weekPlanning,agence),addressCpVille:agence.address.address+", "+agence.address.zipCode+" "+agence.address.cityName,phoneNumber:generateNumeroAgence(),fax:generateNumeroFax(),emailAddress:generateEmail(),planingLundi:planingFunction(agence.weekPlanning!=null?agence.weekPlanning.monday:null,agence,hasOnlyRDV,hasOnlyFermTemp),planingMardi:planingFunction(agence.weekPlanning!=null?agence.weekPlanning.tuesday:
null,agence,hasOnlyRDV,hasOnlyFermTemp),planingMercredi:planingFunction(agence.weekPlanning!=null?agence.weekPlanning.wednesday:null,agence,hasOnlyRDV,hasOnlyFermTemp),planingJeudi:planingFunction(agence.weekPlanning!=null?agence.weekPlanning.thursday:null,agence,hasOnlyRDV,hasOnlyFermTemp),planingVendredi:planingFunction(agence.weekPlanning!=null?agence.weekPlanning.friday:null,agence,hasOnlyRDV,hasOnlyFermTemp),planingSamedi:planingFunction(agence.weekPlanning!=null?agence.weekPlanning.saturday:
null,agence,hasOnlyRDV,hasOnlyFermTemp),planingDimanche:planingFunction(agence.weekPlanning!=null?agence.weekPlanning.sunday:null,agence,hasOnlyRDV,hasOnlyFermTemp),atm:agence.services.atm!=true?"hidden":"",automaticCashMachine:agence.services.automaticCashMachine!=true?"hidden":"",wheelChairAccess:agence.services.wheelChairAccess!=true?"hidden":"",carPark:agence.services.carPark!=true?"hidden":"",exchangeCurrency:agence.services.exchangeCurrency!=true?"hidden":"",extraService1Show:agence.services.extraService1!=
null&&agence.services.extraService1.trim()!=""?"":"hidden",extraService2Show:agence.services.extraService2!=null&&agence.services.extraService2.trim()!=""?"":"hidden",extraService3Show:agence.services.extraService3!=null&&agence.services.extraService3.trim()!=""?"":"hidden",extraService1:agence.services.extraService1,extraService2:agence.services.extraService2,extraService3:agence.services.extraService3,ouvertureLundi:ouverturePlanning(agence.weekPlanning!=null?agence.weekPlanning.monday:null,agence.weekPlanning!=
null?agence.weekPlanning:null),ouvertureMardi:ouverturePlanning(agence.weekPlanning!=null?agence.weekPlanning.tuesday:null,agence.weekPlanning!=null?agence.weekPlanning:null),ouvertureMercredi:ouverturePlanning(agence.weekPlanning!=null?agence.weekPlanning.wednesday:null,agence.weekPlanning!=null?agence.weekPlanning:null),ouvertureJeudi:ouverturePlanning(agence.weekPlanning!=null?agence.weekPlanning.thursday:null,agence.weekPlanning!=null?agence.weekPlanning:null),ouvertureVendredi:ouverturePlanning(agence.weekPlanning!=
null?agence.weekPlanning.friday:null,agence.weekPlanning!=null?agence.weekPlanning:null),ouvertureSamedi:ouverturePlanning(agence.weekPlanning!=null?agence.weekPlanning.saturday:null,agence.weekPlanning!=null?agence.weekPlanning:null),ouvertureSamediShow:planingFunction(agence.weekPlanning!=null?agence.weekPlanning.saturday:null,agence)=="Ferm\u00e9"?"hidden":"",ouvertureDimanche:ouverturePlanning(agence.weekPlanning!=null?agence.weekPlanning.sunday:null,agence.weekPlanning!=null?agence.weekPlanning:
null),crdAgencyFuncElementShow:agence.services.atm!=true&&agence.services.automaticCashMachine==false&&agence.services.wheelChairAccess!=true&&agence.services.carPark!=true&&agence.services.exchangeCurrency!=true&&(agence.services.extraService1!=""||agence.services.extraService1!=null)&&(agence.services.extraService2!=""||agence.services.extraService2!=null)&&(agence.services.extraService3!=""||agence.services.extraService3!=null)&&planingFunction(agence.weekPlanning!=null?agence.weekPlanning.saturday:
null,agence)=="Ferm\u00e9"?"hidden":"",legendRDV:generateRDVLegend(hasOnlyRDV,hasOnlyFermTemp),legendTempFerm:generateTempFermLegend(hasOnlyRDV,hasOnlyFermTemp)}}),{append:true});if($(".GreenBtn-back").attr("data-parcours")!=="storelocator"){var qualifDemandeBv=$(".bouton-vertContent .GreenBtn-callbackHomeContentDemandForm button[data-toggle\x3d'dropdown']").attr("aria-label");var dataTrackingClass="";if($(".GreenBtn-back").attr("data-parcours")==="parcoursRdv")dataTrackingClass="oic_moyen_prise_de_rdv_validation";
else dataTrackingClass="oic_moyen_email_validation";var cr=NPC.idLiveCopyCaisse;var langue=NPC.utilisateur.langue;var marche=NPC.utilisateur.marche;var mentionlegales="/content/ca/"+cr+"/npc/"+langue+"/"+marche+"/mentions-legales.html";$("#greenBtnblockContainer").loadTemplate($("#template-email-rdv-form"),{qualifdemande:qualifDemandeBv,trackingClass:dataTrackingClass},{append:true});$("#comment").val("");$("#formulaire").addClass("hidden");NPC.trouverAGENCE.refreshCaptcha();$(SELECTEUR_CAPTCHA).insertAfter("#CaptchaBoutonVertAfter");
$(SELECTEUR_CAPTCHA).removeClass("hidden");$(window).trigger("datePicker.init.appointment")}if(!$("#lienConnexionBV").hasClass("hidden")&&NPC.user.isConnected===false)$("#lienConnexionBV").addClass("hidden")}}var _findNearlyAgences=function(){if(NPC.storeLocator)NPC.storeLocator.trouverAgencesProches(NPC.geoloc.lat,NPC.geoloc.long,_displayResultAgences)};var afficherMessageErreur=function(){$("#errorGeolocalisation").removeClass("hidden")};var _findNearlyAgencesAddresse=function(){if(NPC.storeLocator){var addressUser=
$.trim($(".js-findAgenceForm-input").val());NPC.storeLocator.trouverAgencesProchesAdresse(addressUser,_displayResultAgences)}};NPC.trouverAGENCE.getBtnVertCaptcha=function(){return $(SELECTEUR_CAPTCHA).find("[data-npc-captcha]")};NPC.trouverAGENCE.refreshCaptcha=function(callback){var boutonVertCaptchaElement=NPC.trouverAGENCE.getBtnVertCaptcha();boutonVertCaptchaElement.npcCaptcha("refresh",callback)};NPC.trouverAGENCE.initAgences=function(){if(NPC.geoloc.geolocalized){_findNearlyAgences();if(NPC.user.isConnected!=
true)$(".GreenBtn .GreenBtn-back").attr("data-niveau","3");else $(".GreenBtn .GreenBtn-back").attr("data-niveau","3-connecte")}else if(NPC.geoloc.userDenied)afficherMessageErreur()};NPC.trouverAGENCE.initAgencesAddresse=function(){_findNearlyAgencesAddresse()};NPC.trouverAGENCE.sendEmailForm=function(lastName,firstName,phoneNumber,emailUser,emailAgency,comment,civility,country,qualifDemande,hour,day,birthDate){var captchaId="";var captchaValue="";var boutonVertCaptchaElement=NPC.trouverAGENCE.getBtnVertCaptcha();
if(boutonVertCaptchaElement.length>0){captchaId=boutonVertCaptchaElement.npcCaptcha("getId");captchaValue=boutonVertCaptchaElement.npcCaptcha("getResponse")}var postParams={"lastName":lastName,"firstName":firstName,"phoneNumber":phoneNumber,"emailUser":emailUser,"emailAgency":emailAgency,"comment":comment,"civility":civility,"country":country,"day":day,"hour":hour,"birthDate":birthDate,"qualifDemande":qualifDemande,"captchaId":captchaId,"captchaValue":captchaValue};var urlSendMailAjax=window.location.pathname.replace(".html",
".greenbtn-sendemail.json");$.ajax({type:"POST",url:urlSendMailAjax,data:postParams,cache:true,success:function(data){NPC.trouverAGENCE.refreshCaptcha();console.warn(data)},fail:function(data){NPC.trouverAGENCE.refreshCaptcha();console.error("Probleme mail envoi layer BV!")},error:function(data){NPC.trouverAGENCE.refreshCaptcha();console.error("Probleme mail envoi layer BV!")}})};$(document).on("click","form button#sendEmailForm",function(e){e.preventDefault();if(!NPC.user.isConnected){var boutonVertCaptchaElement=
NPC.trouverAGENCE.getBtnVertCaptcha();if(boutonVertCaptchaElement.length>0)boutonVertCaptchaElement.npcCaptcha("validate",function(){validationFormulaire(e)});else validationFormulaire(e)}else validationFormulaire(e)});$(document).on("input","#phonenumberForm",function(){this.value=this.value.replace(/[^0-9]/g,"")});var validationFormulaire=function(){$("#formulaire").validate({rules:{dayForm:{date:false,dateITA:true},birthdateForm:{date:false,dateITA:true},comment:{required:true,minlength:20},lastname:{required:true,
minlength:2},firstname:{required:true,minlength:2},"phonenumberForm":{required:true},emailForm:{"email":true,"required":true},checkboxMentionsLegales:{required:true}},messages:{firstname:{required:"V\u00e9rifiez votre saisie",minlength:jQuery.format("V\u00e9rifiez votre saisie")},lastname:{required:"V\u00e9rifiez votre saisie",minlength:jQuery.format("V\u00e9rifiez votre saisie")},phonenumberForm:{required:"V\u00e9rifiez votre saisie",minlength:jQuery.format("V\u00e9rifiez votre saisie"),maxlength:jQuery.format("V\u00e9rifiez votre saisie")},
emailForm:{required:"V\u00e9rifiez votre saisie","email":"Veuillez entrer une adresse email valide"},comment:{required:"Veuillez entrer au moins 20 caract\u00e8res",minlength:jQuery.format("Veuillez entrer au moins 20 caract\u00e8res")},checkboxMentionsLegales:{required:"Veuillez indiquer que vous avez bien pris connaissance des mentions l\u00e9gales"}},highlight:function(element){if(!$(element).is("textarea"))$(element).closest(".form-group").addClass("has-error");else $(element).addClass("GreenBtn-contentBlockItemTextarea--error")},
unhighlight:function(element){if(!$(element).is("textarea"))$(element).closest(".form-group").removeClass("has-error");else $(element).removeClass("GreenBtn-contentBlockItemTextarea--error")},errorElement:"p",errorClass:"has-error",errorPlacement:function(error,element){if(element.is(":checkbox")){element.closest(".checkbox").parent().append(error);error.css("color","#d70000")}else if(element.is("textarea")){error.css("color","#d70000");error.insertAfter(element)}else{if(!error.hasClass("help-block"))error.addClass("help-block");
error.insertAfter(element)}}});if($("#formulaire").valid()){var blocShowTableau=$(".bouton-vertWrapper").data("value").startDataOpt;var blocInfoTableau=$(".bouton-vertWrapper").data("value").startDataInfMotifSelected;var lastName=$(".GreenBtn #lastname").val();var firstName=$(".GreenBtn #firstname").val();var phoneNumber=$(".GreenBtn #phonenumberForm").val();var emailUser=$(".GreenBtn #emailForm").val();var comment=$(".GreenBtn #comment").val().replace(/\n/g,"\x3cbr/\x3e");var civility=$(".GreenBtn button[data-id\x3d'civility']").attr("aria-label");
var country=$(".GreenBtn button[data-id\x3d'country']").attr("aria-label");var qualifDemande=$(".bouton-vertContent .GreenBtn-callbackHomeContentDemandForm button[data-toggle\x3d'dropdown']").attr("aria-label");var hour=$(".GreenBtn button[data-id\x3d'hour']").attr("aria-label");var day=$(".GreenBtn #dayForm").val();var birthDate=$(".GreenBtn #birthdateForm").val();var emailagenceca=$("#formulaire .ficheAgence #emailAgency").html();var messageEmailSuccess="";var emailAgency="";if($(".GreenBtn-back").attr("data-parcours")===
"parcoursEmail"){messageEmailSuccess="Votre message a bien \u00e9t\u00e9 envoy\u00e9.";if($(".GreenBtn-back").attr("data-niveau")==="4")emailAgency=emailagenceca;else emailAgency=blocInfoTableau[15];NPC.trouverAGENCE.sendEmailForm(lastName,firstName,phoneNumber,emailUser,emailAgency,comment,civility,country,qualifDemande)}else{messageEmailSuccess="Votre demande de rendez-vous a bien \u00e9t\u00e9 envoy\u00e9e.";if($(".GreenBtn-back").attr("data-niveau")==="4")emailAgency=emailagenceca;else emailAgency=
blocInfoTableau[15];NPC.trouverAGENCE.sendEmailForm(lastName,firstName,phoneNumber,emailUser,emailAgency,comment,civility,country,qualifDemande,hour,day,birthDate)}if($(".GreenBtn-back").attr("data-niveau")==="2"||$(".GreenBtn-back").attr("data-niveau")==="4"){$(SELECTEUR_CAPTCHA).insertAfter(".js-GreenBtnContainer .GreenBtn");$(SELECTEUR_CAPTCHA).addClass("hidden")}$("#greenBtnblockContainer").loadTemplate($("#template-emailform-success"),{messageParcours:messageEmailSuccess,niveauParcours:"emailsuccess"});
$(window).trigger("layout.bv");$(".GreenBtn-back").addClass("hidden")}else $("#formulaire").valid()}})($);
(function($){$.extend($.fn,{validate:function(options){if(!this.length){options&&options.debug&&window.console&&console.warn("nothing selected, can't validate, returning nothing");return}var validator=$.data(this[0],"validator");if(validator)return validator;this.attr("novalidate","novalidate");validator=new $.validator(options,this[0]);$.data(this[0],"validator",validator);if(validator.settings.onsubmit){var inputsAndButtons=this.find("input, button");inputsAndButtons.filter(".cancel").click(function(){validator.cancelSubmit=
true});if(validator.settings.submitHandler)inputsAndButtons.filter(":submit").click(function(){validator.submitButton=this});this.submit(function(event){if(validator.settings.debug)event.preventDefault();function handle(){if(validator.settings.submitHandler){if(validator.submitButton)var hidden=$("\x3cinput type\x3d'hidden'/\x3e").attr("name",validator.submitButton.name).val(validator.submitButton.value).appendTo(validator.currentForm);validator.settings.submitHandler.call(validator,validator.currentForm);
if(validator.submitButton)hidden.remove();return false}return true}if(validator.cancelSubmit){validator.cancelSubmit=false;return handle()}if(validator.form()){if(validator.pendingRequest){validator.formSubmitted=true;return false}return handle()}else{validator.focusInvalid();return false}})}return validator},valid:function(){if($(this[0]).is("form"))return this.validate().form();else{var valid=true;var validator=$(this[0].form).validate();this.each(function(){valid&=validator.element(this)});return valid}},
removeAttrs:function(attributes){var result={},$element=this;$.each(attributes.split(/\s/),function(index,value){result[value]=$element.attr(value);$element.removeAttr(value)});return result},rules:function(command,argument){var element=this[0];if(command){var settings=$.data(element.form,"validator").settings;var staticRules=settings.rules;var existingRules=$.validator.staticRules(element);switch(command){case "add":$.extend(existingRules,$.validator.normalizeRule(argument));staticRules[element.name]=
existingRules;if(argument.messages)settings.messages[element.name]=$.extend(settings.messages[element.name],argument.messages);break;case "remove":if(!argument){delete staticRules[element.name];return existingRules}var filtered={};$.each(argument.split(/\s/),function(index,method){filtered[method]=existingRules[method];delete existingRules[method]});return filtered}}var data=$.validator.normalizeRules($.extend({},$.validator.metadataRules(element),$.validator.classRules(element),$.validator.attributeRules(element),
$.validator.staticRules(element)),element);if(data.required){var param=data.required;delete data.required;data=$.extend({required:param},data)}return data}});$.extend($.expr[":"],{blank:function(a){return!$.trim(""+a.value)},filled:function(a){return!!$.trim(""+a.value)},unchecked:function(a){return!a.checked}});$.validator=function(options,form){this.settings=$.extend(true,{},$.validator.defaults,options);this.currentForm=form;this.init()};$.validator.format=function(source,params){if(arguments.length==
1)return function(){var args=$.makeArray(arguments);args.unshift(source);return $.validator.format.apply(this,args)};if(arguments.length>2&&params.constructor!=Array)params=$.makeArray(arguments).slice(1);if(params.constructor!=Array)params=[params];$.each(params,function(i,n){source=source.replace(new RegExp("\\{"+i+"\\}","g"),n)});return source};$.extend($.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",validClass:"valid",errorElement:"label",focusInvalid:true,errorContainer:$([]),
errorLabelContainer:$([]),onsubmit:true,ignore:":hidden",ignoreTitle:false,onfocusin:function(element,event){this.lastActive=element;if(this.settings.focusCleanup&&!this.blockFocusCleanup){this.settings.unhighlight&&this.settings.unhighlight.call(this,element,this.settings.errorClass,this.settings.validClass);this.addWrapper(this.errorsFor(element)).hide()}},onfocusout:function(element,event){if(!this.checkable(element)&&(element.name in this.submitted||!this.optional(element)))this.element(element)},
onkeyup:function(element,event){this.valid();this.element(element)},onclick:function(element,event){if(element.name in this.submitted)this.element(element);else if(element.parentNode.name in this.submitted)this.element(element.parentNode)},highlight:function(element,errorClass,validClass){if(element.type==="radio")this.findByName(element.name).addClass(errorClass).removeClass(validClass);else $(element).addClass(errorClass).removeClass(validClass)},unhighlight:function(element,errorClass,validClass){if(element.type===
"radio")this.findByName(element.name).removeClass(errorClass).addClass(validClass);else $(element).removeClass(errorClass).addClass(validClass)}},setDefaults:function(settings){$.extend($.validator.defaults,settings)},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Please enter a valid number.",digits:"Please enter only digits.",
creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",accept:"Please enter a value with a valid extension.",maxlength:$.validator.format("Please enter no more than {0} characters."),minlength:$.validator.format("Please enter at least {0} characters."),rangelength:$.validator.format("Please enter a value between {0} and {1} characters long."),range:$.validator.format("Please enter a value between {0} and {1}."),max:$.validator.format("Please enter a value less than or equal to {0}."),
min:$.validator.format("Please enter a value greater than or equal to {0}.")},autoCreateRanges:false,prototype:{init:function(){this.labelContainer=$(this.settings.errorLabelContainer);this.errorContext=this.labelContainer.length&&this.labelContainer||$(this.currentForm);this.containers=$(this.settings.errorContainer).add(this.settings.errorLabelContainer);this.submitted={};this.valueCache={};this.pendingRequest=0;this.pending={};this.invalid={};this.reset();var groups=this.groups={};$.each(this.settings.groups,
function(key,value){$.each(value.split(/\s/),function(index,name){groups[name]=key})});var rules=this.settings.rules;$.each(rules,function(key,value){rules[key]=$.validator.normalizeRule(value)});function delegate(event){var validator=$.data(this[0].form,"validator"),eventType="on"+event.type.replace(/^validate/,"");validator.settings[eventType]&&validator.settings[eventType].call(validator,this[0],event)}$(this.currentForm).validateDelegate("[type\x3d'text'], [type\x3d'password'], [type\x3d'file'], select, textarea, "+
"[type\x3d'number'], [type\x3d'search'] ,[type\x3d'tel'], [type\x3d'url'], "+"[type\x3d'email'], [type\x3d'datetime'], [type\x3d'date'], [type\x3d'month'], "+"[type\x3d'week'], [type\x3d'time'], [type\x3d'datetime-local'], "+"[type\x3d'range'], [type\x3d'color'] ","focusin focusout keyup",delegate).validateDelegate("[type\x3d'radio'], [type\x3d'checkbox'], select, option","click",delegate);if(this.settings.invalidHandler)$(this.currentForm).bind("invalid-form.validate",this.settings.invalidHandler)},
form:function(){this.checkForm();$.extend(this.submitted,this.errorMap);this.invalid=$.extend({},this.errorMap);if(!this.valid())$(this.currentForm).triggerHandler("invalid-form",[this]);this.showErrors();return this.valid()},checkForm:function(){this.prepareForm();for(var i=0,elements=this.currentElements=this.elements();elements[i];i++)this.check(elements[i]);return this.valid()},element:function(element){element=this.validationTargetFor(this.clean(element));this.lastElement=element;this.prepareElement(element);
this.currentElements=$(element);var result=this.check(element);if(result)delete this.invalid[element.name];else this.invalid[element.name]=true;if(!this.numberOfInvalids())this.toHide=this.toHide.add(this.containers);this.showErrors();return result},showErrors:function(errors){if(errors){$.extend(this.errorMap,errors);this.errorList=[];for(var name in errors)this.errorList.push({message:errors[name],element:this.findByName(name)[0]});this.successList=$.grep(this.successList,function(element){return!(element.name in
errors)})}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){if($.fn.resetForm)$(this.currentForm).resetForm();this.submitted={};this.lastElement=null;this.prepareForm();this.hideErrors();this.elements().removeClass(this.settings.errorClass)},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(obj){var count=0;for(var i in obj)count++;return count},hideErrors:function(){this.addWrapper(this.toHide).hide()},
valid:function(){return this.size()==0},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid)try{$(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(e){}},findLastActive:function(){var lastActive=this.lastActive;return lastActive&&$.grep(this.errorList,function(n){return n.element.name==lastActive.name}).length==1&&lastActive},elements:function(){var validator=this,rulesCache=
{};return $(this.currentForm).find("input, select, textarea").not(":submit, :reset, :image, [disabled]").not(this.settings.ignore).filter(function(){!this.name&&validator.settings.debug&&window.console&&console.error("%o has no name assigned",this);if(this.name in rulesCache||!validator.objectLength($(this).rules()))return false;rulesCache[this.name]=true;return true})},clean:function(selector){return $(selector)[0]},errors:function(){return $(this.settings.errorElement+"."+this.settings.errorClass,
this.errorContext)},reset:function(){this.successList=[];this.errorList=[];this.errorMap={};this.toShow=$([]);this.toHide=$([]);this.currentElements=$([])},prepareForm:function(){this.reset();this.toHide=this.errors().add(this.containers)},prepareElement:function(element){this.reset();this.toHide=this.errorsFor(element)},check:function(element){element=this.validationTargetFor(this.clean(element));var rules=$(element).rules();var dependencyMismatch=false;for(var method in rules){var rule={method:method,
parameters:rules[method]};try{var result=$.validator.methods[method].call(this,element.value.replace(/\r/g,""),element,rule.parameters);if(result=="dependency-mismatch"){dependencyMismatch=true;continue}dependencyMismatch=false;if(result=="pending"){this.toHide=this.toHide.not(this.errorsFor(element));return}if(!result){this.formatAndAdd(element,rule);return false}}catch(e){this.settings.debug&&window.console&&console.log("exception occured when checking element "+element.id+", check the '"+rule.method+
"' method",e);throw e;}}if(dependencyMismatch)return;if(this.objectLength(rules))this.successList.push(element);return true},customMetaMessage:function(element,method){if(!$.metadata)return;var meta=this.settings.meta?$(element).metadata()[this.settings.meta]:$(element).metadata();return meta&&meta.messages&&meta.messages[method]},customMessage:function(name,method){var m=this.settings.messages[name];return m&&(m.constructor==String?m:m[method])},findDefined:function(){for(var i=0;i<arguments.length;i++)if(arguments[i]!==
undefined)return arguments[i];return undefined},defaultMessage:function(element,method){return this.findDefined(this.customMessage(element.name,method),this.customMetaMessage(element,method),!this.settings.ignoreTitle&&element.title||undefined,$.validator.messages[method],"\x3cstrong\x3eWarning: No message defined for "+element.name+"\x3c/strong\x3e")},formatAndAdd:function(element,rule){var message=this.defaultMessage(element,rule.method),theregex=/\$?\{(\d+)\}/g;if(typeof message=="function")message=
message.call(this,rule.parameters,element);else if(theregex.test(message))message=jQuery.format(message.replace(theregex,"{$1}"),rule.parameters);this.errorList.push({message:message,element:element});this.errorMap[element.name]=message;this.submitted[element.name]=message},addWrapper:function(toToggle){if(this.settings.wrapper)toToggle=toToggle.add(toToggle.parent(this.settings.wrapper));return toToggle},defaultShowErrors:function(){for(var i=0;this.errorList[i];i++){var error=this.errorList[i];
this.settings.highlight&&this.settings.highlight.call(this,error.element,this.settings.errorClass,this.settings.validClass);this.showLabel(error.element,error.message)}if(this.errorList.length)this.toShow=this.toShow.add(this.containers);if(this.settings.success)for(var i=0;this.successList[i];i++)this.showLabel(this.successList[i]);if(this.settings.unhighlight)for(var i=0,elements=this.validElements();elements[i];i++)this.settings.unhighlight.call(this,elements[i],this.settings.errorClass,this.settings.validClass);
this.toHide=this.toHide.not(this.toShow);this.hideErrors();this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return $(this.errorList).map(function(){return this.element})},showLabel:function(element,message){var label=this.errorsFor(element);if(label.length){label.removeClass(this.settings.validClass).addClass(this.settings.errorClass);label.attr("generated")&&label.html(message)}else{label=$("\x3c"+this.settings.errorElement+
"/\x3e").attr({"for":this.idOrName(element),generated:true}).addClass(this.settings.errorClass).html(message||"");if(this.settings.wrapper)label=label.hide().show().wrap("\x3c"+this.settings.wrapper+"/\x3e").parent();if(!this.labelContainer.append(label).length)this.settings.errorPlacement?this.settings.errorPlacement(label,$(element)):label.insertAfter(element)}if(!message&&this.settings.success){label.text("");typeof this.settings.success=="string"?label.addClass(this.settings.success):this.settings.success(label)}this.toShow=
this.toShow.add(label)},errorsFor:function(element){var name=this.idOrName(element);return this.errors().filter(function(){return $(this).attr("for")==name})},idOrName:function(element){return this.groups[element.name]||(this.checkable(element)?element.name:element.id||element.name)},validationTargetFor:function(element){if(this.checkable(element))element=this.findByName(element.name).not(this.settings.ignore)[0];return element},checkable:function(element){return/radio|checkbox/i.test(element.type)},
findByName:function(name){var form=this.currentForm;return $(document.getElementsByName(name)).map(function(index,element){return element.form==form&&element.name==name&&element||null})},getLength:function(value,element){switch(element.nodeName.toLowerCase()){case "select":return $("option:selected",element).length;case "input":if(this.checkable(element))return this.findByName(element.name).filter(":checked").length}return value.length},depend:function(param,element){return this.dependTypes[typeof param]?
this.dependTypes[typeof param](param,element):true},dependTypes:{"boolean":function(param,element){return param},"string":function(param,element){return!!$(param,element.form).length},"function":function(param,element){return param(element)}},optional:function(element){return!$.validator.methods.required.call(this,$.trim(element.value),element)&&"dependency-mismatch"},startRequest:function(element){if(!this.pending[element.name]){this.pendingRequest++;this.pending[element.name]=true}},stopRequest:function(element,
valid){this.pendingRequest--;if(this.pendingRequest<0)this.pendingRequest=0;delete this.pending[element.name];if(valid&&this.pendingRequest==0&&this.formSubmitted&&this.form()){$(this.currentForm).submit();this.formSubmitted=false}else if(!valid&&this.pendingRequest==0&&this.formSubmitted){$(this.currentForm).triggerHandler("invalid-form",[this]);this.formSubmitted=false}},previousValue:function(element){return $.data(element,"previousValue")||$.data(element,"previousValue",{old:null,valid:true,message:this.defaultMessage(element,
"remote")})}},classRuleSettings:{required:{required:true},email:{email:true},url:{url:true},date:{date:true},dateISO:{dateISO:true},dateDE:{dateDE:true},number:{number:true},numberDE:{numberDE:true},digits:{digits:true},creditcard:{creditcard:true}},addClassRules:function(className,rules){className.constructor==String?this.classRuleSettings[className]=rules:$.extend(this.classRuleSettings,className)},classRules:function(element){var rules={};var classes=$(element).attr("class");classes&&$.each(classes.split(" "),
function(){if(this in $.validator.classRuleSettings)$.extend(rules,$.validator.classRuleSettings[this])});return rules},attributeRules:function(element){var rules={};var $element=$(element);for(var method in $.validator.methods){var value;if(method==="required"&&typeof $.fn.prop==="function")value=$element.prop(method);else value=$element.attr(method);if(value)rules[method]=value;else if($element[0].getAttribute("type")===method)rules[method]=true}if(rules.maxlength&&/-1|2147483647|524288/.test(rules.maxlength))delete rules.maxlength;
return rules},metadataRules:function(element){if(!$.metadata)return{};var meta=$.data(element.form,"validator").settings.meta;return meta?$(element).metadata()[meta]:$(element).metadata()},staticRules:function(element){var rules={};var validator=$.data(element.form,"validator");if(validator.settings.rules)rules=$.validator.normalizeRule(validator.settings.rules[element.name])||{};return rules},normalizeRules:function(rules,element){$.each(rules,function(prop,val){if(val===false){delete rules[prop];
return}if(val.param||val.depends){var keepRule=true;switch(typeof val.depends){case "string":keepRule=!!$(val.depends,element.form).length;break;case "function":keepRule=val.depends.call(element,element);break}if(keepRule)rules[prop]=val.param!==undefined?val.param:true;else delete rules[prop]}});$.each(rules,function(rule,parameter){rules[rule]=$.isFunction(parameter)?parameter(element):parameter});$.each(["minlength","maxlength","min","max"],function(){if(rules[this])rules[this]=Number(rules[this])});
$.each(["rangelength","range"],function(){if(rules[this])rules[this]=[Number(rules[this][0]),Number(rules[this][1])]});if($.validator.autoCreateRanges){if(rules.min&&rules.max){rules.range=[rules.min,rules.max];delete rules.min;delete rules.max}if(rules.minlength&&rules.maxlength){rules.rangelength=[rules.minlength,rules.maxlength];delete rules.minlength;delete rules.maxlength}}if(rules.messages)delete rules.messages;return rules},normalizeRule:function(data){if(typeof data=="string"){var transformed=
{};$.each(data.split(/\s/),function(){transformed[this]=true});data=transformed}return data},addMethod:function(name,method,message){$.validator.methods[name]=method;$.validator.messages[name]=message!=undefined?message:$.validator.messages[name];if(method.length<3)$.validator.addClassRules(name,$.validator.normalizeRule(name))},methods:{required:function(value,element,param){if(!this.depend(param,element))return"dependency-mismatch";switch(element.nodeName.toLowerCase()){case "select":var val=$(element).val();
return val&&val.length>0;case "input":if(this.checkable(element))return this.getLength(value,element)>0;default:return $.trim(value).length>0}},remote:function(value,element,param){if(this.optional(element))return"dependency-mismatch";var previous=this.previousValue(element);if(!this.settings.messages[element.name])this.settings.messages[element.name]={};previous.originalMessage=this.settings.messages[element.name].remote;this.settings.messages[element.name].remote=previous.message;param=typeof param==
"string"&&{url:param}||param;if(this.pending[element.name])return"pending";if(previous.old===value)return previous.valid;previous.old=value;var validator=this;this.startRequest(element);var data={};data[element.name]=value;$.ajax($.extend(true,{url:param,mode:"abort",port:"validate"+element.name,dataType:"json",data:data,success:function(response){validator.settings.messages[element.name].remote=previous.originalMessage;var valid=response===true;if(valid){var submitted=validator.formSubmitted;validator.prepareElement(element);
validator.formSubmitted=submitted;validator.successList.push(element);validator.showErrors()}else{var errors={};var message=response||validator.defaultMessage(element,"remote");errors[element.name]=previous.message=$.isFunction(message)?message(value):message;validator.showErrors(errors)}previous.valid=valid;validator.stopRequest(element,valid)}},param));return"pending"},minlength:function(value,element,param){return this.optional(element)||this.getLength($.trim(value),element)>=param},maxlength:function(value,
element,param){return this.optional(element)||this.getLength($.trim(value),element)<=param},rangelength:function(value,element,param){var length=this.getLength($.trim(value),element);return this.optional(element)||length>=param[0]&&length<=param[1]},min:function(value,element,param){return this.optional(element)||value>=param},max:function(value,element,param){return this.optional(element)||value<=param},range:function(value,element,param){return this.optional(element)||value>=param[0]&&value<=param[1]},
email:function(value,element){return this.optional(element)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(value)},
url:function(value,element){return this.optional(element)||/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(value)},
date:function(value,element){return this.optional(element)||!/Invalid|NaN/.test(new Date(value))},dateISO:function(value,element){return this.optional(element)||/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(value)},number:function(value,element){return this.optional(element)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(value)},digits:function(value,element){return this.optional(element)||/^\d+$/.test(value)},creditcard:function(value,element){if(this.optional(element))return"dependency-mismatch";if(/[^0-9 -]+/.test(value))return false;
var nCheck=0,nDigit=0,bEven=false;value=value.replace(/\D/g,"");for(var n=value.length-1;n>=0;n--){var cDigit=value.charAt(n);var nDigit=parseInt(cDigit,10);if(bEven)if((nDigit*=2)>9)nDigit-=9;nCheck+=nDigit;bEven=!bEven}return nCheck%10==0},accept:function(value,element,param){param=typeof param=="string"?param.replace(/,/g,"|"):"png|jpe?g|gif";return this.optional(element)||value.match(new RegExp(".("+param+")$","i"))},equalTo:function(value,element,param){var target=$(param).unbind(".validate-equalTo").bind("blur.validate-equalTo",
function(){$(element).valid()});return value==target.val()}}});$.format=$.validator.format})(jQuery);
(function($){var pendingRequests={};if($.ajaxPrefilter)$.ajaxPrefilter(function(settings,_,xhr){var port=settings.port;if(settings.mode=="abort"){if(pendingRequests[port])pendingRequests[port].abort();pendingRequests[port]=xhr}});else{var ajax=$.ajax;$.ajax=function(settings){var mode=("mode"in settings?settings:$.ajaxSettings).mode,port=("port"in settings?settings:$.ajaxSettings).port;if(mode=="abort"){if(pendingRequests[port])pendingRequests[port].abort();return pendingRequests[port]=ajax.apply(this,
arguments)}return ajax.apply(this,arguments)}}})(jQuery);
(function($){if(!jQuery.event.special.focusin&&!jQuery.event.special.focusout&&document.addEventListener)$.each({focus:"focusin",blur:"focusout"},function(original,fix){$.event.special[fix]={setup:function(){this.addEventListener(original,handler,true)},teardown:function(){this.removeEventListener(original,handler,true)},handler:function(e){arguments[0]=$.event.fix(e);arguments[0].type=fix;return $.event.handle.apply(this,arguments)}};function handler(e){e=$.event.fix(e);e.type=fix;return $.event.handle.call(this,
e)}});$.extend($.fn,{validateDelegate:function(delegate,type,handler){return this.bind(type,function(event){var target=$(event.target);if(target.is(delegate))return handler.apply(target,arguments)})}})})(jQuery);
(function(factory){if(typeof define==="function"&&define.amd)define(["jquery","./jquery.validate"],factory);else if(typeof module==="object"&&module.exports)module.exports=factory(require("jquery"));else factory(jQuery)})(function($){(function(){function stripHtml(value){return value.replace(/<.[^<>]*?>/g," ").replace(/&nbsp;|&#160;/gi," ").replace(/[.(),;:!?%#$'"_+=\/\-\u00e2\u20ac\u0153\u00e2\u20ac\u009d\u00e2\u20ac\u2122]*/g,"")}$.validator.addMethod("maxWords",function(value,element,params){return this.optional(element)||
stripHtml(value).match(/\b\w+\b/g).length<=params},$.validator.format("Please enter {0} words or less."));$.validator.addMethod("minWords",function(value,element,params){return this.optional(element)||stripHtml(value).match(/\b\w+\b/g).length>=params},$.validator.format("Please enter at least {0} words."));$.validator.addMethod("rangeWords",function(value,element,params){var valueStripped=stripHtml(value),regex=/\b\w+\b/g;return this.optional(element)||valueStripped.match(regex).length>=params[0]&&
valueStripped.match(regex).length<=params[1]},$.validator.format("Please enter between {0} and {1} words."))})();$.validator.addMethod("accept",function(value,element,param){var typeParam=typeof param==="string"?param.replace(/\s/g,""):"image/*",optionalValue=this.optional(element),i,file,regex;if(optionalValue)return optionalValue;if($(element).attr("type")==="file"){typeParam=typeParam.replace(/[\-\[\]\/\{\}\(\)\+\?\.\\\^\$\|]/g,"\\$\x26").replace(/,/g,"|").replace(/\/\*/g,"/.*");if(element.files&&
element.files.length){regex=new RegExp(".?("+typeParam+")$","i");for(i=0;i<element.files.length;i++){file=element.files[i];if(!file.type.match(regex))return false}}}return true},$.validator.format("Please enter a value with a valid mimetype."));$.validator.addMethod("alphanumeric",function(value,element){return this.optional(element)||/^\w+$/i.test(value)},"Letters, numbers, and underscores only please");$.validator.addMethod("bankaccountNL",function(value,element){if(this.optional(element))return true;
if(!/^[0-9]{9}|([0-9]{2} ){3}[0-9]{3}$/.test(value))return false;var account=value.replace(/ /g,""),sum=0,len=account.length,pos,factor,digit;for(pos=0;pos<len;pos++){factor=len-pos;digit=account.substring(pos,pos+1);sum=sum+factor*digit}return sum%11===0},"Please specify a valid bank account number");$.validator.addMethod("bankorgiroaccountNL",function(value,element){return this.optional(element)||$.validator.methods.bankaccountNL.call(this,value,element)||$.validator.methods.giroaccountNL.call(this,
value,element)},"Please specify a valid bank or giro account number");$.validator.addMethod("bic",function(value,element){return this.optional(element)||/^([A-Z]{6}[A-Z2-9][A-NP-Z1-9])(X{3}|[A-WY-Z0-9][A-Z0-9]{2})?$/.test(value.toUpperCase())},"Please specify a valid BIC code");$.validator.addMethod("cifES",function(value){var cifRegEx=new RegExp(/^([ABCDEFGHJKLMNPQRSUVW])(\d{7})([0-9A-J])$/gi);var letter=value.substring(0,1),number=value.substring(1,8),control=value.substring(8,9),all_sum=0,even_sum=
0,odd_sum=0,i,n,control_digit,control_letter;function isOdd(n){return n%2===0}if(value.length!==9||!cifRegEx.test(value))return false;for(i=0;i<number.length;i++){n=parseInt(number[i],10);if(isOdd(i)){n*=2;odd_sum+=n<10?n:n-9}else even_sum+=n}all_sum=even_sum+odd_sum;control_digit=(10-all_sum.toString().substr(-1)).toString();control_digit=parseInt(control_digit,10)>9?"0":control_digit;control_letter="JABCDEFGHI".substr(control_digit,1).toString();if(letter.match(/[ABEH]/))return control===control_digit;
else if(letter.match(/[KPQS]/))return control===control_letter;else return control===control_digit||control===control_letter;return false},"Please specify a valid CIF number.");$.validator.addMethod("cpfBR",function(value){value=value.replace(/([~!@#$%^&*()_+=`{}\[\]\-|\\:;'<>,.\/? ])+/g,"");if(value.length!==11)return false;var sum=0,firstCN,secondCN,checkResult,i;firstCN=parseInt(value.substring(9,10),10);secondCN=parseInt(value.substring(10,11),10);checkResult=function(sum,cn){var result=sum*10%
11;if(result===10||result===11)result=0;return result===cn};if(value===""||value==="00000000000"||value==="11111111111"||value==="22222222222"||value==="33333333333"||value==="44444444444"||value==="55555555555"||value==="66666666666"||value==="77777777777"||value==="88888888888"||value==="99999999999")return false;for(i=1;i<=9;i++)sum=sum+parseInt(value.substring(i-1,i),10)*(11-i);if(checkResult(sum,firstCN)){sum=0;for(i=1;i<=10;i++)sum=sum+parseInt(value.substring(i-1,i),10)*(12-i);return checkResult(sum,
secondCN)}return false},"Please specify a valid CPF number");$.validator.addMethod("creditcard",function(value,element){if(this.optional(element))return"dependency-mismatch";if(/[^0-9 \-]+/.test(value))return false;var nCheck=0,nDigit=0,bEven=false,n,cDigit;value=value.replace(/\D/g,"");if(value.length<13||value.length>19)return false;for(n=value.length-1;n>=0;n--){cDigit=value.charAt(n);nDigit=parseInt(cDigit,10);if(bEven)if((nDigit*=2)>9)nDigit-=9;nCheck+=nDigit;bEven=!bEven}return nCheck%10===
0},"Please enter a valid credit card number.");$.validator.addMethod("creditcardtypes",function(value,element,param){if(/[^0-9\-]+/.test(value))return false;value=value.replace(/\D/g,"");var validTypes=0;if(param.mastercard)validTypes|=1;if(param.visa)validTypes|=2;if(param.amex)validTypes|=4;if(param.dinersclub)validTypes|=8;if(param.enroute)validTypes|=16;if(param.discover)validTypes|=32;if(param.jcb)validTypes|=64;if(param.unknown)validTypes|=128;if(param.all)validTypes=1|2|4|8|16|32|64|128;if(validTypes&
1&&/^(5[12345])/.test(value))return value.length===16;if(validTypes&2&&/^(4)/.test(value))return value.length===16;if(validTypes&4&&/^(3[47])/.test(value))return value.length===15;if(validTypes&8&&/^(3(0[012345]|[68]))/.test(value))return value.length===14;if(validTypes&16&&/^(2(014|149))/.test(value))return value.length===15;if(validTypes&32&&/^(6011)/.test(value))return value.length===16;if(validTypes&64&&/^(3)/.test(value))return value.length===16;if(validTypes&64&&/^(2131|1800)/.test(value))return value.length===
15;if(validTypes&128)return true;return false},"Please enter a valid credit card number.");$.validator.addMethod("currency",function(value,element,param){var isParamString=typeof param==="string",symbol=isParamString?param:param[0],soft=isParamString?true:param[1],regex;symbol=symbol.replace(/,/g,"");symbol=soft?symbol+"]":symbol+"]?";regex="^["+symbol+"([1-9]{1}[0-9]{0,2}(\\,[0-9]{3})*(\\.[0-9]{0,2})?|[1-9]{1}[0-9]{0,}(\\.[0-9]{0,2})?|0(\\.[0-9]{0,2})?|(\\.[0-9]{1,2})?)$";regex=new RegExp(regex);
return this.optional(element)||regex.test(value)},"Please specify a valid currency");$.validator.addMethod("dateFA",function(value,element){return this.optional(element)||/^[1-4]\d{3}\/((0?[1-6]\/((3[0-1])|([1-2][0-9])|(0?[1-9])))|((1[0-2]|(0?[7-9]))\/(30|([1-2][0-9])|(0?[1-9]))))$/.test(value)},$.validator.messages.date);$.validator.addMethod("dateITA",function(value,element){var check=false,re=/^\d{1,2}\/\d{1,2}\/\d{4}$/,adata,gg,mm,aaaa,xdata;if(re.test(value)){adata=value.split("/");gg=parseInt(adata[0],
10);mm=parseInt(adata[1],10);aaaa=parseInt(adata[2],10);xdata=new Date(Date.UTC(aaaa,mm-1,gg,12,0,0,0));if(xdata.getUTCFullYear()===aaaa&&xdata.getUTCMonth()===mm-1&&xdata.getUTCDate()===gg)check=true;else check=false}else check=false;return this.optional(element)||check},$.validator.messages.date);$.validator.addMethod("dateNL",function(value,element){return this.optional(element)||/^(0?[1-9]|[12]\d|3[01])[\.\/\-](0?[1-9]|1[012])[\.\/\-]([12]\d)?(\d\d)$/.test(value)},$.validator.messages.date);$.validator.addMethod("extension",
function(value,element,param){param=typeof param==="string"?param.replace(/,/g,"|"):"png|jpe?g|gif";return this.optional(element)||value.match(new RegExp("\\.("+param+")$","i"))},$.validator.format("Please enter a value with a valid extension."));$.validator.addMethod("giroaccountNL",function(value,element){return this.optional(element)||/^[0-9]{1,7}$/.test(value)},"Please specify a valid giro account number");$.validator.addMethod("iban",function(value,element){if(this.optional(element))return true;
var iban=value.replace(/ /g,"").toUpperCase(),ibancheckdigits="",leadingZeroes=true,cRest="",cOperator="",countrycode,ibancheck,charAt,cChar,bbanpattern,bbancountrypatterns,ibanregexp,i,p;var minimalIBANlength=5;if(iban.length<minimalIBANlength)return false;countrycode=iban.substring(0,2);bbancountrypatterns={"AL":"\\d{8}[\\dA-Z]{16}","AD":"\\d{8}[\\dA-Z]{12}","AT":"\\d{16}","AZ":"[\\dA-Z]{4}\\d{20}","BE":"\\d{12}","BH":"[A-Z]{4}[\\dA-Z]{14}","BA":"\\d{16}","BR":"\\d{23}[A-Z][\\dA-Z]","BG":"[A-Z]{4}\\d{6}[\\dA-Z]{8}",
"CR":"\\d{17}","HR":"\\d{17}","CY":"\\d{8}[\\dA-Z]{16}","CZ":"\\d{20}","DK":"\\d{14}","DO":"[A-Z]{4}\\d{20}","EE":"\\d{16}","FO":"\\d{14}","FI":"\\d{14}","FR":"\\d{10}[\\dA-Z]{11}\\d{2}","GE":"[\\dA-Z]{2}\\d{16}","DE":"\\d{18}","GI":"[A-Z]{4}[\\dA-Z]{15}","GR":"\\d{7}[\\dA-Z]{16}","GL":"\\d{14}","GT":"[\\dA-Z]{4}[\\dA-Z]{20}","HU":"\\d{24}","IS":"\\d{22}","IE":"[\\dA-Z]{4}\\d{14}","IL":"\\d{19}","IT":"[A-Z]\\d{10}[\\dA-Z]{12}","KZ":"\\d{3}[\\dA-Z]{13}","KW":"[A-Z]{4}[\\dA-Z]{22}","LV":"[A-Z]{4}[\\dA-Z]{13}",
"LB":"\\d{4}[\\dA-Z]{20}","LI":"\\d{5}[\\dA-Z]{12}","LT":"\\d{16}","LU":"\\d{3}[\\dA-Z]{13}","MK":"\\d{3}[\\dA-Z]{10}\\d{2}","MT":"[A-Z]{4}\\d{5}[\\dA-Z]{18}","MR":"\\d{23}","MU":"[A-Z]{4}\\d{19}[A-Z]{3}","MC":"\\d{10}[\\dA-Z]{11}\\d{2}","MD":"[\\dA-Z]{2}\\d{18}","ME":"\\d{18}","NL":"[A-Z]{4}\\d{10}","NO":"\\d{11}","PK":"[\\dA-Z]{4}\\d{16}","PS":"[\\dA-Z]{4}\\d{21}","PL":"\\d{24}","PT":"\\d{21}","RO":"[A-Z]{4}[\\dA-Z]{16}","SM":"[A-Z]\\d{10}[\\dA-Z]{12}","SA":"\\d{2}[\\dA-Z]{18}","RS":"\\d{18}","SK":"\\d{20}",
"SI":"\\d{15}","ES":"\\d{20}","SE":"\\d{20}","CH":"\\d{5}[\\dA-Z]{12}","TN":"\\d{20}","TR":"\\d{5}[\\dA-Z]{17}","AE":"\\d{3}\\d{16}","GB":"[A-Z]{4}\\d{14}","VG":"[\\dA-Z]{4}\\d{16}"};bbanpattern=bbancountrypatterns[countrycode];if(typeof bbanpattern!=="undefined"){ibanregexp=new RegExp("^[A-Z]{2}\\d{2}"+bbanpattern+"$","");if(!ibanregexp.test(iban))return false}ibancheck=iban.substring(4,iban.length)+iban.substring(0,4);for(i=0;i<ibancheck.length;i++){charAt=ibancheck.charAt(i);if(charAt!=="0")leadingZeroes=
false;if(!leadingZeroes)ibancheckdigits+="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(charAt)}for(p=0;p<ibancheckdigits.length;p++){cChar=ibancheckdigits.charAt(p);cOperator=""+cRest+""+cChar;cRest=cOperator%97}return cRest===1},"Please specify a valid IBAN");$.validator.addMethod("integer",function(value,element){return this.optional(element)||/^-?\d+$/.test(value)},"A positive or negative non-decimal number please");$.validator.addMethod("ipv4",function(value,element){return this.optional(element)||
/^(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)$/i.test(value)},"Please enter a valid IP v4 address.");$.validator.addMethod("ipv6",function(value,element){return this.optional(element)||/^((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))$/i.test(value)},
"Please enter a valid IP v6 address.");$.validator.addMethod("lettersonly",function(value,element){return this.optional(element)||/^[a-z]+$/i.test(value)},"Letters only please");$.validator.addMethod("letterswithbasicpunc",function(value,element){return this.optional(element)||/^[a-z\-.,()'"\s]+$/i.test(value)},"Letters or punctuation only please");$.validator.addMethod("mobileNL",function(value,element){return this.optional(element)||/^((\+|00(\s|\s?\-\s?)?)31(\s|\s?\-\s?)?(\(0\)[\-\s]?)?|0)6((\s|\s?\-\s?)?[0-9]){8}$/.test(value)},
"Please specify a valid mobile number");$.validator.addMethod("mobileUK",function(phone_number,element){phone_number=phone_number.replace(/\(|\)|\s+|-/g,"");return this.optional(element)||phone_number.length>9&&phone_number.match(/^(?:(?:(?:00\s?|\+)44\s?|0)7(?:[1345789]\d{2}|624)\s?\d{3}\s?\d{3})$/)},"Please specify a valid mobile number");$.validator.addMethod("nieES",function(value){var nieRegEx=new RegExp(/^[MXYZ]{1}[0-9]{7,8}[TRWAGMYFPDXBNJZSQVHLCKET]{1}$/gi);var validChars="TRWAGMYFPDXBNJZSQVHLCKET",
letter=value.substr(value.length-1).toUpperCase(),number;value=value.toString().toUpperCase();if(value.length>10||value.length<9||!nieRegEx.test(value))return false;value=value.replace(/^[X]/,"0").replace(/^[Y]/,"1").replace(/^[Z]/,"2");number=value.length===9?value.substr(0,8):value.substr(0,9);return validChars.charAt(parseInt(number,10)%23)===letter},"Please specify a valid NIE number.");$.validator.addMethod("nifES",function(value){value=value.toUpperCase();if(!value.match("((^[A-Z]{1}[0-9]{7}[A-Z0-9]{1}$|^[T]{1}[A-Z0-9]{8}$)|^[0-9]{8}[A-Z]{1}$)"))return false;
if(/^[0-9]{8}[A-Z]{1}$/.test(value))return"TRWAGMYFPDXBNJZSQVHLCKE".charAt(value.substring(8,0)%23)===value.charAt(8);if(/^[KLM]{1}/.test(value))return value[8]===String.fromCharCode(64);return false},"Please specify a valid NIF number.");$.validator.addMethod("notEqualTo",function(value,element,param){return this.optional(element)||!$.validator.methods.equalTo.call(this,value,element,param)},"Please enter a different value, values must not be the same.");$.validator.addMethod("nowhitespace",function(value,
element){return this.optional(element)||/^\S+$/i.test(value)},"No white space please");$.validator.addMethod("pattern",function(value,element,param){if(this.optional(element))return true;if(typeof param==="string")param=new RegExp("^(?:"+param+")$");return param.test(value)},"Invalid format.");$.validator.addMethod("phoneNL",function(value,element){return this.optional(element)||/^((\+|00(\s|\s?\-\s?)?)31(\s|\s?\-\s?)?(\(0\)[\-\s]?)?|0)[1-9]((\s|\s?\-\s?)?[0-9]){8}$/.test(value)},"Please specify a valid phone number.");
$.validator.addMethod("phonesUK",function(phone_number,element){phone_number=phone_number.replace(/\(|\)|\s+|-/g,"");return this.optional(element)||phone_number.length>9&&phone_number.match(/^(?:(?:(?:00\s?|\+)44\s?|0)(?:1\d{8,9}|[23]\d{9}|7(?:[1345789]\d{8}|624\d{6})))$/)},"Please specify a valid uk phone number");$.validator.addMethod("phoneUK",function(phone_number,element){phone_number=phone_number.replace(/\(|\)|\s+|-/g,"");return this.optional(element)||phone_number.length>9&&phone_number.match(/^(?:(?:(?:00\s?|\+)44\s?)|(?:\(?0))(?:\d{2}\)?\s?\d{4}\s?\d{4}|\d{3}\)?\s?\d{3}\s?\d{3,4}|\d{4}\)?\s?(?:\d{5}|\d{3}\s?\d{3})|\d{5}\)?\s?\d{4,5})$/)},
"Please specify a valid phone number");$.validator.addMethod("phoneUS",function(phone_number,element){phone_number=phone_number.replace(/\s+/g,"");return this.optional(element)||phone_number.length>9&&phone_number.match(/^(\+?1-?)?(\([2-9]([02-9]\d|1[02-9])\)|[2-9]([02-9]\d|1[02-9]))-?[2-9]([02-9]\d|1[02-9])-?\d{4}$/)},"Please specify a valid phone number");$.validator.addMethod("postalcodeBR",function(cep_value,element){return this.optional(element)||/^\d{2}.\d{3}-\d{3}?$|^\d{5}-?\d{3}?$/.test(cep_value)},
"Informe um CEP v\u00c3\u00a1lido.");$.validator.addMethod("postalCodeCA",function(value,element){return this.optional(element)||/^[ABCEGHJKLMNPRSTVXY]\d[ABCEGHJKLMNPRSTVWXYZ] *\d[ABCEGHJKLMNPRSTVWXYZ]\d$/i.test(value)},"Please specify a valid postal code");$.validator.addMethod("postalcodeIT",function(value,element){return this.optional(element)||/^\d{5}$/.test(value)},"Please specify a valid postal code");$.validator.addMethod("postalcodeNL",function(value,element){return this.optional(element)||
/^[1-9][0-9]{3}\s?[a-zA-Z]{2}$/.test(value)},"Please specify a valid postal code");$.validator.addMethod("postcodeUK",function(value,element){return this.optional(element)||/^((([A-PR-UWYZ][0-9])|([A-PR-UWYZ][0-9][0-9])|([A-PR-UWYZ][A-HK-Y][0-9])|([A-PR-UWYZ][A-HK-Y][0-9][0-9])|([A-PR-UWYZ][0-9][A-HJKSTUW])|([A-PR-UWYZ][A-HK-Y][0-9][ABEHMNPRVWXY]))\s?([0-9][ABD-HJLNP-UW-Z]{2})|(GIR)\s?(0AA))$/i.test(value)},"Please specify a valid UK postcode");$.validator.addMethod("require_from_group",function(value,
element,options){var $fields=$(options[1],element.form),$fieldsFirst=$fields.eq(0),validator=$fieldsFirst.data("valid_req_grp")?$fieldsFirst.data("valid_req_grp"):$.extend({},this),isValid=$fields.filter(function(){return validator.elementValue(this)}).length>=options[0];$fieldsFirst.data("valid_req_grp",validator);if(!$(element).data("being_validated")){$fields.data("being_validated",true);$fields.each(function(){validator.element(this)});$fields.data("being_validated",false)}return isValid},$.validator.format("Please fill at least {0} of these fields."));
$.validator.addMethod("skip_or_fill_minimum",function(value,element,options){var $fields=$(options[1],element.form),$fieldsFirst=$fields.eq(0),validator=$fieldsFirst.data("valid_skip")?$fieldsFirst.data("valid_skip"):$.extend({},this),numberFilled=$fields.filter(function(){return validator.elementValue(this)}).length,isValid=numberFilled===0||numberFilled>=options[0];$fieldsFirst.data("valid_skip",validator);if(!$(element).data("being_validated")){$fields.data("being_validated",true);$fields.each(function(){validator.element(this)});
$fields.data("being_validated",false)}return isValid},$.validator.format("Please either skip these fields or fill at least {0} of them."));$.validator.addMethod("stateUS",function(value,element,options){var isDefault=typeof options==="undefined",caseSensitive=isDefault||typeof options.caseSensitive==="undefined"?false:options.caseSensitive,includeTerritories=isDefault||typeof options.includeTerritories==="undefined"?false:options.includeTerritories,includeMilitary=isDefault||typeof options.includeMilitary===
"undefined"?false:options.includeMilitary,regex;if(!includeTerritories&&!includeMilitary)regex="^(A[KLRZ]|C[AOT]|D[CE]|FL|GA|HI|I[ADLN]|K[SY]|LA|M[ADEINOST]|N[CDEHJMVY]|O[HKR]|PA|RI|S[CD]|T[NX]|UT|V[AT]|W[AIVY])$";else if(includeTerritories&&includeMilitary)regex="^(A[AEKLPRSZ]|C[AOT]|D[CE]|FL|G[AU]|HI|I[ADLN]|K[SY]|LA|M[ADEINOPST]|N[CDEHJMVY]|O[HKR]|P[AR]|RI|S[CD]|T[NX]|UT|V[AIT]|W[AIVY])$";else if(includeTerritories)regex="^(A[KLRSZ]|C[AOT]|D[CE]|FL|G[AU]|HI|I[ADLN]|K[SY]|LA|M[ADEINOPST]|N[CDEHJMVY]|O[HKR]|P[AR]|RI|S[CD]|T[NX]|UT|V[AIT]|W[AIVY])$";
else regex="^(A[AEKLPRZ]|C[AOT]|D[CE]|FL|GA|HI|I[ADLN]|K[SY]|LA|M[ADEINOST]|N[CDEHJMVY]|O[HKR]|PA|RI|S[CD]|T[NX]|UT|V[AT]|W[AIVY])$";regex=caseSensitive?new RegExp(regex):new RegExp(regex,"i");return this.optional(element)||regex.test(value)},"Please specify a valid state");$.validator.addMethod("strippedminlength",function(value,element,param){return $(value).text().length>=param},$.validator.format("Please enter at least {0} characters"));$.validator.addMethod("time",function(value,element){return this.optional(element)||
/^([01]\d|2[0-3]|[0-9])(:[0-5]\d){1,2}$/.test(value)},"Please enter a valid time, between 00:00 and 23:59");$.validator.addMethod("time12h",function(value,element){return this.optional(element)||/^((0?[1-9]|1[012])(:[0-5]\d){1,2}( ?[AP]M))$/i.test(value)},"Please enter a valid time in 12-hour am/pm format");$.validator.addMethod("url2",function(value,element){return this.optional(element)||/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)*(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(value)},
$.validator.messages.url);$.validator.addMethod("vinUS",function(v){if(v.length!==17)return false;var LL=["A","B","C","D","E","F","G","H","J","K","L","M","N","P","R","S","T","U","V","W","X","Y","Z"],VL=[1,2,3,4,5,6,7,8,1,2,3,4,5,7,9,2,3,4,5,6,7,8,9],FL=[8,7,6,5,4,3,2,10,0,9,8,7,6,5,4,3,2],rs=0,i,n,d,f,cd,cdv;for(i=0;i<17;i++){f=FL[i];d=v.slice(i,i+1);if(i===8)cdv=d;if(!isNaN(d))d*=f;else for(n=0;n<LL.length;n++)if(d.toUpperCase()===LL[n]){d=VL[n];d*=f;if(isNaN(cdv)&&n===8)cdv=LL[n];break}rs+=d}cd=
rs%11;if(cd===10)cd="X";if(cd===cdv)return true;return false},"The specified vehicle identification number (VIN) is invalid.");$.validator.addMethod("zipcodeUS",function(value,element){return this.optional(element)||/^\d{5}(-\d{4})?$/.test(value)},"The specified US ZIP Code is invalid");$.validator.addMethod("ziprange",function(value,element){return this.optional(element)||/^90[2-5]\d\{2\}-\d{4}$/.test(value)},"Your ZIP-code must be in the range 902xx-xxxx to 905xx-xxxx");return $});